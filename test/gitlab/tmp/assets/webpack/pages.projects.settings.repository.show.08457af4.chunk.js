(this.webpackJsonp=this.webpackJsonp||[]).push([[166],{1367:function(e,t,n){n(42),n(44),e.exports=n(1423)},1423:function(e,t,n){"use strict";n.r(t);var o=n(500),r=n(0),a=n.n(r),i=n(5),s=n.n(i),c=n(1),l=n(7),u=n(6),d=n(13),h="password",p="ssh_public_key";function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){b(e,t,n[t])})}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var v=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.backOffRequestCounter=0,this.$form=a()(t),this.$repositoryUrl=this.$form.find(".js-repo-url"),this.$knownHosts=this.$form.find(".js-known-hosts"),this.$sectionSSHHostKeys=this.$form.find(".js-ssh-host-keys-section"),this.$hostKeysInformation=this.$form.find(".js-fingerprint-ssh-info"),this.$btnDetectHostKeys=this.$form.find(".js-detect-host-keys"),this.$btnSSHHostsShowAdvanced=this.$form.find(".btn-show-advanced"),this.$dropdownAuthType=this.$form.find(".js-mirror-auth-type"),this.$wellAuthTypeChanging=this.$form.find(".js-well-changing-auth"),this.$wellPasswordAuth=this.$form.find(".js-well-password-auth"),this.$wellSSHAuth=this.$form.find(".js-well-ssh-auth"),this.$sshPublicKeyWrap=this.$form.find(".js-ssh-public-key-wrap"),this.$regeneratePublicSshKeyButton=this.$wellSSHAuth.find(".js-btn-regenerate-ssh-key"),this.$regeneratePublicSshKeyModal=this.$wellSSHAuth.find(".js-regenerate-public-ssh-key-confirm-modal")}var t,n,o;return t=e,(n=[{key:"init",value:function(){var e=this;this.handleRepositoryUrlInput(!0),this.$repositoryUrl.on("keyup",function(){return e.handleRepositoryUrlInput()}),this.$knownHosts.on("keyup",function(t){return e.handleSSHKnownHostsInput(t)}),this.$dropdownAuthType.on("change",function(t){return e.handleAuthTypeChange(t)}),this.$btnDetectHostKeys.on("click",function(t){return e.handleDetectHostKeys(t)}),this.$btnSSHHostsShowAdvanced.on("click",function(t){return e.handleSSHHostsAdvanced(t)}),this.$regeneratePublicSshKeyButton.on("click",function(){return e.$regeneratePublicSshKeyModal.toggle(!0)}),a()(".js-confirm",this.$regeneratePublicSshKeyModal).on("click",function(t){return e.regeneratePublicSshKey(t)}),a()(".js-cancel",this.$regeneratePublicSshKeyModal).on("click",function(){return e.$regeneratePublicSshKeyModal.toggle(!1)})}},{key:"handleRepositoryUrlInput",value:function(e){var t=this.$repositoryUrl.val().split("://")[0];if(e||this.$form.get(0).checkValidity()){var n="ssh"===t;this.$sectionSSHHostKeys.collapse(n?"show":"hide"),this.$btnDetectHostKeys.enable();var o=/http|git/.test(t);this.$dropdownAuthType.attr("disabled",o),e&&n?(this.$dropdownAuthType.val(p),this.toggleAuthWell(p)):(this.$dropdownAuthType.val(h),this.toggleAuthWell(h))}}},{key:"handleDetectHostKeys",value:function(){var e=this,t=this.$form.data("project-mirror-ssh-endpoint"),n=this.$repositoryUrl.val(),o=this.$knownHosts.val(),r=this.$btnDetectHostKeys.find(".js-spinner");this.$btnDetectHostKeys.disable(),r.removeClass("d-none"),Object(d.d)(function(r,a){u.a.get("".concat(t,"?ssh_url=").concat(n,"&compare_host_keys=").concat(encodeURIComponent(o))).then(function(t){var n=t.data;204===t.status?(e.backOffRequestCounter+=1,e.backOffRequestCounter<3?r():a(n)):a(n)}).catch(a)}).then(function(t){r.addClass("d-none"),e.$hostKeysInformation.find(".js-fingerprint-verification").collapse(t.host_keys_changed?"hide":"show"),t.known_hosts&&t.fingerprints&&e.showSSHInformation(t)}).catch(function(t){var n=t.response,o=n.data?n.data.message:Object(c.a)("An error occurred while detecting host keys");Object(l.a)(o),r.addClass("hidden"),e.$btnDetectHostKeys.enable()})}},{key:"handleSSHKnownHostsInput",value:function(){this.$hostKeysInformation.find(".js-fingerprints-list").addClass("invalidate"),this.$hostKeysInformation.find(".js-fingerprint-verification").collapse("hide")}},{key:"handleSSHHostsAdvanced",value:function(){var e=this.$sectionSSHHostKeys.find(".js-ssh-known-hosts"),t=e.hasClass("show");e.collapse("toggle"),this.$btnSSHHostsShowAdvanced.toggleClass("show-advanced",t)}},{key:"handleAuthTypeChange",value:function(){var e=this,t="".concat(this.$form.attr("action"),".json"),n=this.$sshPublicKeyWrap.find(".ssh-public-key"),o=this.$dropdownAuthType.val();if(this.$wellPasswordAuth.collapse("hide"),this.$wellSSHAuth.collapse("hide"),o!==p||n.text().trim())this.toggleAuthWell(o),this.$wellSSHAuth.find(".js-ssh-public-key-present").collapse("show");else{if(!this.$wellSSHAuth.length)return;var r={project:f({},this.$regeneratePublicSshKeyButton.data().projectData)};this.$wellAuthTypeChanging.collapse("show"),this.$dropdownAuthType.disable(),u.a.put(t,JSON.stringify(r),{headers:{"Content-Type":"application/json; charset=utf-8"}}).then(function(t){var n=t.data;e.toggleAuthWell(o),e.toggleSSHAuthWellMessage(!0),e.setSSHPublicKey(n.import_data_attributes.ssh_public_key),e.$wellAuthTypeChanging.collapse("hide"),e.$dropdownAuthType.enable()}).catch(function(){Object(l.a)(Object(c.a)("Something went wrong on our end.")),e.$wellAuthTypeChanging.collapse("hide"),e.$dropdownAuthType.enable()})}}},{key:"showSSHInformation",value:function(e){var t=this.$hostKeysInformation.find(".js-fingerprints-list"),n="";e.fingerprints.forEach(function(e){var t=s.a.escape(e.fingerprint);n+="<code>".concat(t,"</code>")}),this.$hostKeysInformation.collapse("show"),t.removeClass("invalidate"),t.html(n),this.$sectionSSHHostKeys.find(".js-known-hosts").val(e.known_hosts)}},{key:"toggleAuthWell",value:function(e){this.$wellPasswordAuth.collapse(e===h?"show":"hide"),this.$wellSSHAuth.collapse(e===p?"show":"hide")}},{key:"toggleSSHAuthWellMessage",value:function(e){this.$sshPublicKeyWrap.collapse(e?"show":"hide"),this.$wellSSHAuth.find(".js-ssh-public-key-present").collapse(e?"show":"hide"),this.$regeneratePublicSshKeyButton.collapse(e?"show":"hide"),this.$wellSSHAuth.find(".js-ssh-public-key-pending").collapse(e?"hide":"show")}},{key:"setSSHPublicKey",value:function(e){this.$sshPublicKeyWrap.find(".ssh-public-key").text(e),this.$sshPublicKeyWrap.find(".btn-copy-ssh-public-key").attr("data-clipboard-text",e)}},{key:"regeneratePublicSshKey",value:function(e){var t=this;e.preventDefault(),this.$regeneratePublicSshKeyModal.toggle(!1);var n=this.$regeneratePublicSshKeyButton,o=a()(".js-spinner",n),r=n.data("endpoint"),i={project:f({},this.$regeneratePublicSshKeyButton.data().projectData)};n.attr("disabled","disabled"),o.removeClass("d-none"),u.a.patch(r,i).then(function(e){var r=e.data;n.removeAttr("disabled"),o.addClass("d-none"),t.setSSHPublicKey(r.import_data_attributes.ssh_public_key)}).catch(function(){Object(l.a)(s()("Unable to regenerate public ssh key."))})}},{key:"destroy",value:function(){this.$repositoryUrl.off("keyup"),this.$form.find(".js-known-hosts").off("keyup"),this.$dropdownAuthType.off("change"),this.$btnDetectHostKeys.off("click"),this.$btnSSHHostsShowAdvanced.off("click"),this.$regeneratePublicSshKeyButton.off("click"),a()(".js-confirm",this.$regeneratePublicSshKeyModal).off("click"),a()(".js-cancel",this.$regeneratePublicSshKeyModal).off("click")}}])&&y(t.prototype,n),o&&y(t,o),e}();function g(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var w=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$container=a()(t),this.$password=null,this.$form=a()(".js-mirror-form",this.$container),this.$urlInput=a()(".js-mirror-url",this.$form),this.$protectedBranchesInput=a()(".js-mirror-protected",this.$form),this.$table=a()(".js-mirrors-table-body",this.$container),this.mirrorEndpoint=this.$form.data("projectMirrorEndpoint")}var t,n,o;return t=e,(n=[{key:"init",value:function(){this.initMirrorPush(),this.registerUpdateListeners()}},{key:"initMirrorPush",value:function(){var e=this;this.$passwordGroup=a()(".js-password-group",this.$container),this.$password=a()(".js-password",this.$passwordGroup),this.$authMethod=a()(".js-auth-method",this.$form),this.$authMethod.on("change",function(){return e.togglePassword()}),this.$password.on("input.updateUrl",function(){return e.debouncedUpdateUrl()}),this.initMirrorSSH(),this.updateProtectedBranches()}},{key:"initMirrorSSH",value:function(){this.$password&&this.$password.off("input.updateUrl"),this.$password=void 0,this.sshMirror=new v(".js-mirror-form"),this.sshMirror.init()}},{key:"updateUrl",value:function(){var e=this.$urlInput.val();if(this.$password){var t=this.$password.val();t&&(e=e.replace("@",":".concat(t,"@")))}a()(".js-mirror-url-hidden",this.$form).val(e)}},{key:"updateProtectedBranches",value:function(){var e=this.$protectedBranchesInput.get(0).checked?this.$protectedBranchesInput.val():"0";a()(".js-mirror-protected-hidden",this.$form).val(e)}},{key:"registerUpdateListeners",value:function(){var e=this;this.debouncedUpdateUrl=s.a.debounce(function(){return e.updateUrl()},200),this.$urlInput.on("input",function(){return e.debouncedUpdateUrl()}),this.$protectedBranchesInput.on("change",function(){return e.updateProtectedBranches()}),this.$table.on("click",".js-delete-mirror",function(t){return e.deleteMirror(t)})}},{key:"togglePassword",value:function(){var e="password"===this.$authMethod.val();e||(this.$password.val(""),this.updateUrl()),this.$passwordGroup.collapse(e?"show":"hide")}},{key:"deleteMirror",value:function(e,t){var n=this,o=a()(e.currentTarget),r=t;return r||(r={project:{remote_mirrors_attributes:{id:o.data("mirrorId"),enabled:0}}}),u.a.put(this.mirrorEndpoint,r).then(function(){return n.removeRow(o)}).catch(function(){return Object(l.a)(Object(c.a)("Failed to remove mirror."))})}},{key:"removeRow",value:function(e){var t=e.closest("tr");a()(".js-delete-mirror",t).tooltip("hide"),t.remove()}}])&&g(t.prototype,n),o&&g(t,o),e}();document.addEventListener("DOMContentLoaded",function(){Object(o.a)();var e=document.querySelector(".js-mirror-settings");e&&new w(e).init()})},155:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var o=n(0),r=n.n(o),a=n(1);function i(e){e.find(".js-settings-toggle:not(.js-settings-toggle-trigger-only)").text(Object(a.a)("Collapse")),e.find(".settings-content").off("scroll.expandSection").scrollTop(0),e.addClass("expanded"),e.hasClass("no-animate")||e.addClass("animating").one("animationend.animateSection",function(){return e.removeClass("animating")})}function s(e){e.removeClass("no-animate"),e.hasClass("expanded")?function(e){e.find(".js-settings-toggle:not(.js-settings-toggle-trigger-only)").text(Object(a.a)("Expand")),e.find(".settings-content").on("scroll.expandSection",function(){return i(e)}),e.removeClass("expanded"),e.hasClass("no-animate")||e.addClass("animating").one("animationend.animateSection",function(){return e.removeClass("animating")})}(e):i(e)}function c(){if(r()(".settings").each(function(e,t){var n=r()(t);n.on("click.toggleSection",".js-settings-toggle",function(){return s(n)}),n.hasClass("expanded")||n.find(".settings-content").on("scroll.expandSection",function(){n.removeClass("no-animate"),i(n)})}),window.location.hash){var e=r()(window.location.hash);e.length&&e.hasClass("settings")&&i(e)}}},201:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var o=n(5),r=n.n(o);function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultToggleLabel=t.defaultToggleLabel,this.fieldName=t.fieldName,this.onSelect=t.onSelect||function(){},this.getDataOption=t.getData,this.getDataRemote=!!t.filterRemote,this.createNewItemFromValueOption=t.createNewItemFromValue,this.$dropdown=t.$dropdown,this.$dropdownContainer=this.$dropdown.parent(),this.$dropdownFooter=this.$dropdownContainer.find(".dropdown-footer"),this.$createButton=this.$dropdownContainer.find(".js-dropdown-create-new-item"),this.buildDropdown(),this.bindEvents(),this.toggleFooter(!0)}var t,n,o;return t=e,(n=[{key:"buildDropdown",value:function(){var e=this;this.$dropdown.glDropdown({data:this.getData.bind(this),filterable:!0,filterRemote:this.getDataRemote,search:{fields:["text"]},selectable:!0,toggleLabel:function(e){return e&&"id"in e?r.a.escape(e.title):this.defaultToggleLabel},fieldName:this.fieldName,text:function(e){return r.a.escape(e.text)},id:function(e){return r.a.escape(e.id)},onFilter:this.toggleCreateNewButton.bind(this),clicked:function(t){t.e.preventDefault(),e.onSelect()}})}},{key:"clearDropdown",value:function(){this.$dropdownContainer.find(".dropdown-content").html(""),this.$dropdownContainer.find(".dropdown-input-field").val("")}},{key:"bindEvents",value:function(){this.$createButton.on("click",this.onClickCreateWildcard.bind(this))}},{key:"onClickCreateWildcard",value:function(e){e.preventDefault(),this.refreshData(),this.$dropdown.data("glDropdown").selectRowAtIndex()}},{key:"refreshData",value:function(){this.$dropdown.data("glDropdown").remote.execute()}},{key:"getData",value:function(e,t){var n=this;this.getDataOption(e,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=e;n.selectedItem&&e.some(function(e){return e.id===n.selectedItem.id})||(o=e.concat(n.selectedItem||[])),t(o)})}},{key:"createNewItemFromValue",value:function(e){return this.createNewItemFromValueOption?this.createNewItemFromValueOption(e):{title:e,id:e,text:e}}},{key:"toggleCreateNewButton",value:function(e){e&&(this.selectedItem=this.createNewItemFromValue(e),this.$dropdownContainer.find(".js-dropdown-create-new-item code").text(e)),this.toggleFooter(!e)}},{key:"toggleFooter",value:function(e){this.$dropdownFooter.toggleClass("hidden",e)}}])&&a(t.prototype,n),o&&a(t,o),e}()},27:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var o=n(2),r=n.n(o),a=n(4),i=n(43);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=c(this,l(t).call(this)),r.a.bind("g p",function(){return Object(a.a)(".shortcuts-project")}),r.a.bind("g v",function(){return Object(a.a)(".shortcuts-project-activity")}),r.a.bind("g r",function(){return Object(a.a)(".shortcuts-project-releases")}),r.a.bind("g f",function(){return Object(a.a)(".shortcuts-tree")}),r.a.bind("g c",function(){return Object(a.a)(".shortcuts-commits")}),r.a.bind("g j",function(){return Object(a.a)(".shortcuts-builds")}),r.a.bind("g n",function(){return Object(a.a)(".shortcuts-network")}),r.a.bind("g d",function(){return Object(a.a)(".shortcuts-repository-charts")}),r.a.bind("g i",function(){return Object(a.a)(".shortcuts-issues")}),r.a.bind("g b",function(){return Object(a.a)(".shortcuts-issue-boards")}),r.a.bind("g m",function(){return Object(a.a)(".shortcuts-merge_requests")}),r.a.bind("g w",function(){return Object(a.a)(".shortcuts-wiki")}),r.a.bind("g s",function(){return Object(a.a)(".shortcuts-snippets")}),r.a.bind("g k",function(){return Object(a.a)(".shortcuts-kubernetes")}),r.a.bind("g e",function(){return Object(a.a)(".shortcuts-environments")}),r.a.bind("g l",function(){return Object(a.a)(".shortcuts-metrics")}),r.a.bind("i",function(){return Object(a.a)(".shortcuts-new-issue")}),e.enabledHelp.push(".hidden-shortcut.project"),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,i["a"]),t}()},28:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(12),i=n(31);function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.projectSelectInput=r()(t),this.newItemBtn=r()(".new-project-item-link"),this.resourceType=this.newItemBtn.data("type"),this.resourceLabel=this.newItemBtn.data("label"),this.formattedText=this.deriveTextVariants(),this.groupId=this.projectSelectInput.data("groupId"),this.bindEvents(),this.initLocalStorage()}var t,n,o;return t=e,(n=[{key:"bindEvents",value:function(){var e=this;this.projectSelectInput.siblings(".new-project-item-select-button").on("click",function(t){return e.openDropdown(t)}),this.newItemBtn.on("click",function(t){e.getProjectFromLocalStorage()||(t.preventDefault(),e.openDropdown(t))}),this.projectSelectInput.on("change",function(){return e.selectProject()})}},{key:"initLocalStorage",value:function(){i.a.isLocalStorageAccessSafe()&&(this.localStorageKey=["group",this.groupId,this.formattedText.localStorageItemType,"recent-project"].join("-"),this.setBtnTextFromLocalStorage())}},{key:"openDropdown",value:function(e){r()(e.currentTarget).siblings(".project-item-select").select2("open")}},{key:"selectProject",value:function(){var e=JSON.parse(this.projectSelectInput.val()),t={url:"".concat(e.url,"/").concat(this.projectSelectInput.data("relativePath")),name:e.name};this.setNewItemBtnAttributes(t),this.setProjectInLocalStorage(t)}},{key:"setBtnTextFromLocalStorage",value:function(){var e=this.getProjectFromLocalStorage();this.setNewItemBtnAttributes(e)}},{key:"setNewItemBtnAttributes",value:function(e){e?(this.newItemBtn.attr("href",e.url),this.newItemBtn.text("".concat(this.formattedText.defaultTextPrefix," in ").concat(e.name))):this.newItemBtn.text("Select project to create ".concat(this.formattedText.presetTextSuffix))}},{key:"getProjectFromLocalStorage",value:function(){var e=localStorage.getItem(this.localStorageKey);return JSON.parse(e)}},{key:"setProjectInLocalStorage",value:function(e){var t=JSON.stringify(e);localStorage.setItem(this.localStorageKey,t)}},{key:"deriveTextVariants",value:function(){var e=this.resourceLabel;return{localStorageItemType:"new-".concat(this.resourceType.split("_").join("-").slice(0,-1)),defaultTextPrefix:e,presetTextSuffix:this.resourceType.split("_").join(" ").slice(0,-1)}}}])&&s(t.prototype,n),o&&s(t,o),e}();function l(){r()(".ajax-project-select").each(function(e,t){var n,o,i=r()(t).data("simpleFilter")||!1;return this.groupId=r()(t).data("groupId"),this.includeGroups=r()(t).data("includeGroups"),this.allProjects=r()(t).data("allProjects")||!1,this.orderBy=r()(t).data("orderBy")||"id",this.withIssuesEnabled=r()(t).data("withIssuesEnabled"),this.withMergeRequestsEnabled=r()(t).data("withMergeRequestsEnabled"),this.withShared=void 0===r()(t).data("withShared")||r()(t).data("withShared"),this.includeProjectsInSubgroups=r()(t).data("includeProjectsInSubgroups")||!1,this.allowClear=r()(t).data("allowClear")||!1,n="Search for project",this.includeGroups&&(n+=" or group"),r()(t).select2({placeholder:n,minimumInputLength:0,query:(o=this,function(e){var t,n;return t=function(t){var n;return n={results:t},e.callback(n)},n=o.includeGroups?function(n){var o;return o=function(e){var o;return o=e.concat(n),t(o)},a.a.groups(e.term,{},o)}:t,o.groupId?a.a.groupProjects(o.groupId,e.term,{with_issues_enabled:o.withIssuesEnabled,with_merge_requests_enabled:o.withMergeRequestsEnabled,with_shared:o.withShared,include_subgroups:o.includeProjectsInSubgroups},n):a.a.projects(e.term,{order_by:o.orderBy,with_issues_enabled:o.withIssuesEnabled,with_merge_requests_enabled:o.withMergeRequestsEnabled,membership:!o.allProjects},n)}),id:function(e){return i?e.id:JSON.stringify({name:e.name,url:e.web_url})},text:function(e){return e.name_with_namespace||e.name},initSelection:function(e,t){return a.a.project(e.val()).then(function(e){var n=e.data;return t(n)})},allowClear:this.allowClear,dropdownCssClass:"ajax-project-dropdown"}),i?t:new c(t)})}n.d(t,"a",function(){return l})},29:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var o=n(0),r=n.n(o),a=n(14),i=n.n(a),s=n(1),c=n(19),l=n(6),u=n(7),d=n(28);function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=r()("ul.clone-options-dropdown"),n=r()("#project_clone"),o=r()(".js-git-clone-holder .js-clone-dropdown-label"),a=document.querySelector(".js-mobile-git-clone .js-clone-dropdown-label"),s=o.text().trim();s.length>0&&r()("a:contains('".concat(s,"')"),t).addClass("is-active"),r()("a",t).on("click",function(e){e.preventDefault();var o=r()(e.currentTarget),i=o.attr("href"),s=o.data("cloneType");r()(".is-active",t).removeClass("is-active"),r()('a[data-clone-type="'.concat(s,'"]')).each(function(){var e=r()(this),t=e.find(".dropdown-menu-inner-title").text(),n=e.closest(".project-clone-holder").find(".js-clone-dropdown-label");e.toggleClass("is-active"),n.text(t)}),a?a.dataset.clipboardText=i:n.val(i),r()(".js-git-empty .js-clone").text(i)}),e.initRefSwitcher(),r()(".project-refs-select").on("change",function(){return r()(this).parents("form").submit()}),r()(".hide-no-ssh-message").on("click",function(e){return i.a.set("hide_no_ssh_message","false"),r()(this).parents(".no-ssh-key-message").remove(),e.preventDefault()}),r()(".hide-no-password-message").on("click",function(e){return i.a.set("hide_no_password_message","false"),r()(this).parents(".no-password-message").remove(),e.preventDefault()}),r()(".hide-auto-devops-implicitly-enabled-banner").on("click",function(e){var t=r()(this).data("project-id"),n="hide_auto_devops_implicitly_enabled_banner_".concat(t);return i.a.set(n,"false"),r()(this).parents(".auto-devops-implicitly-enabled-banner").remove(),e.preventDefault()}),e.projectSelectDropdown()}var t,n,o;return t=e,o=[{key:"projectSelectDropdown",value:function(){Object(d.a)(),r()(".project-item-select").on("click",function(t){return e.changeProject(r()(t.currentTarget).val())})}},{key:"changeProject",value:function(e){return window.location=e}},{key:"initRefSwitcher",value:function(){var e=document.createElement("li"),t=document.createElement("a");return t.href="#",r()(".js-project-refs-dropdown").each(function(){var n,o;return n=r()(this),o=n.data("selected"),n.glDropdown({data:function(e,t){l.a.get(n.data("refsUrl"),{params:{ref:n.data("ref"),search:e}}).then(function(e){var n=e.data;return t(n)}).catch(function(){return Object(u.a)(Object(s.a)("An error occurred while getting projects"))})},selectable:!0,filterable:!0,filterRemote:!0,filterByText:!0,inputFieldName:n.data("inputFieldName"),fieldName:n.data("fieldName"),renderRow:function(n){var r=e.cloneNode(!1);if(null!=n.header)r.className="dropdown-header",r.textContent=n.header;else{var a=t.cloneNode(!1);n===o&&(a.className="is-active"),a.textContent=n,a.dataset.ref=n,r.appendChild(a)}return r},id:function(e,t){return t.attr("data-ref")},toggleLabel:function(e,t){return t.text().trim()},clicked:function(e){if(e.e.preventDefault(),r()('input[name="ref"]').length){var t=n.closest("form"),o=n.data("visit"),a=!!o||o,i=t.attr("action"),s=-1===i.indexOf("?")?"?":"&";a&&Object(c.g)("".concat(i).concat(s).concat(t.serialize()))}}})})}}],(n=null)&&h(t.prototype,n),o&&h(t,o),e}()},302:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a={name:"NavigationTabs",props:{tabs:{type:Array,required:!0},scope:{type:String,required:!1,default:""}},mounted:function(){r()(document).trigger("init.scrolling-tabs")},methods:{shouldRenderBadge:function(e){return!(void 0===e||null===e)},onTabClick:function(e){this.$emit("onChangeTab",e.scope)}}},i=n(3),s=Object(i.a)(a,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"nav-links scrolling-tabs separator"},e._l(e.tabs,function(t,o){return n("li",{key:o,class:{active:t.isActive}},[n("a",{class:"js-"+e.scope+"-tab-"+t.scope,attrs:{role:"button"},on:{click:function(n){e.onTabClick(t)}}},[e._v("\n      "+e._s(t.name)+"\n\n      "),e.shouldRenderBadge(t.count)?n("span",{staticClass:"badge badge-pill"},[e._v(" "+e._s(t.count)+" ")]):e._e()])])}),0)},[],!1,null,null,null);s.options.__file="navigation_tabs.vue";t.a=s.exports},362:function(e,t,n){"use strict";t.a=function(e,t){var n=document.querySelector(e),o=document.querySelector(t),r=n.closest("form");n.addEventListener("click",function(){o.click()}),o.addEventListener("change",function(){r.querySelector(".js-filename").textContent=o.value.replace(/^.*[\\\/]/,"")})}},41:function(e,t,n){"use strict";var o=n(0),r=n.n(o);t.a={bind:function(e){r()(e).tooltip({trigger:"hover"})},componentUpdated:function(e){r()(e).tooltip("_fixTitle");var t=r()(e).data("bs.tooltip"),n=t.getTipElement();t.setElementContent(r()(n.querySelectorAll(".tooltip-inner")),t.getTitle())},unbind:function(e){r()(e).tooltip("dispose")}}},44:function(e,t,n){"use strict";n.r(t);var o=n(38),r=n(36),a=n(29),i=n(27);document.addEventListener("DOMContentLoaded",function(){var e=document.body.dataset.page;if(["projects:clusters:new","projects:clusters:create_gcp","projects:clusters:create_user"].indexOf(e)>-1){var t=document.querySelector(".gcp-signup-offer");t&&new r.a(t),Object(o.a)()}new a.a,new i.a})},500:function(e,t,n){"use strict";var o=n(0),r=n.n(o);function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.initDropdown()}var t,n,o;return t=e,(n=[{key:"initDropdown",value:function(){var e=this.options.onSelect;this.options.$dropdown.glDropdown({data:this.options.data,selectable:!0,inputId:this.options.$dropdown.data("inputId"),fieldName:this.options.$dropdown.data("fieldName"),toggleLabel:function(e,t){return t.is(".is-active")?e.text:"Select"},clicked:function(t){t.e.preventDefault(),e()}})}}])&&a(t.prototype,n),o&&a(t,o),e}(),s=n(201);function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$form=r()(".js-new-protected-tag"),this.buildDropdowns()}var t,n,o;return t=e,o=[{key:"getProtectedTags",value:function(e,t){t(gon.open_tags)}}],(n=[{key:"buildDropdowns",value:function(){var t=this.$form.find(".js-allowed-to-create");this.onSelectCallback=this.onSelect.bind(this),this.protectedTagAccessDropdown=new i({$dropdown:t,data:gon.create_access_levels,onSelect:this.onSelectCallback}),t.data("glDropdown").selectRowAtIndex(0),this.createItemDropdown=new s.a({$dropdown:this.$form.find(".js-protected-tag-select"),defaultToggleLabel:"Protected Tag",fieldName:"protected_tag[name]",onSelect:this.onSelectCallback,getData:e.getProtectedTags})}},{key:"onSelect",value:function(){var e=this.$form.find('input[name="protected_tag[name]"]'),t=this.$form.find("#create_access_levels_attributes");this.$form.find('input[type="submit"]').prop("disabled",!(e.val()&&t.length))}}])&&c(t.prototype,n),o&&c(t,o),e}(),u=n(7),d=n(6);function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$wrap=t.$wrap,this.$allowedToCreateDropdownButton=this.$wrap.find(".js-allowed-to-create"),this.onSelectCallback=this.onSelect.bind(this),this.buildDropdowns()}var t,n,o;return t=e,(n=[{key:"buildDropdowns",value:function(){this.protectedTagAccessDropdown=new i({$dropdown:this.$allowedToCreateDropdownButton,data:gon.create_access_levels,onSelect:this.onSelectCallback})}},{key:"onSelect",value:function(){var e=this,t=this.$wrap.find('input[name="'.concat(this.$allowedToCreateDropdownButton.data("fieldName"),'"]'));t.length&&(this.$allowedToCreateDropdownButton.disable(),d.a.patch(this.$wrap.data("url"),{protected_tag:{create_access_levels_attributes:[{id:this.$allowedToCreateDropdownButton.data("accessLevelId"),access_level:t.val()}]}}).then(function(){e.$allowedToCreateDropdownButton.enable()}).catch(function(){e.$allowedToCreateDropdownButton.enable(),Object(u.a)("Failed to update tag!","alert",document.querySelector(".js-protected-tags-list"))}))}}])&&h(t.prototype,n),o&&h(t,o),e}();function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var b=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$wrap=r()(".protected-tags-list"),this.initEditForm()}var t,n,o;return t=e,(n=[{key:"initEditForm",value:function(){this.$wrap.find(".js-protected-tag-edit-form").each(function(e,t){new p({$wrap:r()(t)})})}}])&&f(t.prototype,n),o&&f(t,o),e}(),y=n(155),v=n(11),g=n(1),w=n(302),m=new v.default;function j(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var _=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.axios=d.a.create({baseURL:t})}var t,n,o;return t=e,(n=[{key:"getKeys",value:function(){return this.axios.get().then(function(e){return e.data})}},{key:"enableKey",value:function(e){return this.axios.put("".concat(e,"/enable")).then(function(e){return e.data})}},{key:"disableKey",value:function(e){return this.axios.put("".concat(e,"/disable")).then(function(e){return e.data})}}])&&j(t.prototype,n),o&&j(t,o),e}();function k(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var $=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keys={}}var t,n,o;return t=e,(n=[{key:"isEnabled",value:function(e){return this.keys.enabled_keys.some(function(t){return t.id===e})}}])&&k(t.prototype,n),o&&k(t,o),e}(),S=n(5),C=n.n(S),D=n(15),T=n(41),O=n(84),P=n(10),K={components:{GlLoadingIcon:P.e},props:{deployKey:{type:Object,required:!0},type:{type:String,required:!0},btnCssClass:{type:String,required:!1,default:"btn-default"}},data:function(){return{isLoading:!1}},methods:{doAction:function(){var e=this;this.isLoading=!0,m.$emit("".concat(this.type,".key"),this.deployKey,function(){e.isLoading=!1})}}},I=n(3),x=Object(I.a)(K,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"btn",class:[{disabled:e.isLoading},e.btnCssClass],attrs:{disabled:e.isLoading},on:{click:e.doAction}},[e._t("default"),e._v(" "),e.isLoading?n("gl-loading-icon",{attrs:{inline:!0}}):e._e()],2)},[],!1,null,null,null);function E(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}x.options.__file="action_btn.vue";var A={components:{actionBtn:x.exports,icon:D.a},directives:{tooltip:T.a},mixins:[O.a],props:{deployKey:{type:Object,required:!0},store:{type:Object,required:!0},endpoint:{type:String,required:!0},projectId:{type:String,required:!1,default:null}},data:function(){return{projectsExpanded:!1}},computed:{editDeployKeyPath:function(){return"".concat(this.endpoint,"/").concat(this.deployKey.id,"/edit")},projects:function(){var e=this,t=E(this.deployKey.deploy_keys_projects);if(null!==this.projectId){var n=C.a.findIndex(t,function(t){return t&&t.project&&t.project.id&&t.project.id.toString()===e.projectId});if(n>-1){var o=t.splice(n,1);return o[0].project.full_name=Object(g.e)("DeployKeys|Current project"),o.concat(t)}}return t},firstProject:function(){return C.a.head(this.projects)},restProjects:function(){return C.a.tail(this.projects)},restProjectsTooltip:function(){return Object(g.f)(Object(g.e)("DeployKeys|Expand %{count} other projects"),{count:this.restProjects.length})},restProjectsLabel:function(){return Object(g.f)(Object(g.e)("DeployKeys|+%{count} others"),{count:this.restProjects.length})},isEnabled:function(){return this.store.isEnabled(this.deployKey.id)},isRemovable:function(){return this.store.isEnabled(this.deployKey.id)&&this.deployKey.destroyed_when_orphaned&&this.deployKey.almost_orphaned},isExpandable:function(){return!this.projectsExpanded&&this.restProjects.length>1},isExpanded:function(){return this.projectsExpanded||1===this.restProjects.length}},methods:{projectTooltipTitle:function(e){return e.can_push?Object(g.e)("DeployKeys|Write access allowed"):Object(g.e)("DeployKeys|Read access only")},toggleExpanded:function(){this.projectsExpanded=!this.projectsExpanded}}},H=Object(I.a)(A,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"gl-responsive-table-row deploy-key"},[n("div",{staticClass:"table-section section-40"},[n("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v(e._s(e.s__("DeployKeys|Deploy key")))]),e._v(" "),n("div",{staticClass:"table-mobile-content"},[n("strong",{staticClass:"title qa-key-title"},[e._v(" "+e._s(e.deployKey.title)+" ")]),e._v(" "),n("div",{staticClass:"fingerprint qa-key-fingerprint"},[e._v(e._s(e.deployKey.fingerprint))])])]),e._v(" "),n("div",{staticClass:"table-section section-30 section-wrap"},[n("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v(e._s(e.s__("DeployKeys|Project usage")))]),e._v(" "),n("div",{staticClass:"table-mobile-content deploy-project-list"},[e.projects.length>0?[n("a",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"label deploy-project-label",attrs:{title:e.projectTooltipTitle(e.firstProject)}},[n("span",[e._v(" "+e._s(e.firstProject.project.full_name)+" ")]),e._v(" "),n("icon",{attrs:{name:e.firstProject.can_push?"lock-open":"lock"}})],1),e._v(" "),e.isExpandable?n("a",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"label deploy-project-label",attrs:{title:e.restProjectsTooltip},on:{click:e.toggleExpanded}},[n("span",[e._v(e._s(e.restProjectsLabel))])]):e.isExpanded?e._l(e.restProjects,function(t){return n("a",{directives:[{name:"tooltip",rawName:"v-tooltip"}],key:t.project.full_path,staticClass:"label deploy-project-label",attrs:{href:t.project.full_path,title:e.projectTooltipTitle(t)}},[n("span",[e._v(" "+e._s(t.project.full_name)+" ")]),e._v(" "),n("icon",{attrs:{name:t.can_push?"lock-open":"lock"}})],1)}):e._e()]:n("span",{staticClass:"text-secondary"},[e._v(e._s(e.__("None")))])],2)]),e._v(" "),n("div",{staticClass:"table-section section-15 text-right"},[n("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v(e._s(e.__("Created")))]),e._v(" "),n("div",{staticClass:"table-mobile-content text-secondary key-created-at"},[n("span",{directives:[{name:"tooltip",rawName:"v-tooltip"}],attrs:{title:e.tooltipTitle(e.deployKey.created_at)}},[n("icon",{attrs:{name:"calendar"}}),e._v(" "),n("span",[e._v(e._s(e.timeFormated(e.deployKey.created_at)))])],1)])]),e._v(" "),n("div",{staticClass:"table-section section-15 table-button-footer deploy-key-actions"},[n("div",{staticClass:"btn-group table-action-buttons"},[e.isEnabled?e._e():n("action-btn",{attrs:{"deploy-key":e.deployKey,type:"enable"}},[e._v("\n        "+e._s(e.__("Enable"))+"\n      ")]),e._v(" "),e.deployKey.can_edit?n("a",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"btn btn-default text-secondary",attrs:{href:e.editDeployKeyPath,title:e.__("Edit"),"data-container":"body"}},[n("icon",{attrs:{name:"pencil"}})],1):e._e(),e._v(" "),e.isRemovable?n("action-btn",{directives:[{name:"tooltip",rawName:"v-tooltip"}],attrs:{"deploy-key":e.deployKey,title:e.__("Remove"),"btn-css-class":"btn-danger",type:"remove","data-container":"body"}},[n("icon",{attrs:{name:"remove"}})],1):e.isEnabled?n("action-btn",{directives:[{name:"tooltip",rawName:"v-tooltip"}],attrs:{"deploy-key":e.deployKey,title:e.__("Disable"),"btn-css-class":"btn-warning",type:"disable","data-container":"body"}},[n("icon",{attrs:{name:"cancel"}})],1):e._e()],1)])])},[],!1,null,null,null);H.options.__file="key.vue";var B={components:{deployKey:H.exports},props:{keys:{type:Array,required:!0},store:{type:Object,required:!0},endpoint:{type:String,required:!0},projectId:{type:String,required:!1,default:null}}},L=Object(I.a)(B,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"deploy-keys-panel table-holder"},[e.keys.length>0?[n("div",{staticClass:"gl-responsive-table-row table-row-header",attrs:{role:"row"}},[n("div",{staticClass:"table-section section-40",attrs:{role:"rowheader"}},[e._v("\n        "+e._s(e.s__("DeployKeys|Deploy key"))+"\n      ")]),e._v(" "),n("div",{staticClass:"table-section section-30",attrs:{role:"rowheader"}},[e._v("\n        "+e._s(e.s__("DeployKeys|Project usage"))+"\n      ")]),e._v(" "),n("div",{staticClass:"table-section section-15 text-right",attrs:{role:"rowheader"}},[e._v(e._s(e.__("Created")))])]),e._v(" "),e._l(e.keys,function(t){return n("deploy-key",{key:t.id,attrs:{"deploy-key":t,store:e.store,endpoint:e.endpoint,"project-id":e.projectId}})})]:n("div",{staticClass:"settings-message text-center"},[e._v("\n    "+e._s(e.s__("DeployKeys|No deploy keys found. Create one with the form above."))+"\n  ")])],2)},[],!1,null,null,null);L.options.__file="keys_panel.vue";var N={components:{KeysPanel:L.exports,NavigationTabs:w.a,GlLoadingIcon:P.e},props:{endpoint:{type:String,required:!0},projectId:{type:String,required:!0}},data:function(){return{currentTab:"enabled_keys",isLoading:!1,store:new $}},scopes:{enabled_keys:Object(g.e)("DeployKeys|Enabled deploy keys"),available_project_keys:Object(g.e)("DeployKeys|Privately accessible deploy keys"),public_keys:Object(g.e)("DeployKeys|Publicly accessible deploy keys")},computed:{tabs:function(){var e=this;return Object.keys(this.$options.scopes).map(function(t){var n=Array.isArray(e.keys[t])?e.keys[t].length:null;return{name:e.$options.scopes[t],scope:t,isActive:t===e.currentTab,count:n}})},hasKeys:function(){return Object.keys(this.keys).length},keys:function(){return this.store.keys}},created:function(){this.service=new _(this.endpoint),m.$on("enable.key",this.enableKey),m.$on("remove.key",this.disableKey),m.$on("disable.key",this.disableKey)},mounted:function(){this.fetchKeys()},beforeDestroy:function(){m.$off("enable.key",this.enableKey),m.$off("remove.key",this.disableKey),m.$off("disable.key",this.disableKey)},methods:{onChangeTab:function(e){this.currentTab=e},fetchKeys:function(){var e=this;return this.isLoading=!0,this.service.getKeys().then(function(t){e.isLoading=!1,e.store.keys=t}).catch(function(){return e.isLoading=!1,e.store.keys={},new u.a(Object(g.e)("DeployKeys|Error getting deploy keys"))})},enableKey:function(e){this.service.enableKey(e.id).then(this.fetchKeys).catch(function(){return new u.a(Object(g.e)("DeployKeys|Error enabling deploy key"))})},disableKey:function(e,t){window.confirm(Object(g.e)("DeployKeys|You are going to remove this deploy key. Are you sure?"))?this.service.disableKey(e.id).then(this.fetchKeys).then(t).catch(function(){return new u.a(Object(g.e)("DeployKeys|Error removing deploy key"))}):t()}}},q=Object(I.a)(N,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"append-bottom-default deploy-keys"},[e.isLoading&&!e.hasKeys?n("gl-loading-icon",{attrs:{label:e.s__("DeployKeys|Loading deploy keys"),size:2}}):e.hasKeys?[n("div",{staticClass:"top-area scrolling-tabs-container inner-page-scroll-tabs"},[n("div",{staticClass:"fade-left"},[n("i",{staticClass:"fa fa-angle-left",attrs:{"aria-hidden":"true"}})]),e._v(" "),n("div",{staticClass:"fade-right"},[n("i",{staticClass:"fa fa-angle-right",attrs:{"aria-hidden":"true"}})]),e._v(" "),n("navigation-tabs",{attrs:{tabs:e.tabs,scope:"deployKeys"},on:{onChangeTab:e.onChangeTab}})],1),e._v(" "),n("keys-panel",{staticClass:"qa-project-deploy-keys",attrs:{"project-id":e.projectId,keys:e.keys[e.currentTab],store:e.store,endpoint:e.endpoint}})]:e._e()],2)},[],!1,null,null,null);q.options.__file="app.vue";var M=q.exports;function R(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var F=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.initDropdown()}var t,n,o;return t=e,(n=[{key:"initDropdown",value:function(){var e=this.options,t=e.$dropdown,n=e.data,o=e.onSelect;t.glDropdown({data:n,selectable:!0,inputId:t.data("inputId"),fieldName:t.data("fieldName"),toggleLabel:function(e,t){return t.is(".is-active")?e.text:"Select"},clicked:function(e){e.e.preventDefault(),o()}})}}])&&R(t.prototype,n),o&&R(t,o),e}(),U=n(31);function W(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var G=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$form=r()(".js-new-protected-branch"),this.isLocalStorageAvailable=U.a.isLocalStorageAccessSafe(),this.currentProjectUserDefaults={},this.buildDropdowns()}var t,n,o;return t=e,o=[{key:"getProtectedBranches",value:function(e,t){t(gon.open_branches)}}],(n=[{key:"buildDropdowns",value:function(){var t=this.$form.find(".js-allowed-to-merge"),n=this.$form.find(".js-allowed-to-push"),o=this.$form.find(".js-protected-branch-select");this.onSelectCallback=this.onSelect.bind(this),this.protectedBranchMergeAccessDropdown=new F({$dropdown:t,data:gon.merge_access_levels,onSelect:this.onSelectCallback}),this.protectedBranchPushAccessDropdown=new F({$dropdown:n,data:gon.push_access_levels,onSelect:this.onSelectCallback}),this.createItemDropdown=new s.a({$dropdown:o,defaultToggleLabel:"Protected Branch",fieldName:"protected_branch[name]",onSelect:this.onSelectCallback,getData:e.getProtectedBranches})}},{key:"onSelect",value:function(){var e=this.$form.find('input[name="protected_branch[name]"]'),t=this.$form.find('input[name="protected_branch[merge_access_levels_attributes][0][access_level]"]'),n=this.$form.find('input[name="protected_branch[push_access_levels_attributes][0][access_level]"]'),o=!(e.val()&&t.length&&n.length);this.$form.find('input[type="submit"]').prop("disabled",o)}}])&&W(t.prototype,n),o&&W(t,o),e}();function V(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var J=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$wrap=t.$wrap,this.$allowedToMergeDropdown=this.$wrap.find(".js-allowed-to-merge"),this.$allowedToPushDropdown=this.$wrap.find(".js-allowed-to-push"),this.onSelectCallback=this.onSelect.bind(this),this.buildDropdowns()}var t,n,o;return t=e,(n=[{key:"buildDropdowns",value:function(){this.protectedBranchAccessDropdown=new F({$dropdown:this.$allowedToMergeDropdown,data:gon.merge_access_levels,onSelect:this.onSelectCallback}),this.protectedBranchAccessDropdown=new F({$dropdown:this.$allowedToPushDropdown,data:gon.push_access_levels,onSelect:this.onSelectCallback})}},{key:"onSelect",value:function(){var e=this,t=this.$wrap.find('input[name="'.concat(this.$allowedToMergeDropdown.data("fieldName"),'"]')),n=this.$wrap.find('input[name="'.concat(this.$allowedToPushDropdown.data("fieldName"),'"]'));t.length&&n.length&&(this.$allowedToMergeDropdown.disable(),this.$allowedToPushDropdown.disable(),d.a.patch(this.$wrap.data("url"),{protected_branch:{merge_access_levels_attributes:[{id:this.$allowedToMergeDropdown.data("accessLevelId"),access_level:t.val()}],push_access_levels_attributes:[{id:this.$allowedToPushDropdown.data("accessLevelId"),access_level:n.val()}]}}).then(function(){e.$allowedToMergeDropdown.enable(),e.$allowedToPushDropdown.enable()}).catch(function(){e.$allowedToMergeDropdown.enable(),e.$allowedToPushDropdown.enable(),Object(u.a)("Failed to update branch!","alert",document.querySelector(".js-protected-branches-list"))}))}}])&&V(t.prototype,n),o&&V(t,o),e}();function z(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var Y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$wrap=r()(".protected-branches-list"),this.initEditForm()}var t,n,o;return t=e,(n=[{key:"initEditForm",value:function(){this.$wrap.find(".js-protected-branch-edit-form").each(function(e,t){new J({$wrap:r()(t)})})}}])&&z(t.prototype,n),o&&z(t,o),e}(),Q=n(126),X=n(362);t.a=function(){new l,new b,new v.default({el:document.getElementById("js-deploy-keys"),components:{deployKeysApp:M},data:function(){return{endpoint:this.$options.el.dataset.endpoint,projectId:this.$options.el.dataset.projectId}},render:function(e){return e("deploy-keys-app",{props:{endpoint:this.endpoint,projectId:this.projectId}})}}),Object(y.a)(),new G,new Y,new Q.a,Object(X.a)(".js-choose-file",".js-object-map-input")}},84:function(e,t,n){"use strict";var o=n(20);t.a={methods:{timeFormated:function(e){return Object(o.h)().format(e)},tooltipTitle:function(e){return Object(o.d)(e)}}}}},[[1367,1,0,2,10]]]);
//# sourceMappingURL=pages.projects.settings.repository.show.08457af4.chunk.js.map