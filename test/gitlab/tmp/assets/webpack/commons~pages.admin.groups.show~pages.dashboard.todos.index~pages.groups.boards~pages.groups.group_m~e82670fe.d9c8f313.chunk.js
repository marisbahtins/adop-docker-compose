(this.webpackJsonp=this.webpackJsonp||[]).push([[4],{105:function(e,t,a){"use strict";var s=a(0),n=a.n(s),r=a(5),i=a.n(r),l=a(6),u=a(1),o=a(48);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){var a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.users=this.users.bind(this),this.user=this.user.bind(this),this.usersPath="/autocomplete/users.json",this.userPath="/autocomplete/users/:id.json",null!=e&&("object"===d(e)?this.currentUser=e:this.currentUser=JSON.parse(e));var r,c=s.handleClick;a=n()(t),t||(a=n()(".js-user-search")),a.each((r=this,function(e,t){var a,s,d,f,m,v,p,h,g,b,I,y,w,S,k,U,_,C,j,x={};d=n()(t),x.projectId=d.data("projectId"),x.groupId=d.data("groupId"),x.showCurrentUser=d.data("currentUser"),x.todoFilter=d.data("todoFilter"),x.todoStateFilter=d.data("todoStateFilter"),C=d.data("nullUser"),y=d.data("nullUserDefault"),j=d.data("showMenuAbove"),_=d.data("anyUser"),w=d.data("firstUser"),x.authorId=d.data("authorId"),I=d.data("defaultLabel"),S=d.data("issueUpdate"),m=d.closest(".selectbox"),a=m.closest(".block"),p=d.data("abilityName"),v=a.find(".value"),s=a.find(".sidebar-collapsed-user"),f=a.find(".block-loading").fadeOut(),U=y&&C?0:null,void 0===(k=d.data("selected"))&&(k=U);var N=function(){var e=d.closest(".selectbox").find("input[name='".concat(d.data("fieldName"),"'][value=0]"));e&&e.remove();var t=document.createElement("input");t.type="hidden",t.name=d.data("fieldName");var a=d.data("currentUserInfo");a?(t.value=a.id,t.dataset.meta=i.a.escape(a.name)):r.currentUser&&(t.value=r.currentUser.id),m?d.parent().before(t):d.after(t)};a[0]&&a[0].addEventListener("assignYourself",N);var D=function(){return m.find('input[name="'.concat(d.data("fieldName"),'"]'))},A=function(){return D().map(function(e,t){return parseInt(t.value,10)}).get()},E=function(){var e=d.data("maxSelect");if(e){var t=A();if(t.length>e){var a=t[0];d.closest(".selectbox").find("input[name='".concat(d.data("fieldName"),"'][value=").concat(a,"]")).remove(),emitSidebarEvent("sidebar.removeAssignee",{id:a})}}},L=function(e,t){var a=A().filter(function(e){return 0!==e}),s=D().map(function(e,t){return{name:t.dataset.meta,value:parseInt(t.value,10)}}).filter(function(e){return 0!==e.id}).get(0);if(0===a.length)return"Unassigned";if(1===a.length)return s.name;if(t){var n=a.filter(function(t){return t!==e.id});return"".concat(e.name," + ").concat(n.length," more")}return"".concat(s.name," + ").concat(a.length-1," more")};return n()(".assign-to-me-link").on("click",function(e){if(e.preventDefault(),n()(e.currentTarget).hide(),d.data("multiSelect")){N(),E();var t=d.data("currentUserInfo");d.find(".dropdown-toggle-text").text(L(t)).removeClass("is-default")}else{var a=n()('input[name="'.concat(d.data("fieldName"),'"]'));a.val(gon.current_user_id),k=a.val(),d.find(".dropdown-toggle-text").text(gon.current_user_fullname).removeClass("is-default")}}),a.on("click",".js-assign-yourself",function(e){return e.preventDefault(),h(r.currentUser.id)}),h=function(e){var t;return(t={})[p]={},t[p].assignee_id=null!=e?e:null,f.removeClass("hidden").fadeIn(),d.trigger("loading.gl.dropdown"),l.a.put(S,t).then(function(e){var t,a,n=e.data;return d.trigger("loaded.gl.dropdown"),f.fadeOut(),n.assignee?(t={name:n.assignee.name,username:n.assignee.username,avatar:n.assignee.avatar_url},a=i.a.escape(t.name)):(t={name:"Unassigned",username:"",avatar:""},a=Object(u.a)("Assignee")),v.html(g(t)),s.attr("title",a).tooltip("_fixTitle"),s.html(b(t))})},b=i.a.template('<% if( avatar ) { %> <a class="author-link" href="/<%- username %>"> <img width="24" class="avatar avatar-inline s24" alt="" src="<%- avatar %>"> </a> <% } else { %> <i class="fa fa-user"></i> <% } %>'),g=i.a.template('<% if (username) { %> <a class="author-link bold" href="/<%- username %>"> <% if( avatar ) { %> <img width="32" class="avatar avatar-inline s32" alt="" src="<%- avatar %>"> <% } %> <span class="author"><%- name %></span> <span class="username"> @<%- username %> </span> </a> <% } else { %> <span class="no-value assign-yourself"> No assignee - <a href="#" class="js-assign-yourself"> assign yourself </a> </span> <% } %>'),d.glDropdown({showMenuAbove:j,data:function(e,t){return r.users(e,x,function(a){(this.instance||this.options.instance).options.processData(e,a,t)}.bind(this))},processData:function(e,t,a){var s,n,r,l,u,o,c=t;if(d.hasClass("js-multiselect")&&0===e.length){var f=D(),m=i.a.uniq(f,!1,function(e){return e.value}).filter(function(e){var t=parseInt(e.value,10);return!c.find(function(e){return e.id===t})&&0!==t}).map(function(e){var t=parseInt(e.value,10),a=e.dataset,s=a.avatarUrl,n=a.avatar_url,r=a.name,i=a.username;return{avatar_url:s||n,id:t,name:r,username:i}});c=t.concat(m)}if(0===e.length){if(o=0,w)for(n=0,r=c.length;n<r;n+=1)if((u=c[n]).username===w){c.splice(n,1),c.unshift(u);break}if(C&&(o+=1,c.unshift({beforeDivider:!0,name:"Unassigned",id:0})),_&&(o+=1,!0===(l=_)&&(l="Any User"),s={beforeDivider:!0,name:l,id:null},c.unshift(s)),o&&c.splice(o,0,"divider"),d.hasClass("js-multiselect")){var v=A().filter(function(e){return 0!==e});if(v.length>0){d.data("dropdownHeader")&&(o+=1,c.splice(o,0,{header:d.data("dropdownHeader")}));var p=c.filter(function(e){return-1!==v.indexOf(e.id)}).sort(function(e,t){return e.name>t.name});c=c.filter(function(e){return-1===v.indexOf(e.id)}),p.forEach(function(e){o+=1,c.splice(o,0,e)}),c.splice(o+1,0,"divider")}}}a(c),j&&d.data("glDropdown").positionMenuAbove()},filterable:!0,filterRemote:!0,search:{fields:["name","username"]},selectable:!0,fieldName:d.data("fieldName"),toggleLabel:function(e,t,a){var s=a.filterInput.val();if(this.multiSelect&&""===s){var r=a.filteredFullData(),i=a.parseData.bind(a);this.processData(s,r,i)}return this.multiSelect?L(e,n()(t).hasClass("is-active")):e&&"id"in e&&n()(t).hasClass("is-active")?(d.find(".dropdown-toggle-text").removeClass("is-default"),e.text?e.text:e.name):(d.find(".dropdown-toggle-text").addClass("is-default"),I)},defaultLabel:I,hidden:function(e){d.hasClass("js-multiselect")&&emitSidebarEvent("sidebar.saveAssignees"),d.data("alwaysShowSelectbox")||(m.hide(),a=m.closest(".block"),(v=a.find(".value")).css("display",""))},multiSelect:d.hasClass("js-multiselect"),inputMeta:d.data("inputMeta"),clicked:function(e){var t,a,s,r,i=e.$el,l=e.e,u=e.isMarking,f=e.selectedObj;if(d.hasClass("js-multiselect")){var m=i.hasClass("is-active"),v=d.closest(".selectbox").find("input[name='"+d.data("fieldName")+"'][value!=0]");if(E(),f.beforeDivider&&"unassigned"===f.name.toLowerCase())v.each(function(e,t){parseInt(t.value,10),t.remove()}),emitSidebarEvent("sidebar.removeAllAssignees");else if(m){emitSidebarEvent("sidebar.addAssignee",f);var p=d.closest(".selectbox").find("input[name='"+d.data("fieldName")+"'][value=0]");p&&p.remove()}else 0===v.length&&this.addInput(d.data("fieldName"),0,{}),emitSidebarEvent("sidebar.removeAssignee",f);A().find(function(e){return e===gon.current_user_id})?n()(".assign-to-me-link").hide():n()(".assign-to-me-link").show()}if(t="projects:issues:index"===(s=n()("body").attr("data-page")),a=s==s&&"projects:merge_requests:index"===s,d.hasClass("js-filter-bulk-update")||d.hasClass("js-issuable-form-dropdown")){l.preventDefault();var g=f.id!==k;(k=g?f.id:U)===gon.current_user_id?n()(".assign-to-me-link").hide():n()(".assign-to-me-link").show()}else{if(i.closest(".add-issues-modal").length)o.a.store.filter[d.data("fieldName")]=f.id;else if(c)l.preventDefault(),c(f,u);else{if(d.hasClass("js-filter-submit")&&(t||a))return Issuable.filterResults(d.closest("form"));if(d.hasClass("js-filter-submit"))return d.closest("form").submit();if(!d.hasClass("js-multiselect"))return r=d.closest(".selectbox").find("input[name='"+d.data("fieldName")+"']").val(),h(r)}d.data("maxSelect")&&A().length===d.data("maxSelect")&&d.dropdown("toggle")}},id:function(e){return e.id},opened:function(e){var t=n()(e.currentTarget),a=A();function s(e){t.find('li[data-user-id="'.concat(e,'"] .dropdown-menu-user-link')).addClass("is-active")}d.hasClass("js-issue-board-sidebar")&&0===a.length&&this.addInput(d.data("fieldName"),0,{}),t.find(".is-active").removeClass("is-active"),a.length>0?A().forEach(function(e){return s(e)}):d.hasClass("js-issue-board-sidebar")?s(0):s(k)},updateLabel:d.data("dropdownTitle"),renderRow:function(e){var t,a,s;s=e.username?"@"+e.username:"",t=e.avatar_url?e.avatar_url:gon.default_avatar_url;var n=!1;if(this.multiSelect){n=A().find(function(t){return e.id===t});var r=this.fieldName;d.closest(".selectbox").find("input[name='"+r+"'][value='"+e.id+"']").length&&(n=!0)}else n=e.id===k;return a="",null!=e.beforeDivider?"<li><a href='#' class='".concat(!0===n?"is-active":"","'>").concat(i.a.escape(e.name),"</a></li>"):a="<img src='"+t+"' class='avatar avatar-inline' width='32' />","\n            <li data-user-id=".concat(e.id,">\n              <a href='#' class='dropdown-menu-user-link ").concat(!0===n?"is-active":"","'>\n                ").concat(a,"\n                <strong class='dropdown-menu-user-full-name'>\n                  ").concat(i.a.escape(e.name),"\n                </strong>\n                ").concat(s?"<span class='dropdown-menu-user-username'>".concat(s,"</span>"):"","\n              </a>\n            </li>\n          ")}})})),n()(".ajax-users-select").each(function(e){return function(t,a){var s,r,i,l,u={};return u.skipLdap=n()(a).hasClass("skip_ldap"),u.projectId=n()(a).data("projectId"),u.groupId=n()(a).data("groupId"),u.showCurrentUser=n()(a).data("currentUser"),u.authorId=n()(a).data("authorId"),u.skipUsers=n()(a).data("skipUsers"),l=n()(a).data("nullUser"),r=n()(a).data("anyUser"),i=n()(a).data("emailUser"),s=n()(a).data("firstUser"),n()(a).select2({placeholder:"Search for a user",multiple:n()(a).hasClass("multiselect"),minimumInputLength:0,query:function(t){return e.users(t.term,u,function(e){var a,n,u,o,d,c,f,m,v;if(n={results:e},0===t.term.length){if(s)for(o=0,d=(v=n.results).length;o<d;o+=1)if((m=v[o]).username===s){n.results.splice(o,1),n.results.unshift(m);break}l&&(f={name:"Unassigned",id:0},n.results.unshift(f)),r&&(!0===(c=r)&&(c="Any User"),a={name:c,id:null},n.results.unshift(a))}if(i&&0===n.results.length&&t.term.match(/^[^@]+@[^@]+$/)){var p=t.term.trim();u={name:'Invite "'+p+'" by email',username:p,id:p,invite:!0},n.results.unshift(u)}return t.callback(n)})},initSelection:function(){var t;return t=1<=arguments.length?[].slice.call(arguments,0):[],e.initSelection.apply(e,t)},formatResult:function(){var t;return t=1<=arguments.length?[].slice.call(arguments,0):[],e.formatResult.apply(e,t)},formatSelection:function(){var t;return t=1<=arguments.length?[].slice.call(arguments,0):[],e.formatSelection.apply(e,t)},dropdownCssClass:"ajax-users-dropdown",escapeMarkup:function(e){return e}})}}(this))}window.emitSidebarEvent=window.emitSidebarEvent||n.a.noop,c.prototype.initSelection=function(e,t){var a;return"0"===(a=n()(e).val())?t({name:"Unassigned"}):""!==a?this.user(a,t):void 0},c.prototype.formatResult=function(e){var t;return t=e.avatar_url?e.avatar_url:gon.default_avatar_url,"\n    <div class='user-result'>\n      <div class='user-image'>\n        <img class='avatar avatar-inline s32' src='".concat(t,"'>\n      </div>\n      <div class='user-info'>\n        <div class='user-name dropdown-menu-user-full-name'>\n          ").concat(i.a.escape(e.name),"\n        </div>\n        <div class='user-username dropdown-menu-user-username text-secondary'>\n          ").concat(e.invite?"":"@"+i.a.escape(e.username),"\n        </div>\n      </div>\n    </div>\n  ")},c.prototype.formatSelection=function(e){return i.a.escape(e.name)},c.prototype.user=function(e,t){return!!/^\d+$/.test(e)&&(a=(a=this.buildUrl(this.userPath)).replace(":id",e),l.a.get(a).then(function(e){var a=e.data;t(a)}));var a},c.prototype.users=function(e,t,a){var s=this.buildUrl(this.usersPath),n={search:e,active:!0,project_id:t.projectId||null,group_id:t.groupId||null,skip_ldap:t.skipLdap||null,todo_filter:t.todoFilter||null,todo_state_filter:t.todoStateFilter||null,current_user:t.showCurrentUser||null,author_id:t.authorId||null,skip_users:t.skipUsers||null};return l.a.get(s,{params:n}).then(function(e){var t=e.data;a(t)})},c.prototype.buildUrl=function(e){return null!=gon.relative_url_root&&(e=gon.relative_url_root.replace(/\/$/,"")+e),e},t.a=c},48:function(e,t,a){"use strict";function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store={columns:3,issues:[],issuesCount:!1,selectedIssues:[],showAddIssuesModal:!1,activeTab:"all",selectedList:null,searchTerm:"",loading:!1,loadingNewPage:!1,filterLoading:!1,page:1,perPage:50,filter:{path:""}}}var t,a,n;return t=e,(a=[{key:"selectedCount",value:function(){return this.getSelectedIssues().length}},{key:"toggleIssue",value:function(e){var t=e,a=t.selected;t.selected=!a,a?this.removeSelectedIssue(t):this.addSelectedIssue(t)}},{key:"toggleAll",value:function(){var e=this,t=this.selectedCount()!==this.store.issues.length;this.store.issues.forEach(function(a){var s=a;s.selected!==t&&(s.selected=t,t?e.addSelectedIssue(a):e.removeSelectedIssue(a))})}},{key:"getSelectedIssues",value:function(){return this.store.selectedIssues.filter(function(e){return e.selected})}},{key:"addSelectedIssue",value:function(e){-1===this.selectedIssueIndex(e)&&this.store.selectedIssues.push(e)}},{key:"removeSelectedIssue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];("all"===this.store.activeTab||t)&&(this.store.selectedIssues=this.store.selectedIssues.filter(function(t){return t.id!==e.id}))}},{key:"purgeUnselectedIssues",value:function(){var e=this;this.store.selectedIssues.forEach(function(t){t.selected||e.removeSelectedIssue(t,!0)})}},{key:"selectedIssueIndex",value:function(e){return this.store.selectedIssues.indexOf(e)}},{key:"findSelectedIssue",value:function(e){return this.store.selectedIssues.filter(function(t){return t.id===e.id})[0]}}])&&s(t.prototype,a),n&&s(t,n),e}();t.a=new n}}]);
//# sourceMappingURL=commons~pages.admin.groups.show~pages.dashboard.todos.index~pages.groups.boards~pages.groups.group_m~e82670fe.d9c8f313.chunk.js.map