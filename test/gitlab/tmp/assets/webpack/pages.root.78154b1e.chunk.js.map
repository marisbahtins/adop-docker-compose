{"version":3,"sources":["webpack:///./pages/root/index.js","webpack:///./filterable_list.js","webpack:///./projects_list.js","webpack:///./star.js","webpack:///./pages/dashboard/projects/index.js"],"names":["__webpack_require__","r","__webpack_exports__","FilterableList","form","filter","holder","filterInputField","arguments","length","undefined","_classCallCheck","this","filterForm","listFilterElement","listHolderElement","isBusy","concat","getAttribute","$","serialize","getFilterEndpoint","debounceFilter","_","debounce","onFilterInput","bind","unbindEvents","bindEvents","queryData","filterGroupsParam","find","val","filterResults","setDefaultFilterOption","addEventListener","removeEventListener","params","_this","fadeTo","axios","get","then","res","onFilterSuccess","onFilterComplete","catch","response","data","html","innerHTML","currentPath","getPagePath","window","history","replaceState","page","document","title","ProjectsList","querySelector","initSearch","Star","container","on","$this","$starSpan","$starIcon","iconClasses","attr","split","post","_ref","isStarred","hasClass","parent","text","star_count","removeClass","s__","remove","prepend","spriteIcon","addClass","__","Flash","_projects_list__WEBPACK_IMPORTED_MODULE_0__","_star__WEBPACK_IMPORTED_MODULE_1__"],"mappings":"uIAAAA,EAAAC,EAAAC,GAAAF,EAAA,4RCSqBG,aACnB,SAAAA,EAAYC,EAAMC,EAAQC,GAA4C,IAApCC,EAAoCC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAjB,6GAAiBG,CAAAC,KAAAT,GACpES,KAAKC,WAAaT,EAClBQ,KAAKE,kBAAoBT,EACzBO,KAAKG,kBAAoBT,EACzBM,KAAKL,iBAAmBA,EACxBK,KAAKI,QAAS,qEAId,SAAAC,OAAUL,KAAKC,WAAWK,aAAa,UAAvC,KAAAD,OAAoDE,IAAEP,KAAKC,YAAYO,mDAIvE,OAAOR,KAAKS,yDAKZT,KAAKU,eAAiBC,IAAEC,SAASZ,KAAKa,cAAcC,KAAKd,MAAO,KAEhEA,KAAKe,eACLf,KAAKgB,qDAIL,IACMC,KACAC,EAFQX,IAAEP,KAAKC,YAEWkB,KAAN,UAAAd,OAAqBL,KAAKL,iBAA1B,OAAgDyB,MAEtEF,IACFD,EAAUjB,KAAKL,kBAAoBuB,GAGrClB,KAAKqB,cAAcJ,GAEfjB,KAAKsB,wBACPtB,KAAKsB,8DAKPtB,KAAKE,kBAAkBqB,iBAAiB,QAASvB,KAAKU,uDAItDV,KAAKE,kBAAkBsB,oBAAoB,QAASxB,KAAKU,sDAG7Ce,GAAQ,IAAAC,EAAA1B,KACpB,OAAIA,KAAKI,SAITG,IAAEP,KAAKG,mBAAmBwB,OAAO,IAAK,IAEtC3B,KAAKI,QAAS,EAEPwB,IACJC,IAAI7B,KAAKS,qBACRgB,WAEDK,KAAK,SAAAC,GACJL,EAAKM,gBAAgBD,EAAKN,GAC1BC,EAAKO,qBAENC,MAAM,kBAAMR,EAAKO,8DAGNE,EAAUlB,GACpBkB,EAASC,KAAKC,OAChBrC,KAAKG,kBAAkBmC,UAAYH,EAASC,KAAKC,MAInD,IAAME,EAAcvC,KAAKwC,YAAYvB,GAErC,OAAOwB,OAAOC,QAAQC,cAElBC,KAAML,GAERM,SAASC,MACTP,8CAKFvC,KAAKI,QAAS,EACdG,IAAEP,KAAKG,mBAAmBwB,OAAO,IAAK,2HC3FrBoB,EACnB,SAAAA,iGAAchD,CAAAC,KAAA+C,GACZ,IAAMvD,EAAOqD,SAASG,cAAc,4BAC9BvD,EAASoD,SAASG,cAAc,4BAChCtD,EAASmD,SAASG,cAAc,4BAElCxD,GAAQC,GAAUC,GACP,IAAIH,IAAeC,EAAMC,EAAQC,GACzCuD,qICRUC,EACnB,SAAAA,IAA+C,IAAnCC,EAAmCvD,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAvB,mHAAuBG,CAAAC,KAAAkD,GAC7C3C,IAAC,GAAAF,OAAI8C,EAAJ,kBAA8BC,GAAG,QAAS,WACzC,IAAMC,EAAQ9C,IAAEP,MACVsD,EAAYD,EAAMlC,KAAK,QACvBoC,EAAYF,EAAMlC,KAAK,OACvBqC,EAAcD,EAAUE,KAAK,SAASC,MAAM,KAElD9B,IACG+B,KAAKN,EAAMjB,KAAK,aAChBN,KAAK,SAAA8B,GAAc,IAAXxB,EAAWwB,EAAXxB,KACDyB,EAAYP,EAAUQ,SAAS,WACrCT,EACGU,SACA5C,KAAK,eACL6C,KAAK5B,EAAK6B,YAETJ,GACFP,EAAUY,YAAY,WAAWF,KAAKG,YAAI,qBAC1CZ,EAAUa,SACVf,EAAMgB,QAAQC,YAAW,SAAUd,MAEnCF,EAAUiB,SAAS,WAAWP,KAAKQ,YAAG,WACtCjB,EAAUa,SACVf,EAAMgB,QAAQC,YAAW,OAAQd,OAGpCtB,MAAM,kBAAMuC,YAAM,+ECjC3BrF,EAAAC,EAAAC,GAAA,IAAAoF,EAAAtF,EAAA,KAAAuF,EAAAvF,EAAA,KAGAyD,SAAStB,iBAAiB,mBAAoB,WAC5C,IAAIwB,IACJ,IAAIG,IAAK","file":"pages.root.78154b1e.chunk.js","sourcesContent":["// if the \"projects dashboard\" is a user's default dashboard, when they visit the\n// instance root index, the dashboard will be served by the root controller instead\n// of a dashboard controller. The root index redirects for all other default dashboards.\n\nimport '../dashboard/projects/index';\n","import $ from 'jquery';\nimport _ from 'underscore';\nimport axios from './lib/utils/axios_utils';\n\n/**\n * Makes search request for content when user types a value in the search input.\n * Updates the html content of the page with the received one.\n */\n\nexport default class FilterableList {\n  constructor(form, filter, holder, filterInputField = 'filter_groups') {\n    this.filterForm = form;\n    this.listFilterElement = filter;\n    this.listHolderElement = holder;\n    this.filterInputField = filterInputField;\n    this.isBusy = false;\n  }\n\n  getFilterEndpoint() {\n    return `${this.filterForm.getAttribute('action')}?${$(this.filterForm).serialize()}`;\n  }\n\n  getPagePath() {\n    return this.getFilterEndpoint();\n  }\n\n  initSearch() {\n    // Wrap to prevent passing event arguments to .filterResults;\n    this.debounceFilter = _.debounce(this.onFilterInput.bind(this), 500);\n\n    this.unbindEvents();\n    this.bindEvents();\n  }\n\n  onFilterInput() {\n    const $form = $(this.filterForm);\n    const queryData = {};\n    const filterGroupsParam = $form.find(`[name=\"${this.filterInputField}\"]`).val();\n\n    if (filterGroupsParam) {\n      queryData[this.filterInputField] = filterGroupsParam;\n    }\n\n    this.filterResults(queryData);\n\n    if (this.setDefaultFilterOption) {\n      this.setDefaultFilterOption();\n    }\n  }\n\n  bindEvents() {\n    this.listFilterElement.addEventListener('input', this.debounceFilter);\n  }\n\n  unbindEvents() {\n    this.listFilterElement.removeEventListener('input', this.debounceFilter);\n  }\n\n  filterResults(params) {\n    if (this.isBusy) {\n      return false;\n    }\n\n    $(this.listHolderElement).fadeTo(250, 0.5);\n\n    this.isBusy = true;\n\n    return axios\n      .get(this.getFilterEndpoint(), {\n        params,\n      })\n      .then(res => {\n        this.onFilterSuccess(res, params);\n        this.onFilterComplete();\n      })\n      .catch(() => this.onFilterComplete());\n  }\n\n  onFilterSuccess(response, queryData) {\n    if (response.data.html) {\n      this.listHolderElement.innerHTML = response.data.html;\n    }\n\n    // Change url so if user reload a page - search results are saved\n    const currentPath = this.getPagePath(queryData);\n\n    return window.history.replaceState(\n      {\n        page: currentPath,\n      },\n      document.title,\n      currentPath,\n    );\n  }\n\n  onFilterComplete() {\n    this.isBusy = false;\n    $(this.listHolderElement).fadeTo(250, 1);\n  }\n}\n","import FilterableList from './filterable_list';\n\n/**\n * Makes search request for projects when user types a value in the search input.\n * Updates the html content of the page with the received one.\n */\nexport default class ProjectsList {\n  constructor() {\n    const form = document.querySelector('form#project-filter-form');\n    const filter = document.querySelector('.js-projects-list-filter');\n    const holder = document.querySelector('.js-projects-list-holder');\n\n    if (form && filter && holder) {\n      const list = new FilterableList(form, filter, holder);\n      list.initSearch();\n    }\n  }\n}\n","import $ from 'jquery';\nimport Flash from './flash';\nimport { __, s__ } from './locale';\nimport { spriteIcon } from './lib/utils/common_utils';\nimport axios from './lib/utils/axios_utils';\n\nexport default class Star {\n  constructor(container = '.project-home-panel') {\n    $(`${container} .toggle-star`).on('click', function toggleStarClickCallback() {\n      const $this = $(this);\n      const $starSpan = $this.find('span');\n      const $starIcon = $this.find('svg');\n      const iconClasses = $starIcon.attr('class').split(' ');\n\n      axios\n        .post($this.data('endpoint'))\n        .then(({ data }) => {\n          const isStarred = $starSpan.hasClass('starred');\n          $this\n            .parent()\n            .find('.star-count')\n            .text(data.star_count);\n\n          if (isStarred) {\n            $starSpan.removeClass('starred').text(s__('StarProject|Star'));\n            $starIcon.remove();\n            $this.prepend(spriteIcon('star-o', iconClasses));\n          } else {\n            $starSpan.addClass('starred').text(__('Unstar'));\n            $starIcon.remove();\n            $this.prepend(spriteIcon('star', iconClasses));\n          }\n        })\n        .catch(() => Flash('Star toggle failed. Try again later.'));\n    });\n  }\n}\n","import ProjectsList from '~/projects_list';\nimport Star from '../../../star';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  new ProjectsList(); // eslint-disable-line no-new\n  new Star('.project-row'); // eslint-disable-line no-new\n});\n"],"sourceRoot":""}