{"version":3,"sources":["webpack:///./autosave.js","webpack:////home/git/gitlab/node_modules/mousetrap/plugins/pause/mousetrap-pause.js","webpack:///./diff_notes/models/note.js","webpack:///./image_diff/helpers/badge_helper.js","webpack:///./image_diff/helpers/comment_indicator_helper.js","webpack:///./image_diff/image_badge.js","webpack:///./image_diff/image_diff.js","webpack:///./lib/utils/image_utility.js","webpack:///./image_diff/view_types.js","webpack:///./image_diff/replaced_image_diff.js","webpack:///./commit/image_file.js","webpack:///./image_diff/helpers/index.js","webpack:///./image_diff/helpers/dom_helper.js","webpack:///./image_diff/helpers/utils_helper.js","webpack:///./diff_notes/models/discussion.js","webpack:///./diff_notes/stores/comments.js","webpack:///./diff_notes/services/resolve.js","webpack:///./diff_notes/mixins/discussion.js","webpack:///./diff_notes/components/comment_resolve_btn.js","webpack:///./diff_notes/components/jump_to_discussion.js","webpack:///./diff_notes/components/resolve_btn.js","webpack:///./diff_notes/components/resolve_count.js","webpack:///./diff_notes/components/resolve_discussion_btn.js","webpack:///./diff_notes/components/diff_note_avatars.js","webpack:///./diff_notes/components/new_issue_for_discussion.js","webpack:///./diff_notes/diff_notes_bundle.js","webpack:///./commit_merge_requests.js","webpack:///./pages/projects/commit/show/index.js","webpack:///./task_list.js","webpack:///./droplab/plugins/input_setter.js","webpack:///./lib/utils/sticky.js","webpack:///./files_comment_button.js","webpack:///./single_file_diff.js","webpack:///./diff.js","webpack:////home/git/gitlab/node_modules/stickyfilljs/dist/stickyfill.js","webpack:///./comment_type_toggle.js","webpack:///./notes.js","webpack:////home/git/gitlab/node_modules/deckar01-task_list/dist/task_list.js","webpack:///./behaviors/shortcuts/shortcuts_navigation.js","webpack:///./project_select_combo_button.js","webpack:///./project_select.js","webpack:///./pages/projects/project.js","webpack:///./init_changes_dropdown.js","webpack:///./init_notes.js","webpack:///./pages/projects/index.js","webpack:///./mini_pipeline_graph_dropdown.js","webpack:///./dropzone_input.js","webpack:///./gl_form.js","webpack:///./diff_notes/icons/collapse_icon.svg","webpack:///./zen_mode.js"],"names":["Autosave","field","key","_this","this","_classCallCheck","isLocalStorageAvailable","AccessorUtilities","isLocalStorageAccessSafe","join","data","restore","on","save","length","text","window","localStorage","getItem","val","trigger","event","Event","bubbles","cancelable","get","dispatchEvent","setItem","reset","removeItem","off","Mousetrap","self","_originalStopCallback","stopCallback","enabled","e","element","combo","pause","unpause","NoteModel","discussionId","noteObj","id","noteId","canResolve","resolved","resolved_by","resolvedBy","authorName","authorAvatar","noteTruncated","createImageBadge","_ref","x","y","classNames","arguments","undefined","buttonEl","document","createElement","concat","forEach","className","classList","add","setAttribute","dataset","style","left","top","addCommentIndicator","containerEl","innerHTML","gl","utils","spriteIcon","appendChild","defaultMeta","width","height","ImageBadge","options","actual","browser","imageEl","imageDiffHelper","resizeCoordinatesToImageElement","ImageDiff","el","image_diff_classCallCheck","canCreateNote","renderCommentBadge","$noteContainer","$","imageBadges","imageFrameEl","querySelector","bindEvents","imageClickedWrapper","imageClicked","bind","imageBlurredWrapper","removeCommentIndicator","addBadgeWrapper","addBadge","removeBadgeWrapper","removeBadge","renderBadgesWrapper","renderBadges","complete","naturalHeight","addEventListener","toggleCollapsed","commentIndicatorOnClick","customEvent","detail","selection","getTargetSelection","currentTarget","setPositionDataAttribute","showCommentIndicator","_toConsumableArray","querySelectorAll","renderBadge","discussionEl","index","imageBadge","generateBadgeFromDiscussionDOM","push","coordinate","addImageCommentBadge","numberBadgeOptions","Object","assign","badgeText","addImageBadge","_event$detail","addAvatarBadge","badgeNumber","updateDiscussionBadgeNumber","indexToRemove","imageBadgeEls","badge","updatedBadgeNumber","innerText","updateDiscussionAvatarBadgeNumber","splice","remove","viewTypes","TWO_UP","SWIPE","ONION_SKIN","ReplacedImageDiff","_this$imageFrameEls","_this$viewModesEls","defaultViewType","imageFrameEls","_defineProperty","viewModesEl","viewModesEls","currentView","generateImageEls","imageEls","getOwnPropertyNames","viewType","_get","_getPrototypeOf","prototype","call","changeToViewTwoUp","changeView","changeToViewSwipe","changeToViewOnionSkin","newView","validate","find","indicator","replaced_image_diff_toConsumableArray","map","setTimeout","renderNewView","removed","normalizedIndicator","image","availWidth","viewModes","ImageFile","file","image_file_classCallCheck","two-up","each","wrap","requestImageInfo","removeClass","swipe","maxHeight","maxWidth","view","_ref2","$swipeWrap","$swipeBar","$swipeFrame","wrapPadding","_slicedToArray","prepareFrames","css","parseInt","replace","initDraggable","onion-skin","dragTrackWidth","_ref4","$frame","$track","$dragger","$frameAdded","framePadding","opacity","deletedWidth","deletedHeight","initViewModes","waitForImages","initView","viewMode","hasClass","activateViewMode","filter","addClass","fadeOut","fadeIn","views","$el","padding","callback","dragging","$body","$offsetEl","parent","pageX","offset","frame","img","domImg","naturalWidth","helpers","__webpack_exports__","commentIndicatorHelper","commentIndicatorEl","willRemove","meta","stopPropagation","closest","focus","_ref3","avatarBadgeEl","position","positionObject","JSON","parse","stringify","newBadgeNumber","discussionNotesEl","formEl","isCollapsed","contains","display","imageWidth","imageHeight","widthRatio","heightRatio","Math","round","firstNoteEl","offsetX","offsetY","actualWidth","actualHeight","normalizedX","max","min","normalizedY","initImageDiff","fileEl","diff","init","DiscussionModel","notes","loading","Vue","set","delete","keys","note","discussionSelector","$discussionHeadline","discussion_headline_html","replaceWith","append","localTimeAgo","CommentsStore","state","getNote","createDiscussion","discussion","create","createNote","update","deleteNote","notesCount","unresolvedDiscussionIds","ids","isResolved","ResolveServiceClass","root","resolve_classCallCheck","noteResource","resource","discussionResource","mergeRequestId","unResolveAll","resolveAll","then","resp","json","unResolveAllNotes","resolveAllNotes","mrWidget","checkStatus","updateHeadline","catch","Flash","DiffNotesResolveServiceClass","DiscussionMixins","computed","discussionCount","discussions","resolvedDiscussionCount","resolvedCount","unresolvedDiscussionCount","unresolvedCount","CommentAndResolveBtn","extend","props","type","String","required","textareaIsEmpty","showButton","isResolvable","isDiscussionResolved","buttonText","created","mounted","$textarea","destroyed","component","JumpToDiscussion","mixins","allResolved","lastResolvedId","lastId","methods","jumpToNextUnresolvedDiscussion","discussionsSelector","discussionIdsInScope","firstUnresolvedDiscussionId","nextUnresolvedDiscussionId","activeTab","mrTabs","currentAction","hasDiscussionsToJumpTo","jumpToFirstDiscussion","discussionIdsForElements","elements","attr","toArray","i","activateTab","currentDiscussionFound","$target","is","show","prevEl","$notesHolder","prev","scrollTo","ResolveBtn","Number","Boolean","resolvedByName","watch","handler","deep","$refs","button","tooltip","container","beforeDestroy","updateTooltip","$nextTick","resolve","_this2","ResolveService","unresolve","ResolveCount","loggedOut","resolvedCountText","ResolveDiscussionBtn","toggleResolveForDiscussion","DiffNoteAvatars","components","userAvatarImage","isVisible","lineType","storeState","shownAvatars","collapseIcon","discussionClassName","notesSubset","slice","extraNotesTitle","extra","moreText","plusSign","addNoCommentClass","_this3","setDiscussionVisible","clickedAvatar","_this4","Notes","instance","onAddDiffNote","toggleDiscussionsToggleState","toggleClass","nextUntil","$notesHolders","$visibleNotesHolders","getTooltipText","template","NewIssueForDiscussion","createHeader","childElementCount","mergeRequestCount","headerText","n__","getHeaderText","class","createItem","mergeRequest","$item","$link","href","path","iid","createLink","$title","title","createTitle","fetchCommitMergeRequests","$container","axios","response","$content","mergeRequests","s__","$header","children","createContent","html","projectPath","performanceHeight","Diff","ZenMode","ShortcutsNavigation","MiniPipelineGraph","initNotes","initChangesDropdown","offsetHeight","load","commitPath","diffNoteApps","diffNotesCompileComponents","tmpApp","outerHTML","$mount","one","$destroy","$components","$this","TaskList","selector","dataType","fieldName","onSuccess","onError","errorMessages","_typeof","errors","disable","taskList","target","patchData","patch","err","InputSetter","hook","config","eventWrapper","addEvents","setInputs","list","removeEvents","removeEventListener","selectedItem","selected","Array","isArray","setInput","input","newValue","getAttribute","valueAttribute","inputAttribute","hasAttribute","tagName","value","textContent","destroy","__webpack_require__","d","stickyMonitor","polyfillSticky","stickyfilljs__WEBPACK_IMPORTED_MODULE_0__","stickyfilljs__WEBPACK_IMPORTED_MODULE_0___default","n","isSticky","scrollY","stickyTop","insertPlaceholder","floor","offsetTop","placeholder","createPlaceholder","heightBefore","parentNode","insertBefore","nextElementSibling","CSS","supports","passive","StickyFill","LINE_COLUMN_CLASSES","files_comment_button","$diffFile","userCanCreateNote","isParallelView","Cookies","hideButton","buttonParentElement","getButtonParent","validateButtonParent","hoveredElement","previousElementSibling","WRAPPER","LOADING_HTML","COLLAPSED_HTML","SingleFileDiff","toggleDiff","content","$toggleIcon","diffForPath","isOpen","collapsedContent","loadingContent","hide","after","cb","hasError","getContentHTML","syntaxHighlight","$file","FilesCommentButton","createFlash","__","isBound","diff_classCallCheck","tab","getElementById","isLocked","firstFile","first","handleClickUnfold","handleClickLineNum","handleParallelLineDown","getLocationHash","highlightSelectedLine","openAnchoredDiff","since","to","_this$lineNumbers2","lineNumbers","oldLineNumber","newLineNumber","bottom","unfold","lineNumber","prevNewLine","parents","link","params","flash","locationHash","anchoredDiff","split","diffFile","clickTarget","hash","preventDefault","history","pushState","location","line","table","lineClass","name","elm","$diffFiles","_createClass","defineProperties","descriptor","enumerable","configurable","writable","defineProperty","Constructor","protoProps","staticProps","seppuku","getComputedStyle","testNode","some","prefix","shadowRootExists","ShadowRoot","scroll","stickies","targetObj","sourceObject","hasOwnProperty","parseNumeric","parseFloat","getDocOffsetTop","node","docOffsetTop","offsetParent","Sticky","TypeError","HTMLElement","Error","sticky","_node","_stickyMode","_active","refresh","_removed","_deactivate","nodeComputedStyle","nodeComputedProps","marginTop","marginBottom","marginLeft","marginRight","cssFloat","isNaN","referenceNode","host","nodeWinOffset","getBoundingClientRect","parentWinOffset","parentComputedStyle","_parent","styles","_offsetToWindow","right","documentElement","clientWidth","_offsetToParent","borderTopWidth","borderLeftWidth","borderRightWidth","_styles","nodeTopValue","_limits","start","pageYOffset","end","borderBottomWidth","parentPosition","_recalcPosition","clone","_clone","border","borderSpacing","fontSize","stickyMode","abs","removeChild","Stickyfill","addOne","nodeList","addedStickies","_loop","refreshAll","removeOne","_loop2","removeAll","checkScroll","pageXOffset","fastCheckTimer","startFastCheckTimer","setInterval","_fastCheck","docHiddenKey","visibilityChangeEventName","clearInterval","module","exports","ISetter","CommentTypeToggle","opts","dropdownTrigger","dropdownList","noteTypeInput","submitButton","closeButton","reopenButton","droplab","DropLab","setConfig","normalizeNewlines","str","autosize","Autosize","REGEX_QUICK_ACTIONS","notes_url","note_ids","last_fetched_at","enableGFM","defaultAutocompleteConfig","notes_classCallCheck","updateTargetButtons","updateComment","visibilityChange","cancelDiscussionForm","onAddImageDiffNote","setupDiscussionNoteForm","onReplyToDiscussionNote","removeNote","cancelEdit","updateNote","addDiscussionNote","addNoteError","addNote","resetMainTargetForm","keydownNoteText","toggleCommitList","postComment","clearFlashWrapper","clearFlash","onHashChange","updatedNotesTrackingMap","noteable_url","URL","notesCountBadge","basePollingInterval","maxPollingSteps","$wrapperEl","isInMRPage","cleanBinding","addBinding","setPollingInterval","setupMainTargetNoteForm","collapseLongCommitList","setViewType","getPagePath","insertAfter","$anchor","loadLazyDiff","showEditForm","removeAttachment","updateFormAttachment","onClickRetryLazyLoad","reenableTargetFormSubmitButton","discussionNoteForm","editNote","myLastNote","isMetaKey","which","gon","current_user_id","confirm","removeDiscussionNoteForm","removeNoteEditForm","interval","pollingInterval","hidden","getContent","refreshing","headers","X-Last-Fetched-At","renderNote","shouldReset","nthInterval","pow","initRefresh","noteEntity","votesBlock","commands_changes","checkMergeRequestStatus","eq","loadAwardsHandler","awardsHandler","addAwardToEmojiBar","emoji_award","scrollToAwards","$note","updateNoteTargetSelector","$noteToCleanHighlight","$form","$notesList","discussion_html","renderDiscussionNote","valid","isNewNote","$newNote","animateAppendNote","setupNewNote","updateNotesCount","isUpdatedNote","isEditing","initialContent","trim","currentContent","sanitizedNoteNote","isTextareaUntouched","putConflictEditWarningInPlace","$updatedNote","animateUpdateNote","commands_only","addFlash","parentTimeline","discussionContainer","form","row","diffAvatarContainer","discussion_id","discussion_line_code","on_image","prevAll","diff_discussion_html","$discussion","renderGFM","$notes","contentContainerClass","discussion_resolvable","renderDiscussionAvatar","changesDiscussionContainer","avatarHolder","click","createEvent","initEvent","formClone","setupNoteForm","initCommentTypeToggle","textarea","glForm","GLForm","formParentTimeline","$parentTimeline","isNewDiffComment","$targetNote","$noteEntityEl","revertNoteEditForm","isAllowed","isInViewport","scrollToElement","$editForm","getEditFormSelector","$currentlyEditing","checkContentToAllowEditing","putEditFormInPlace","enable","noteElId","notesTr","removeBadgeEvent","CustomEvent","replyToDiscussionNote","replyLink","cleanForm","dataHolder","diffFileData","discussionID","showReplyInput","toggleDiffNote","newForm","clickEvent","appendTo","addForm","hasNotes","replyButton","rowCssToAdd","forceShow","_ref2$showReplyInput","nextRow","next","targetRow","lineTypeSelector","notesContentSelector","notesContent","isCurrentlyShown","showNow","blurEvent","filename","closebtn","closetext","reopenbtn","reopentext","$originalContentEl","originalContent","postUrl","targetId","targetType","markdownVersion","updateCount","$retryButton","prop","renderPlaceholderComponent","url","$errorContainer","$successContainer","renderDiffContent","Promise","$element","$closestSystemCommitList","siblings","systemNotes","has","systemNote","$systemNote","headerMessage","_len","flashParams","_key","flashContainer","_construct","formData","serialize","formContent","_","escape","formAction","formContentOriginal","test","tempFormContent","executedCommands","command","RegExp","commandDescription","description","toLowerCase","uniqueId","isDiscussionNote","currentUsername","currentUserFullname","currentUserAvatar","discussionClass","$tempNote","_ref5","$submitBtn","noteUniqueId","systemNoteUniqueId","$notesContainer","$closeBtn","isMainForm","isDiscussionForm","isDiscussionResolve","_this$getFormData","getFormData","hasQuickActions","stripQuickActions","createPlaceholderNote","current_username","current_user_fullname","current_user_avatar_url","createPlaceholderSystemNote","getQuickActionDescription","AjaxCache","GfmAutoComplete","dataSources","commands","post","res","notePosition","_JSON$parse","addBadgeEvent","handleQuickActions","closestDiffFile","$editingNote","$noteBodyText","_this$getFormData2","cachedNoteBodyText","_ref6","updateNoteError","initDroplab","addTargetClass","GlSkeletonLoading","render","lines","prepend","fileHolder","noteIds","inArray","noteHtml","jQuery","factory","modules","installedModules","moduleId","l","m","c","getter","o","__esModule","object","property","p","s","NodeArray","indexOf","item","apply","eventName","initCustomEvent","el1","updateTaskList","checkbox","disabled","changeEvent","changedEvent","checkboxes","checked","defaultPrevented","updateSource","incomplete","escapePattern","incompletePattern","completePattern","itemPattern","startFencesPattern","endFencesPattern","itemsInParasPattern","source","itemIndex","clean","inCodeBlock","len","ref","results","match","fn","method","_possibleConstructorReturn","findAndFollowLink","enabledHelp","Shortcuts","ProjectSelectComboButton","select","projectSelectInput","newItemBtn","resourceType","resourceLabel","formattedText","deriveTextVariants","groupId","initLocalStorage","openDropdown","getProjectFromLocalStorage","selectProject","localStorageKey","localStorageItemType","setBtnTextFromLocalStorage","select2","selectedProjectData","projectMeta","setNewItemBtnAttributes","setProjectInLocalStorage","cachedProjectData","project","defaultTextPrefix","presetTextSuffix","projectString","projectSelect","simpleFilter","includeGroups","allProjects","orderBy","withIssuesEnabled","withMergeRequestsEnabled","withShared","includeProjectsInSubgroups","allowClear","minimumInputLength","query","finalCallback","projectsCallback","projects","groupsCallback","groups","Api","term","groupProjects","with_issues_enabled","with_merge_requests_enabled","with_shared","include_subgroups","order_by","membership","web_url","name_with_namespace","initSelection","dropdownCssClass","Project","$cloneOptions","$projectCloneField","$cloneBtnLabel","mobileCloneField","selectedCloneOption","cloneType","activeText","$label","clipboardText","initRefSwitcher","submit","projectId","cookieKey","projectSelectDropdown","changeProject","refListItem","refLink","$dropdown","glDropdown","search","selectable","filterable","filterRemote","filterByText","inputFieldName","renderRow","li","cloneNode","header","obj","toggleLabel","clicked","$visit","shouldVisit","action","divider","visitUrl","jquery__WEBPACK_IMPORTED_MODULE_0__","jquery__WEBPACK_IMPORTED_MODULE_0___default","_lib_utils_sticky__WEBPACK_IMPORTED_MODULE_1__","remoteFilter","_notes__WEBPACK_IMPORTED_MODULE_0__","dataEl","notesUrl","notesIds","now","diffView","initialize","r","_projects_gke_cluster_dropdowns__WEBPACK_IMPORTED_MODULE_0__","_persistent_user_callout__WEBPACK_IMPORTED_MODULE_1__","_project__WEBPACK_IMPORTED_MODULE_2__","_behaviors_shortcuts_shortcuts_navigation__WEBPACK_IMPORTED_MODULE_3__","page","body","callout","PersistentUserCallout","initGkeDropdowns","dropdownListSelector","getBuildsList","stageContainer","parentElement","relatedTarget","endpoint","stageEndpoint","renderBuildsList","toggleLoading","stopDropdownClickPropagation","dropdown","toggle","dropzoneInput","handlePaste","pasteText","addFileToForm","updateAttachingMessage","isImage","getFilename","uploadFile","$attachButton","$attachingFileMessage","$cancelButton","$retryLink","$uploadProgress","$uploadingErrorContainer","$uploadingErrorMessage","$uploadingProgressContainer","uploadsPath","uploads_path","maxFileSize","max_file_size","formTextarea","$mdArea","setupMarkdownPreview","$formDropzone","dropzone","dictDefaultMessage","clickable","paramName","maxFilesize","uploadMultiple","csrf","previewContainer","processing","alert","dragover","dragleave","drop","success","processingFileCount","getQueuedFiles","getUploadingFiles","shouldPad","markdown","error","errorMessage","xhr","message","responseText","isString","totaluploadprogress","totalUploadProgress","files","sending","removedfile","queuecomplete","child","Dropzone","forElement","removeAllFiles","dropzoneInstance","failedFiles","failedFile","status","ERROR","accepted","addFile","pasteEvent","originalEvent","clipboardData","items","getAsFile","caretStart","selectionStart","caretEnd","selectionEnd","textEnd","beforeSelection","substring","afterSelection","setSelectionRange","scrollHeight","getData","closeSpinner","FormData","md","$child","insertToTextArea","messageContainer","attachingMessage","filesCount","autoDiscover","GFMConfig","setupForm","clearEventListeners","autoComplete","isNewForm","disableButtonIfEmptyField","setup","addEventListeners","addMarkdownListeners","isAutosizeable","setupAutosize","setHeightData","destroyAutosize","outerHeight","removeMarkdownListeners","active_backdrop","active_textarea","enter","exit","keyCode","backdrop","removeAttr","$dropzone","zen_area"],"mappings":"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","file":"pages.projects.commit.show.299aa377.chunk.js","sourcesContent":["/* eslint-disable no-param-reassign, prefer-template, no-void, consistent-return */\n\nimport AccessorUtilities from './lib/utils/accessor';\n\nexport default class Autosave {\n  constructor(field, key) {\n    this.field = field;\n\n    this.isLocalStorageAvailable = AccessorUtilities.isLocalStorageAccessSafe();\n    if (key.join != null) {\n      key = key.join('/');\n    }\n    this.key = 'autosave/' + key;\n    this.field.data('autosave', this);\n    this.restore();\n    this.field.on('input', () => this.save());\n  }\n\n  restore() {\n    if (!this.isLocalStorageAvailable) return;\n    if (!this.field.length) return;\n\n    const text = window.localStorage.getItem(this.key);\n\n    if ((text != null ? text.length : void 0) > 0) {\n      this.field.val(text);\n    }\n\n    this.field.trigger('input');\n    // v-model does not update with jQuery trigger\n    // https://github.com/vuejs/vue/issues/2804#issuecomment-216968137\n    const event = new Event('change', { bubbles: true, cancelable: false });\n    const field = this.field.get(0);\n    if (field) {\n      field.dispatchEvent(event);\n    }\n  }\n\n  save() {\n    if (!this.field.length) return;\n\n    const text = this.field.val();\n\n    if (this.isLocalStorageAvailable && (text != null ? text.length : void 0) > 0) {\n      return window.localStorage.setItem(this.key, text);\n    }\n\n    return this.reset();\n  }\n\n  reset() {\n    if (!this.isLocalStorageAvailable) return;\n\n    return window.localStorage.removeItem(this.key);\n  }\n\n  dispose() {\n    this.field.off('input');\n  }\n}\n","/**\n * adds a pause and unpause method to Mousetrap\n * this allows you to enable or disable keyboard shortcuts\n * without having to reset Mousetrap and rebind everything\n */\n/* global Mousetrap:true */\nMousetrap = (function(Mousetrap) {\n    var self = Mousetrap,\n        _originalStopCallback = self.stopCallback,\n        enabled = true;\n\n    self.stopCallback = function(e, element, combo) {\n        if (!enabled) {\n            return true;\n        }\n\n        return _originalStopCallback(e, element, combo);\n    };\n\n    self.pause = function() {\n        enabled = false;\n    };\n\n    self.unpause = function() {\n        enabled = true;\n    };\n\n    return self;\n}) (Mousetrap);\n","class NoteModel {\n  constructor(discussionId, noteObj) {\n    this.discussionId = discussionId;\n    this.id = noteObj.noteId;\n    this.canResolve = noteObj.canResolve;\n    this.resolved = noteObj.resolved;\n    this.resolved_by = noteObj.resolvedBy;\n    this.authorName = noteObj.authorName;\n    this.authorAvatar = noteObj.authorAvatar;\n    this.noteTruncated = noteObj.noteTruncated;\n  }\n}\n\nwindow.NoteModel = NoteModel;\n","export function createImageBadge(noteId, { x, y }, classNames = []) {\n  const buttonEl = document.createElement('button');\n  const classList = classNames.concat(['js-image-badge']);\n  classList.forEach(className => buttonEl.classList.add(className));\n  buttonEl.setAttribute('type', 'button');\n  buttonEl.setAttribute('disabled', true);\n  buttonEl.dataset.noteId = noteId;\n  buttonEl.style.left = `${x}px`;\n  buttonEl.style.top = `${y}px`;\n\n  return buttonEl;\n}\n\nexport function addImageBadge(containerEl, { coordinate, badgeText, noteId }) {\n  const buttonEl = createImageBadge(noteId, coordinate, ['badge', 'badge-pill']);\n  buttonEl.innerText = badgeText;\n\n  containerEl.appendChild(buttonEl);\n}\n\nexport function addImageCommentBadge(containerEl, { coordinate, noteId }) {\n  const buttonEl = createImageBadge(noteId, coordinate, ['image-comment-badge']);\n  buttonEl.innerHTML = gl.utils.spriteIcon('image-comment-dark');\n\n  containerEl.appendChild(buttonEl);\n}\n\nexport function addAvatarBadge(el, event) {\n  const { noteId, badgeNumber } = event.detail;\n\n  // Add badge to new comment\n  const avatarBadgeEl = el.querySelector(`#${noteId} .badge`);\n  avatarBadgeEl.innerText = badgeNumber;\n  avatarBadgeEl.classList.remove('hidden');\n}\n","export function addCommentIndicator(containerEl, { x, y }) {\n  const buttonEl = document.createElement('button');\n  buttonEl.classList.add('btn-transparent');\n  buttonEl.classList.add('comment-indicator');\n  buttonEl.setAttribute('type', 'button');\n  buttonEl.style.left = `${x}px`;\n  buttonEl.style.top = `${y}px`;\n\n  buttonEl.innerHTML = gl.utils.spriteIcon('image-comment-dark');\n\n  containerEl.appendChild(buttonEl);\n}\n\nexport function removeCommentIndicator(imageFrameEl) {\n  const commentIndicatorEl = imageFrameEl.querySelector('.comment-indicator');\n  const imageEl = imageFrameEl.querySelector('img');\n  const willRemove = !!commentIndicatorEl;\n  let meta = {};\n\n  if (willRemove) {\n    meta = {\n      x: parseInt(commentIndicatorEl.style.left, 10),\n      y: parseInt(commentIndicatorEl.style.top, 10),\n      image: {\n        width: imageEl.width,\n        height: imageEl.height,\n      },\n    };\n\n    commentIndicatorEl.remove();\n  }\n\n  return Object.assign({}, meta, {\n    removed: willRemove,\n  });\n}\n\nexport function showCommentIndicator(imageFrameEl, coordinate) {\n  const { x, y } = coordinate;\n  const commentIndicatorEl = imageFrameEl.querySelector('.comment-indicator');\n\n  if (commentIndicatorEl) {\n    commentIndicatorEl.style.left = `${x}px`;\n    commentIndicatorEl.style.top = `${y}px`;\n  } else {\n    addCommentIndicator(imageFrameEl, coordinate);\n  }\n}\n\nexport function commentIndicatorOnClick(event) {\n  // Prevent from triggering onAddImageDiffNote in notes.js\n  event.stopPropagation();\n\n  const buttonEl = event.currentTarget;\n  const diffViewerEl = buttonEl.closest('.diff-viewer');\n  const textareaEl = diffViewerEl.querySelector('.note-container .note-textarea');\n  textareaEl.focus();\n}\n","import imageDiffHelper from './helpers/index';\n\nconst defaultMeta = {\n  x: 0,\n  y: 0,\n  width: 0,\n  height: 0,\n};\n\nexport default class ImageBadge {\n  constructor(options) {\n    const { noteId, discussionId } = options;\n\n    this.actual = options.actual || defaultMeta;\n    this.browser = options.browser || defaultMeta;\n    this.noteId = noteId;\n    this.discussionId = discussionId;\n\n    if (options.imageEl && !options.browser) {\n      this.browser = imageDiffHelper.resizeCoordinatesToImageElement(options.imageEl, this.actual);\n    }\n  }\n}\n","import $ from 'jquery';\nimport imageDiffHelper from './helpers/index';\nimport ImageBadge from './image_badge';\nimport { isImageLoaded } from '../lib/utils/image_utility';\n\nexport default class ImageDiff {\n  constructor(el, options) {\n    this.el = el;\n    this.canCreateNote = !!(options && options.canCreateNote);\n    this.renderCommentBadge = !!(options && options.renderCommentBadge);\n    this.$noteContainer = $('.note-container', this.el);\n    this.imageBadges = [];\n  }\n\n  init() {\n    this.imageFrameEl = this.el.querySelector('.diff-file .js-image-frame');\n    this.imageEl = this.imageFrameEl.querySelector('img');\n\n    this.bindEvents();\n  }\n\n  bindEvents() {\n    this.imageClickedWrapper = this.imageClicked.bind(this);\n    this.imageBlurredWrapper = imageDiffHelper.removeCommentIndicator.bind(null, this.imageFrameEl);\n    this.addBadgeWrapper = this.addBadge.bind(this);\n    this.removeBadgeWrapper = this.removeBadge.bind(this);\n    this.renderBadgesWrapper = this.renderBadges.bind(this);\n\n    // Render badges\n    if (isImageLoaded(this.imageEl)) {\n      this.renderBadges();\n    } else {\n      this.imageEl.addEventListener('load', this.renderBadgesWrapper);\n    }\n\n    // jquery makes the event delegation here much simpler\n    this.$noteContainer.on('click', '.js-diff-notes-toggle', imageDiffHelper.toggleCollapsed);\n    $(this.el).on('click', '.comment-indicator', imageDiffHelper.commentIndicatorOnClick);\n\n    if (this.canCreateNote) {\n      this.el.addEventListener('click.imageDiff', this.imageClickedWrapper);\n      this.el.addEventListener('blur.imageDiff', this.imageBlurredWrapper);\n      this.el.addEventListener('addBadge.imageDiff', this.addBadgeWrapper);\n      this.el.addEventListener('removeBadge.imageDiff', this.removeBadgeWrapper);\n    }\n  }\n\n  imageClicked(event) {\n    const customEvent = event.detail;\n    const selection = imageDiffHelper.getTargetSelection(customEvent);\n    const el = customEvent.currentTarget;\n\n    imageDiffHelper.setPositionDataAttribute(el, selection.actual);\n    imageDiffHelper.showCommentIndicator(this.imageFrameEl, selection.browser);\n  }\n\n  renderBadges() {\n    const discussionsEls = this.el.querySelectorAll('.note-container .discussion-notes .notes');\n    [...discussionsEls].forEach(this.renderBadge.bind(this));\n  }\n\n  renderBadge(discussionEl, index) {\n    const imageBadge = imageDiffHelper.generateBadgeFromDiscussionDOM(\n      this.imageFrameEl,\n      discussionEl,\n    );\n\n    this.imageBadges.push(imageBadge);\n\n    const options = {\n      coordinate: imageBadge.browser,\n      noteId: imageBadge.noteId,\n    };\n\n    if (this.renderCommentBadge) {\n      imageDiffHelper.addImageCommentBadge(this.imageFrameEl, options);\n    } else {\n      const numberBadgeOptions = Object.assign({}, options, {\n        badgeText: index + 1,\n      });\n\n      imageDiffHelper.addImageBadge(this.imageFrameEl, numberBadgeOptions);\n    }\n  }\n\n  addBadge(event) {\n    const { x, y, width, height, noteId, discussionId } = event.detail;\n    const badgeText = this.imageBadges.length + 1;\n    const imageBadge = new ImageBadge({\n      actual: {\n        x,\n        y,\n        width,\n        height,\n      },\n      imageEl: this.imageFrameEl.querySelector('img'),\n      noteId,\n      discussionId,\n    });\n\n    this.imageBadges.push(imageBadge);\n\n    imageDiffHelper.addImageBadge(this.imageFrameEl, {\n      coordinate: imageBadge.browser,\n      badgeText,\n      noteId,\n    });\n\n    imageDiffHelper.addAvatarBadge(this.el, {\n      detail: {\n        noteId,\n        badgeNumber: badgeText,\n      },\n    });\n\n    const discussionEl = this.el.querySelector(`#discussion_${discussionId}`);\n    imageDiffHelper.updateDiscussionBadgeNumber(discussionEl, badgeText);\n  }\n\n  removeBadge(event) {\n    const { badgeNumber } = event.detail;\n    const indexToRemove = badgeNumber - 1;\n    const imageBadgeEls = this.imageFrameEl.querySelectorAll('.badge');\n\n    if (this.imageBadges.length !== badgeNumber) {\n      // Cascade badges count numbers for (avatar badges + image badges)\n      this.imageBadges.forEach((badge, index) => {\n        if (index > indexToRemove) {\n          const { discussionId } = badge;\n          const updatedBadgeNumber = index;\n          const discussionEl = this.el.querySelector(`#discussion_${discussionId}`);\n\n          imageBadgeEls[index].innerText = updatedBadgeNumber;\n\n          imageDiffHelper.updateDiscussionBadgeNumber(discussionEl, updatedBadgeNumber);\n          imageDiffHelper.updateDiscussionAvatarBadgeNumber(discussionEl, updatedBadgeNumber);\n        }\n      });\n    }\n\n    this.imageBadges.splice(indexToRemove, 1);\n\n    const imageBadgeEl = imageBadgeEls[indexToRemove];\n    imageBadgeEl.remove();\n  }\n}\n","/* eslint-disable import/prefer-default-export */\n\nexport function isImageLoaded(element) {\n  return element.complete && element.naturalHeight !== 0;\n}\n","export const viewTypes = {\n  TWO_UP: 'TWO_UP',\n  SWIPE: 'SWIPE',\n  ONION_SKIN: 'ONION_SKIN',\n};\n\nexport function isValidViewType(validate) {\n  return !!Object.getOwnPropertyNames(viewTypes).find(viewType => viewType === validate);\n}\n","import imageDiffHelper from './helpers/index';\nimport { viewTypes, isValidViewType } from './view_types';\nimport ImageDiff from './image_diff';\n\nexport default class ReplacedImageDiff extends ImageDiff {\n  init(defaultViewType = viewTypes.TWO_UP) {\n    this.imageFrameEls = {\n      [viewTypes.TWO_UP]: this.el.querySelector('.two-up .js-image-frame'),\n      [viewTypes.SWIPE]: this.el.querySelector('.swipe .js-image-frame'),\n      [viewTypes.ONION_SKIN]: this.el.querySelector('.onion-skin .js-image-frame'),\n    };\n\n    const viewModesEl = this.el.querySelector('.view-modes-menu');\n    this.viewModesEls = {\n      [viewTypes.TWO_UP]: viewModesEl.querySelector('.two-up'),\n      [viewTypes.SWIPE]: viewModesEl.querySelector('.swipe'),\n      [viewTypes.ONION_SKIN]: viewModesEl.querySelector('.onion-skin'),\n    };\n\n    this.currentView = defaultViewType;\n    this.generateImageEls();\n    this.bindEvents();\n  }\n\n  generateImageEls() {\n    this.imageEls = {};\n\n    const viewTypeNames = Object.getOwnPropertyNames(viewTypes);\n    viewTypeNames.forEach(viewType => {\n      this.imageEls[viewType] = this.imageFrameEls[viewType].querySelector('img');\n    });\n  }\n\n  bindEvents() {\n    super.bindEvents();\n\n    this.changeToViewTwoUp = this.changeView.bind(this, viewTypes.TWO_UP);\n    this.changeToViewSwipe = this.changeView.bind(this, viewTypes.SWIPE);\n    this.changeToViewOnionSkin = this.changeView.bind(this, viewTypes.ONION_SKIN);\n\n    this.viewModesEls[viewTypes.TWO_UP].addEventListener('click', this.changeToViewTwoUp);\n    this.viewModesEls[viewTypes.SWIPE].addEventListener('click', this.changeToViewSwipe);\n    this.viewModesEls[viewTypes.ONION_SKIN].addEventListener('click', this.changeToViewOnionSkin);\n  }\n\n  get imageEl() {\n    return this.imageEls[this.currentView];\n  }\n\n  get imageFrameEl() {\n    return this.imageFrameEls[this.currentView];\n  }\n\n  changeView(newView) {\n    if (!isValidViewType(newView)) {\n      return;\n    }\n\n    const indicator = imageDiffHelper.removeCommentIndicator(this.imageFrameEl);\n\n    this.currentView = newView;\n\n    // Clear existing badges on new view\n    const existingBadges = this.imageFrameEl.querySelectorAll('.badge');\n    [...existingBadges].map(badge => badge.remove());\n\n    // Remove existing references to old view image badges\n    this.imageBadges = [];\n\n    // Image_file.js has a fade animation of 200ms for loading the view\n    // Need to wait an additional 250ms for the images to be displayed\n    // on window in order to re-normalize their dimensions\n    setTimeout(this.renderNewView.bind(this, indicator), 250);\n  }\n\n  renderNewView(indicator) {\n    // Generate badge coordinates on new view\n    this.renderBadges();\n\n    // Re-render indicator in new view\n    if (indicator.removed) {\n      const normalizedIndicator = imageDiffHelper.resizeCoordinatesToImageElement(this.imageEl, {\n        x: indicator.x,\n        y: indicator.y,\n        width: indicator.image.width,\n        height: indicator.image.height,\n      });\n      imageDiffHelper.showCommentIndicator(this.imageFrameEl, normalizedIndicator);\n    }\n  }\n}\n","/* eslint-disable func-names, no-var, prefer-arrow-callback, no-else-return, consistent-return, prefer-template, one-var, no-unused-vars, no-return-assign, no-unused-expressions, no-sequences */\n\nimport $ from 'jquery';\n\n// Width where images must fits in, for 2-up this gets divided by 2\nconst availWidth = 900;\nconst viewModes = ['two-up', 'swipe'];\n\nexport default class ImageFile {\n  constructor(file) {\n    this.file = file;\n    this.requestImageInfo(\n      $('.two-up.view .frame.deleted img', this.file),\n      (function(_this) {\n        return function(deletedWidth, deletedHeight) {\n          return _this.requestImageInfo($('.two-up.view .frame.added img', _this.file), function(\n            width,\n            height,\n          ) {\n            _this.initViewModes();\n\n            // Load two-up view after images are loaded\n            // so that we can display the correct width and height information\n            const $images = $('.two-up.view img', _this.file);\n\n            $images.waitForImages(function() {\n              _this.initView('two-up');\n            });\n          });\n        };\n      })(this),\n    );\n  }\n\n  initViewModes() {\n    const viewMode = viewModes[0];\n    $('.view-modes', this.file).removeClass('hide');\n    $('.view-modes-menu', this.file).on(\n      'click',\n      'li',\n      (function(_this) {\n        return function(event) {\n          if (!$(event.currentTarget).hasClass('active')) {\n            return _this.activateViewMode(event.currentTarget.className);\n          }\n        };\n      })(this),\n    );\n    return this.activateViewMode(viewMode);\n  }\n\n  activateViewMode(viewMode) {\n    $('.view-modes-menu li', this.file)\n      .removeClass('active')\n      .filter('.' + viewMode)\n      .addClass('active');\n    return $('.view:visible:not(.' + viewMode + ')', this.file).fadeOut(\n      200,\n      (function(_this) {\n        return function() {\n          $('.view.' + viewMode, _this.file).fadeIn(200);\n          return _this.initView(viewMode);\n        };\n      })(this),\n    );\n  }\n\n  initView(viewMode) {\n    return this.views[viewMode].call(this);\n  }\n  // eslint-disable-next-line class-methods-use-this\n  initDraggable($el, padding, callback) {\n    var dragging = false;\n    var $body = $('body');\n    var $offsetEl = $el.parent();\n\n    $el.off('mousedown').on('mousedown', function() {\n      dragging = true;\n      $body.css('user-select', 'none');\n    });\n\n    $body\n      .off('mouseup')\n      .off('mousemove')\n      .on('mouseup', function() {\n        dragging = false;\n        $body.css('user-select', '');\n      })\n      .on('mousemove', function(e) {\n        var left;\n        if (!dragging) return;\n\n        left = e.pageX - ($offsetEl.offset().left + padding);\n\n        callback(e, left);\n      });\n  }\n\n  prepareFrames(view) {\n    var maxHeight, maxWidth;\n    maxWidth = 0;\n    maxHeight = 0;\n    $('.frame', view)\n      .each(\n        (function(_this) {\n          return function(index, frame) {\n            var height, width;\n            width = $(frame).width();\n            height = $(frame).height();\n            maxWidth = width > maxWidth ? width : maxWidth;\n            return (maxHeight = height > maxHeight ? height : maxHeight);\n          };\n        })(this),\n      )\n      .css({\n        width: maxWidth,\n        height: maxHeight,\n      });\n    return [maxWidth, maxHeight];\n  }\n\n  views = {\n    'two-up': function() {\n      return $('.two-up.view .wrap', this.file).each(\n        (function(_this) {\n          return function(index, wrap) {\n            $('img', wrap).each(function() {\n              var currentWidth;\n              currentWidth = $(this).width();\n              if (currentWidth > availWidth / 2) {\n                return $(this).width(availWidth / 2);\n              }\n            });\n            return _this.requestImageInfo($('img', wrap), function(width, height) {\n              $('.image-info .meta-width', wrap).text(width + 'px');\n              $('.image-info .meta-height', wrap).text(height + 'px');\n              return $('.image-info', wrap).removeClass('hide');\n            });\n          };\n        })(this),\n      );\n    },\n    swipe() {\n      var maxHeight, maxWidth;\n      maxWidth = 0;\n      maxHeight = 0;\n      return $('.swipe.view', this.file).each(\n        (function(_this) {\n          return function(index, view) {\n            var $swipeWrap, $swipeBar, $swipeFrame, wrapPadding, ref;\n            (ref = _this.prepareFrames(view)), ([maxWidth, maxHeight] = ref);\n            $swipeFrame = $('.swipe-frame', view);\n            $swipeWrap = $('.swipe-wrap', view);\n            $swipeBar = $('.swipe-bar', view);\n\n            $swipeFrame.css({\n              width: maxWidth + 16,\n              height: maxHeight + 28,\n            });\n            $swipeWrap.css({\n              width: maxWidth + 1,\n              height: maxHeight + 2,\n            });\n            // Set swipeBar left position to match image frame\n            $swipeBar.css({\n              left: 1,\n            });\n\n            wrapPadding = parseInt($swipeWrap.css('right').replace('px', ''), 10);\n\n            _this.initDraggable($swipeBar, wrapPadding, function(e, left) {\n              if (left > 0 && left < $swipeFrame.width() - wrapPadding * 2) {\n                $swipeWrap.width(maxWidth + 1 - left);\n                $swipeBar.css('left', left);\n              }\n            });\n          };\n        })(this),\n      );\n    },\n    'onion-skin': function() {\n      var dragTrackWidth, maxHeight, maxWidth;\n      maxWidth = 0;\n      maxHeight = 0;\n      dragTrackWidth = $('.drag-track', this.file).width() - $('.dragger', this.file).width();\n      return $('.onion-skin.view', this.file).each(\n        (function(_this) {\n          return function(index, view) {\n            var $frame,\n              $track,\n              $dragger,\n              $frameAdded,\n              framePadding,\n              ref,\n              dragging = false;\n            (ref = _this.prepareFrames(view)), ([maxWidth, maxHeight] = ref);\n            $frame = $('.onion-skin-frame', view);\n            $frameAdded = $('.frame.added', view);\n            $track = $('.drag-track', view);\n            $dragger = $('.dragger', $track);\n\n            $frame.css({\n              width: maxWidth + 16,\n              height: maxHeight + 28,\n            });\n            $('.swipe-wrap', view).css({\n              width: maxWidth + 1,\n              height: maxHeight + 2,\n            });\n            $dragger.css({\n              left: dragTrackWidth,\n            });\n\n            $frameAdded.css('opacity', 1);\n            framePadding = parseInt($frameAdded.css('right').replace('px', ''), 10);\n\n            _this.initDraggable($dragger, framePadding, function(e, left) {\n              var opacity = left / dragTrackWidth;\n\n              if (opacity >= 0 && opacity <= 1) {\n                $dragger.css('left', left);\n                $frameAdded.css('opacity', opacity);\n              }\n            });\n          };\n        })(this),\n      );\n    },\n  };\n\n  requestImageInfo(img, callback) {\n    const domImg = img.get(0);\n    if (domImg) {\n      if (domImg.complete) {\n        return callback.call(this, domImg.naturalWidth, domImg.naturalHeight);\n      } else {\n        return img.on(\n          'load',\n          (function(_this) {\n            return function() {\n              return callback.call(_this, domImg.naturalWidth, domImg.naturalHeight);\n            };\n          })(this),\n        );\n      }\n    }\n  }\n}\n","import * as badgeHelper from './badge_helper';\nimport * as commentIndicatorHelper from './comment_indicator_helper';\nimport * as domHelper from './dom_helper';\nimport * as utilsHelper from './utils_helper';\n\nexport default {\n  addCommentIndicator: commentIndicatorHelper.addCommentIndicator,\n  removeCommentIndicator: commentIndicatorHelper.removeCommentIndicator,\n  showCommentIndicator: commentIndicatorHelper.showCommentIndicator,\n  commentIndicatorOnClick: commentIndicatorHelper.commentIndicatorOnClick,\n\n  addImageBadge: badgeHelper.addImageBadge,\n  addImageCommentBadge: badgeHelper.addImageCommentBadge,\n  addAvatarBadge: badgeHelper.addAvatarBadge,\n\n  setPositionDataAttribute: domHelper.setPositionDataAttribute,\n  updateDiscussionAvatarBadgeNumber: domHelper.updateDiscussionAvatarBadgeNumber,\n  updateDiscussionBadgeNumber: domHelper.updateDiscussionBadgeNumber,\n  toggleCollapsed: domHelper.toggleCollapsed,\n\n  resizeCoordinatesToImageElement: utilsHelper.resizeCoordinatesToImageElement,\n  generateBadgeFromDiscussionDOM: utilsHelper.generateBadgeFromDiscussionDOM,\n  getTargetSelection: utilsHelper.getTargetSelection,\n  initImageDiff: utilsHelper.initImageDiff,\n};\n","export function setPositionDataAttribute(el, options) {\n  // Update position data attribute so that the\n  // new comment form can use this data for ajax request\n  const { x, y, width, height } = options;\n  const { position } = el.dataset;\n\n  const positionObject = Object.assign({}, JSON.parse(position), {\n    x,\n    y,\n    width,\n    height,\n  });\n\n  el.setAttribute('data-position', JSON.stringify(positionObject));\n}\n\nexport function updateDiscussionAvatarBadgeNumber(discussionEl, newBadgeNumber) {\n  const avatarBadgeEl = discussionEl.querySelector('.image-diff-avatar-link .badge');\n  avatarBadgeEl.innerText = newBadgeNumber;\n}\n\nexport function updateDiscussionBadgeNumber(discussionEl, newBadgeNumber) {\n  const discussionBadgeEl = discussionEl.querySelector('.badge');\n  discussionBadgeEl.innerText = newBadgeNumber;\n}\n\nexport function toggleCollapsed(event) {\n  const toggleButtonEl = event.currentTarget;\n  const discussionNotesEl = toggleButtonEl.closest('.discussion-notes');\n  const formEl = discussionNotesEl.querySelector('.discussion-form');\n  const isCollapsed = discussionNotesEl.classList.contains('collapsed');\n\n  if (isCollapsed) {\n    discussionNotesEl.classList.remove('collapsed');\n  } else {\n    discussionNotesEl.classList.add('collapsed');\n  }\n\n  // Override the inline display style set in notes.js\n  if (formEl && !isCollapsed) {\n    formEl.style.display = 'none';\n  } else if (formEl && isCollapsed) {\n    formEl.style.display = 'block';\n  }\n}\n","import ImageBadge from '../image_badge';\nimport ImageDiff from '../image_diff';\nimport ReplacedImageDiff from '../replaced_image_diff';\nimport ImageFile from '../../commit/image_file';\n\nexport function resizeCoordinatesToImageElement(imageEl, meta) {\n  const { x, y, width, height } = meta;\n\n  const imageWidth = imageEl.width;\n  const imageHeight = imageEl.height;\n\n  const widthRatio = imageWidth / width;\n  const heightRatio = imageHeight / height;\n\n  return {\n    x: Math.round(x * widthRatio),\n    y: Math.round(y * heightRatio),\n    width: imageWidth,\n    height: imageHeight,\n  };\n}\n\nexport function generateBadgeFromDiscussionDOM(imageFrameEl, discussionEl) {\n  const position = JSON.parse(discussionEl.dataset.position);\n  const firstNoteEl = discussionEl.querySelector('.note');\n  const badge = new ImageBadge({\n    actual: position,\n    imageEl: imageFrameEl.querySelector('img'),\n    noteId: firstNoteEl.id,\n    discussionId: discussionEl.dataset.discussionId,\n  });\n\n  return badge;\n}\n\nexport function getTargetSelection(event) {\n  const containerEl = event.currentTarget;\n  const imageEl = containerEl.querySelector('img');\n\n  const x = event.offsetX;\n  const y = event.offsetY;\n\n  const { width, height } = imageEl;\n\n  const actualWidth = imageEl.naturalWidth;\n  const actualHeight = imageEl.naturalHeight;\n\n  const widthRatio = actualWidth / width;\n  const heightRatio = actualHeight / height;\n\n  // Browser will include the frame as a clickable target,\n  // which would result in potential 1px out of bounds value\n  // This bound the coordinates to inside the frame\n  const normalizedX = Math.max(0, x) && Math.min(x, width);\n  const normalizedY = Math.max(0, y) && Math.min(y, height);\n\n  return {\n    browser: {\n      x: normalizedX,\n      y: normalizedY,\n      width,\n      height,\n    },\n    actual: {\n      // Round x, y so that we don't need to deal with decimals\n      x: Math.round(normalizedX * widthRatio),\n      y: Math.round(normalizedY * heightRatio),\n      width: actualWidth,\n      height: actualHeight,\n    },\n  };\n}\n\nexport function initImageDiff(fileEl, canCreateNote, renderCommentBadge) {\n  const options = {\n    canCreateNote,\n    renderCommentBadge,\n  };\n  let diff;\n\n  // ImageFile needs to be invoked before initImageDiff so that badges\n  // can mount to the correct location\n  new ImageFile(fileEl); // eslint-disable-line no-new\n\n  if (fileEl.querySelector('.diff-file .js-single-image')) {\n    diff = new ImageDiff(fileEl, options);\n    diff.init();\n  } else if (fileEl.querySelector('.diff-file .js-replaced-image')) {\n    diff = new ReplacedImageDiff(fileEl, options);\n    diff.init();\n  }\n\n  return diff;\n}\n","/* eslint-disable camelcase, guard-for-in, no-restricted-syntax */\n/* global NoteModel */\n\nimport $ from 'jquery';\nimport Vue from 'vue';\nimport { localTimeAgo } from '../../lib/utils/datetime_utility';\n\nclass DiscussionModel {\n  constructor(discussionId) {\n    this.id = discussionId;\n    this.notes = {};\n    this.loading = false;\n    this.canResolve = false;\n  }\n\n  createNote(noteObj) {\n    Vue.set(this.notes, noteObj.noteId, new NoteModel(this.id, noteObj));\n  }\n\n  deleteNote(noteId) {\n    Vue.delete(this.notes, noteId);\n  }\n\n  getNote(noteId) {\n    return this.notes[noteId];\n  }\n\n  notesCount() {\n    return Object.keys(this.notes).length;\n  }\n\n  isResolved() {\n    for (const noteId in this.notes) {\n      const note = this.notes[noteId];\n\n      if (!note.resolved) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  resolveAllNotes(resolved_by) {\n    for (const noteId in this.notes) {\n      const note = this.notes[noteId];\n\n      if (!note.resolved) {\n        note.resolved = true;\n        note.resolved_by = resolved_by;\n      }\n    }\n  }\n\n  unResolveAllNotes() {\n    for (const noteId in this.notes) {\n      const note = this.notes[noteId];\n\n      if (note.resolved) {\n        note.resolved = false;\n        note.resolved_by = null;\n      }\n    }\n  }\n\n  updateHeadline(data) {\n    const discussionSelector = `.discussion[data-discussion-id=\"${this.id}\"]`;\n    const $discussionHeadline = $(`${discussionSelector} .js-discussion-headline`);\n\n    if (data.discussion_headline_html) {\n      if ($discussionHeadline.length) {\n        $discussionHeadline.replaceWith(data.discussion_headline_html);\n      } else {\n        $(`${discussionSelector} .discussion-header`).append(data.discussion_headline_html);\n      }\n\n      localTimeAgo($('.js-timeago', `${discussionSelector}`));\n    } else {\n      $discussionHeadline.remove();\n    }\n  }\n\n  isResolvable() {\n    if (!this.canResolve) {\n      return false;\n    }\n\n    for (const noteId in this.notes) {\n      const note = this.notes[noteId];\n\n      if (note.canResolve) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n}\n\nwindow.DiscussionModel = DiscussionModel;\n","/* eslint-disable object-shorthand, func-names, camelcase, no-restricted-syntax, guard-for-in */\n/* global DiscussionModel */\n\nimport Vue from 'vue';\n\nwindow.CommentsStore = {\n  state: {},\n  get: function(discussionId, noteId) {\n    return this.state[discussionId].getNote(noteId);\n  },\n  createDiscussion: function(discussionId, canResolve) {\n    let discussion = this.state[discussionId];\n    if (!this.state[discussionId]) {\n      discussion = new DiscussionModel(discussionId);\n      Vue.set(this.state, discussionId, discussion);\n    }\n\n    if (canResolve !== undefined) {\n      discussion.canResolve = canResolve;\n    }\n\n    return discussion;\n  },\n  create: function(noteObj) {\n    const discussion = this.createDiscussion(noteObj.discussionId);\n\n    discussion.createNote(noteObj);\n  },\n  update: function(discussionId, noteId, resolved, resolved_by) {\n    const discussion = this.state[discussionId];\n    const note = discussion.getNote(noteId);\n    note.resolved = resolved;\n    note.resolved_by = resolved_by;\n  },\n  delete: function(discussionId, noteId) {\n    const discussion = this.state[discussionId];\n    discussion.deleteNote(noteId);\n\n    if (discussion.notesCount() === 0) {\n      Vue.delete(this.state, discussionId);\n    }\n  },\n  unresolvedDiscussionIds: function() {\n    const ids = [];\n\n    for (const discussionId in this.state) {\n      const discussion = this.state[discussionId];\n\n      if (!discussion.isResolved()) {\n        ids.push(discussion.id);\n      }\n    }\n\n    return ids;\n  },\n};\n","/* global CommentsStore */\n\nimport Vue from 'vue';\nimport Flash from '../../flash';\nimport '../../vue_shared/vue_resource_interceptor';\n\nwindow.gl = window.gl || {};\n\nclass ResolveServiceClass {\n  constructor(root) {\n    this.noteResource = Vue.resource(`${root}/notes{/noteId}/resolve?html=true`);\n    this.discussionResource = Vue.resource(\n      `${root}/merge_requests{/mergeRequestId}/discussions{/discussionId}/resolve?html=true`,\n    );\n  }\n\n  resolve(noteId) {\n    return this.noteResource.save({ noteId }, {});\n  }\n\n  unresolve(noteId) {\n    return this.noteResource.delete({ noteId }, {});\n  }\n\n  toggleResolveForDiscussion(mergeRequestId, discussionId) {\n    const discussion = CommentsStore.state[discussionId];\n    const isResolved = discussion.isResolved();\n    let promise;\n\n    if (isResolved) {\n      promise = this.unResolveAll(mergeRequestId, discussionId);\n    } else {\n      promise = this.resolveAll(mergeRequestId, discussionId);\n    }\n\n    promise\n      .then(resp => resp.json())\n      .then(data => {\n        discussion.loading = false;\n        const resolvedBy = data ? data.resolved_by : null;\n\n        if (isResolved) {\n          discussion.unResolveAllNotes();\n        } else {\n          discussion.resolveAllNotes(resolvedBy);\n        }\n\n        if (gl.mrWidget) gl.mrWidget.checkStatus();\n        discussion.updateHeadline(data);\n      })\n      .catch(\n        () => new Flash('An error occurred when trying to resolve a discussion. Please try again.'),\n      );\n  }\n\n  resolveAll(mergeRequestId, discussionId) {\n    const discussion = CommentsStore.state[discussionId];\n\n    discussion.loading = true;\n\n    return this.discussionResource.save(\n      {\n        mergeRequestId,\n        discussionId,\n      },\n      {},\n    );\n  }\n\n  unResolveAll(mergeRequestId, discussionId) {\n    const discussion = CommentsStore.state[discussionId];\n\n    discussion.loading = true;\n\n    return this.discussionResource.delete(\n      {\n        mergeRequestId,\n        discussionId,\n      },\n      {},\n    );\n  }\n}\n\ngl.DiffNotesResolveServiceClass = ResolveServiceClass;\n","/* eslint-disable object-shorthand, func-names, guard-for-in, no-restricted-syntax, */\n\nconst DiscussionMixins = {\n  computed: {\n    discussionCount: function() {\n      return Object.keys(this.discussions).length;\n    },\n    resolvedDiscussionCount: function() {\n      let resolvedCount = 0;\n\n      for (const discussionId in this.discussions) {\n        const discussion = this.discussions[discussionId];\n\n        if (discussion.isResolved()) {\n          resolvedCount += 1;\n        }\n      }\n\n      return resolvedCount;\n    },\n    unresolvedDiscussionCount: function() {\n      let unresolvedCount = 0;\n\n      for (const discussionId in this.discussions) {\n        const discussion = this.discussions[discussionId];\n\n        if (!discussion.isResolved()) {\n          unresolvedCount += 1;\n        }\n      }\n\n      return unresolvedCount;\n    },\n  },\n};\n\nexport default DiscussionMixins;\n","/* eslint-disable object-shorthand, func-names, no-else-return, no-lonely-if */\n/* global CommentsStore */\n\nimport $ from 'jquery';\nimport Vue from 'vue';\n\nconst CommentAndResolveBtn = Vue.extend({\n  props: {\n    discussionId: {\n      type: String,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      textareaIsEmpty: true,\n      discussion: {},\n    };\n  },\n  computed: {\n    showButton: function() {\n      if (this.discussion) {\n        return this.discussion.isResolvable();\n      } else {\n        return false;\n      }\n    },\n    isDiscussionResolved: function() {\n      return this.discussion.isResolved();\n    },\n    buttonText: function() {\n      if (this.isDiscussionResolved) {\n        if (this.textareaIsEmpty) {\n          return 'Unresolve discussion';\n        } else {\n          return 'Comment & unresolve discussion';\n        }\n      } else {\n        if (this.textareaIsEmpty) {\n          return 'Resolve discussion';\n        } else {\n          return 'Comment & resolve discussion';\n        }\n      }\n    },\n  },\n  created() {\n    if (this.discussionId) {\n      this.discussion = CommentsStore.state[this.discussionId];\n    }\n  },\n  mounted: function() {\n    if (!this.discussionId) return;\n\n    const $textarea = $(\n      `.js-discussion-note-form[data-discussion-id=${this.discussionId}] .note-textarea`,\n    );\n    this.textareaIsEmpty = $textarea.val() === '';\n\n    $textarea.on('input.comment-and-resolve-btn', () => {\n      this.textareaIsEmpty = $textarea.val() === '';\n    });\n  },\n  destroyed: function() {\n    if (!this.discussionId) return;\n\n    $(`.js-discussion-note-form[data-discussion-id=${this.discussionId}] .note-textarea`).off(\n      'input.comment-and-resolve-btn',\n    );\n  },\n});\n\nVue.component('comment-and-resolve-btn', CommentAndResolveBtn);\n","/* eslint-disable object-shorthand, func-names, no-else-return, guard-for-in, no-restricted-syntax, no-lonely-if, no-continue */\n/* global CommentsStore */\n\nimport $ from 'jquery';\nimport Vue from 'vue';\n\nimport DiscussionMixins from '../mixins/discussion';\n\nconst JumpToDiscussion = Vue.extend({\n  mixins: [DiscussionMixins],\n  props: {\n    discussionId: {\n      type: String,\n      required: true,\n    },\n  },\n  data: function() {\n    return {\n      discussions: CommentsStore.state,\n      discussion: {},\n    };\n  },\n  computed: {\n    buttonText: function() {\n      if (this.discussionId) {\n        return 'Jump to next unresolved discussion';\n      } else {\n        return 'Jump to first unresolved discussion';\n      }\n    },\n    allResolved: function() {\n      return this.unresolvedDiscussionCount === 0;\n    },\n    showButton: function() {\n      if (this.discussionId) {\n        if (this.unresolvedDiscussionCount > 1) {\n          return true;\n        } else {\n          return this.discussionId !== this.lastResolvedId;\n        }\n      } else {\n        return this.unresolvedDiscussionCount >= 1;\n      }\n    },\n    lastResolvedId: function() {\n      let lastId;\n      for (const discussionId in this.discussions) {\n        const discussion = this.discussions[discussionId];\n\n        if (!discussion.isResolved()) {\n          lastId = discussion.id;\n        }\n      }\n      return lastId;\n    },\n  },\n  created() {\n    this.discussion = this.discussions[this.discussionId];\n  },\n  methods: {\n    jumpToNextUnresolvedDiscussion: function() {\n      let discussionsSelector;\n      let discussionIdsInScope;\n      let firstUnresolvedDiscussionId;\n      let nextUnresolvedDiscussionId;\n      let activeTab = window.mrTabs.currentAction;\n      let hasDiscussionsToJumpTo = true;\n      let jumpToFirstDiscussion = !this.discussionId;\n\n      const discussionIdsForElements = function(elements) {\n        return elements\n          .map(function() {\n            return $(this).attr('data-discussion-id');\n          })\n          .toArray();\n      };\n\n      const { discussions } = this;\n\n      if (activeTab === 'diffs') {\n        discussionsSelector = '.diffs .notes[data-discussion-id]';\n        discussionIdsInScope = discussionIdsForElements($(discussionsSelector));\n\n        let unresolvedDiscussionCount = 0;\n\n        for (let i = 0; i < discussionIdsInScope.length; i += 1) {\n          const discussionId = discussionIdsInScope[i];\n          const discussion = discussions[discussionId];\n          if (discussion && !discussion.isResolved()) {\n            unresolvedDiscussionCount += 1;\n          }\n        }\n\n        if (this.discussionId && !this.discussion.isResolved()) {\n          // If this is the last unresolved discussion on the diffs tab,\n          // there are no discussions to jump to.\n          if (unresolvedDiscussionCount === 1) {\n            hasDiscussionsToJumpTo = false;\n          }\n        } else {\n          // If there are no unresolved discussions on the diffs tab at all,\n          // there are no discussions to jump to.\n          if (unresolvedDiscussionCount === 0) {\n            hasDiscussionsToJumpTo = false;\n          }\n        }\n      } else if (activeTab !== 'show') {\n        // If we are on the commits or builds tabs,\n        // there are no discussions to jump to.\n        hasDiscussionsToJumpTo = false;\n      }\n\n      if (!hasDiscussionsToJumpTo) {\n        // If there are no discussions to jump to on the current page,\n        // switch to the notes tab and jump to the first discussion there.\n        window.mrTabs.activateTab('show');\n        activeTab = 'show';\n        jumpToFirstDiscussion = true;\n      }\n\n      if (activeTab === 'show') {\n        discussionsSelector = '.discussion[data-discussion-id]';\n        discussionIdsInScope = discussionIdsForElements($(discussionsSelector));\n      }\n\n      let currentDiscussionFound = false;\n      for (let i = 0; i < discussionIdsInScope.length; i += 1) {\n        const discussionId = discussionIdsInScope[i];\n        const discussion = discussions[discussionId];\n\n        if (!discussion) {\n          // Discussions for comments on commits in this MR don't have a resolved status.\n          continue;\n        }\n\n        if (!firstUnresolvedDiscussionId && !discussion.isResolved()) {\n          firstUnresolvedDiscussionId = discussionId;\n\n          if (jumpToFirstDiscussion) {\n            break;\n          }\n        }\n\n        if (!jumpToFirstDiscussion) {\n          if (currentDiscussionFound) {\n            if (!discussion.isResolved()) {\n              nextUnresolvedDiscussionId = discussionId;\n              break;\n            } else {\n              continue;\n            }\n          }\n\n          if (discussionId === this.discussionId) {\n            currentDiscussionFound = true;\n          }\n        }\n      }\n\n      nextUnresolvedDiscussionId = nextUnresolvedDiscussionId || firstUnresolvedDiscussionId;\n\n      if (!nextUnresolvedDiscussionId) {\n        return;\n      }\n\n      let $target = $(`${discussionsSelector}[data-discussion-id=\"${nextUnresolvedDiscussionId}\"]`);\n\n      if (activeTab === 'show') {\n        $target = $target.closest('.note-discussion');\n\n        // If the next discussion is closed, toggle it open.\n        if ($target.find('.js-toggle-content').is(':hidden')) {\n          $target.find('.js-toggle-button i').trigger('click');\n        }\n      } else if (activeTab === 'diffs') {\n        // Resolved discussions are hidden in the diffs tab by default.\n        // If they are marked unresolved on the notes tab, they will still be hidden on the diffs tab.\n        // When jumping between unresolved discussions on the diffs tab, we show them.\n        $target.closest('.content').show();\n\n        const $notesHolder = $target.closest('tr.notes_holder');\n\n        // Image diff discussions does not use notes_holder\n        // so we should keep original $target value in those cases\n        if ($notesHolder.length > 0) {\n          $target = $notesHolder;\n        }\n\n        $target.show();\n\n        // If we are on the diffs tab, we don't scroll to the discussion itself, but to\n        // 4 diff lines above it: the line the discussion was in response to + 3 context\n        let prevEl;\n        for (let i = 0; i < 4; i += 1) {\n          prevEl = $target.prev();\n\n          // If the discussion doesn't have 4 lines above it, we'll have to do with fewer.\n          if (!prevEl.hasClass('line_holder')) {\n            break;\n          }\n\n          $target = prevEl;\n        }\n      }\n\n      $.scrollTo($target, {\n        offset: -150,\n      });\n    },\n  },\n});\n\nVue.component('jump-to-discussion', JumpToDiscussion);\n","/* global CommentsStore */\n/* global ResolveService */\n\nimport $ from 'jquery';\nimport Vue from 'vue';\nimport Flash from '../../flash';\n\nconst ResolveBtn = Vue.extend({\n  props: {\n    noteId: {\n      type: Number,\n      required: true,\n    },\n    discussionId: {\n      type: String,\n      required: true,\n    },\n    resolved: {\n      type: Boolean,\n      required: true,\n    },\n    canResolve: {\n      type: Boolean,\n      required: true,\n    },\n    resolvedBy: {\n      type: String,\n      required: true,\n    },\n    authorName: {\n      type: String,\n      required: true,\n    },\n    authorAvatar: {\n      type: String,\n      required: true,\n    },\n    noteTruncated: {\n      type: String,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      discussions: CommentsStore.state,\n      loading: false,\n    };\n  },\n  computed: {\n    discussion() {\n      return this.discussions[this.discussionId];\n    },\n    note() {\n      return this.discussion ? this.discussion.getNote(this.noteId) : {};\n    },\n    buttonText() {\n      if (this.isResolved) {\n        return `Resolved by ${this.resolvedByName}`;\n      } else if (this.canResolve) {\n        return 'Mark as resolved';\n      }\n\n      return 'Unable to resolve';\n    },\n    isResolved() {\n      if (this.note) {\n        return this.note.resolved;\n      }\n\n      return false;\n    },\n    resolvedByName() {\n      return this.note.resolved_by;\n    },\n  },\n  watch: {\n    discussions: {\n      handler: 'updateTooltip',\n      deep: true,\n    },\n  },\n  mounted() {\n    $(this.$refs.button).tooltip({\n      container: 'body',\n    });\n  },\n  beforeDestroy() {\n    CommentsStore.delete(this.discussionId, this.noteId);\n  },\n  created() {\n    CommentsStore.create({\n      discussionId: this.discussionId,\n      noteId: this.noteId,\n      canResolve: this.canResolve,\n      resolved: this.resolved,\n      resolvedBy: this.resolvedBy,\n      authorName: this.authorName,\n      authorAvatar: this.authorAvatar,\n      noteTruncated: this.noteTruncated,\n    });\n  },\n  methods: {\n    updateTooltip() {\n      this.$nextTick(() => {\n        $(this.$refs.button)\n          .tooltip('hide')\n          .tooltip('_fixTitle');\n      });\n    },\n    resolve() {\n      if (!this.canResolve) return;\n\n      let promise;\n      this.loading = true;\n\n      if (this.isResolved) {\n        promise = ResolveService.unresolve(this.noteId);\n      } else {\n        promise = ResolveService.resolve(this.noteId);\n      }\n\n      promise\n        .then(resp => resp.json())\n        .then(data => {\n          this.loading = false;\n\n          const resolvedBy = data ? data.resolved_by : null;\n\n          CommentsStore.update(this.discussionId, this.noteId, !this.isResolved, resolvedBy);\n          this.discussion.updateHeadline(data);\n          gl.mrWidget.checkStatus();\n          this.updateTooltip();\n        })\n        .catch(\n          () => new Flash('An error occurred when trying to resolve a comment. Please try again.'),\n        );\n    },\n  },\n});\n\nVue.component('resolve-btn', ResolveBtn);\n","/* eslint-disable object-shorthand, func-names */\n/* global CommentsStore */\n\nimport Vue from 'vue';\n\nimport DiscussionMixins from '../mixins/discussion';\n\nwindow.ResolveCount = Vue.extend({\n  mixins: [DiscussionMixins],\n  props: {\n    loggedOut: {\n      type: Boolean,\n      required: true,\n    },\n  },\n  data: function() {\n    return {\n      discussions: CommentsStore.state,\n    };\n  },\n  computed: {\n    allResolved: function() {\n      return this.resolvedDiscussionCount === this.discussionCount;\n    },\n    resolvedCountText() {\n      return this.discussionCount === 1 ? 'discussion' : 'discussions';\n    },\n  },\n});\n","/* eslint-disable object-shorthand, func-names, no-else-return */\n/* global CommentsStore */\n/* global ResolveService */\n\nimport Vue from 'vue';\n\nconst ResolveDiscussionBtn = Vue.extend({\n  props: {\n    discussionId: {\n      type: String,\n      required: true,\n    },\n    mergeRequestId: {\n      type: Number,\n      required: true,\n    },\n    canResolve: {\n      type: Boolean,\n      required: true,\n    },\n  },\n  data: function() {\n    return {\n      discussion: {},\n    };\n  },\n  computed: {\n    showButton: function() {\n      if (this.discussion) {\n        return this.discussion.isResolvable();\n      } else {\n        return false;\n      }\n    },\n    isDiscussionResolved: function() {\n      if (this.discussion) {\n        return this.discussion.isResolved();\n      } else {\n        return false;\n      }\n    },\n    buttonText: function() {\n      if (this.isDiscussionResolved) {\n        return 'Unresolve discussion';\n      } else {\n        return 'Resolve discussion';\n      }\n    },\n    loading: function() {\n      if (this.discussion) {\n        return this.discussion.loading;\n      } else {\n        return false;\n      }\n    },\n  },\n  created: function() {\n    CommentsStore.createDiscussion(this.discussionId, this.canResolve);\n\n    this.discussion = CommentsStore.state[this.discussionId];\n  },\n  methods: {\n    resolve: function() {\n      ResolveService.toggleResolveForDiscussion(this.mergeRequestId, this.discussionId);\n    },\n  },\n});\n\nVue.component('resolve-discussion-btn', ResolveDiscussionBtn);\n","/* global CommentsStore */\n\nimport $ from 'jquery';\nimport Vue from 'vue';\nimport collapseIcon from '../icons/collapse_icon.svg';\nimport Notes from '../../notes';\nimport userAvatarImage from '../../vue_shared/components/user_avatar/user_avatar_image.vue';\n\nconst DiffNoteAvatars = Vue.extend({\n  components: {\n    userAvatarImage,\n  },\n  props: {\n    discussionId: {\n      type: String,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      isVisible: false,\n      lineType: '',\n      storeState: CommentsStore.state,\n      shownAvatars: 3,\n      collapseIcon,\n    };\n  },\n  computed: {\n    discussionClassName() {\n      return `js-diff-avatars-${this.discussionId}`;\n    },\n    notesSubset() {\n      let notes = [];\n\n      if (this.discussion) {\n        notes = Object.keys(this.discussion.notes)\n          .slice(0, this.shownAvatars)\n          .map(noteId => this.discussion.notes[noteId]);\n      }\n\n      return notes;\n    },\n    extraNotesTitle() {\n      if (this.discussion) {\n        const extra = this.discussion.notesCount() - this.shownAvatars;\n\n        return `${extra} more comment${extra > 1 ? 's' : ''}`;\n      }\n\n      return '';\n    },\n    discussion() {\n      return this.storeState[this.discussionId];\n    },\n    notesCount() {\n      if (this.discussion) {\n        return this.discussion.notesCount();\n      }\n\n      return 0;\n    },\n    moreText() {\n      const plusSign = this.notesCount < 100 ? '+' : '';\n\n      return `${plusSign}${this.notesCount - this.shownAvatars}`;\n    },\n  },\n  watch: {\n    storeState: {\n      handler() {\n        this.$nextTick(() => {\n          $('.has-tooltip', this.$el).tooltip('_fixTitle');\n\n          // We need to add/remove a class to an element that is outside the Vue instance\n          this.addNoCommentClass();\n        });\n      },\n      deep: true,\n    },\n  },\n  mounted() {\n    this.$nextTick(() => {\n      this.addNoCommentClass();\n      this.setDiscussionVisible();\n\n      this.lineType = $(this.$el)\n        .closest('.diff-line-num')\n        .hasClass('old_line')\n        ? 'old'\n        : 'new';\n    });\n\n    $(document).on('toggle.comments', () => {\n      this.$nextTick(() => {\n        this.setDiscussionVisible();\n      });\n    });\n  },\n  beforeDestroy() {\n    this.addNoCommentClass();\n    $(document).off('toggle.comments');\n  },\n  methods: {\n    clickedAvatar(e) {\n      Notes.instance.onAddDiffNote(e);\n\n      // Toggle the active state of the toggle all button\n      this.toggleDiscussionsToggleState();\n\n      this.$nextTick(() => {\n        this.setDiscussionVisible();\n\n        $('.has-tooltip', this.$el).tooltip('_fixTitle');\n        $('.has-tooltip', this.$el).tooltip('hide');\n      });\n    },\n    addNoCommentClass() {\n      const { notesCount } = this;\n\n      $(this.$el)\n        .closest('.js-avatar-container')\n        .toggleClass('no-comment-btn', notesCount > 0)\n        .nextUntil('.js-avatar-container')\n        .toggleClass('no-comment-btn', notesCount > 0);\n    },\n    toggleDiscussionsToggleState() {\n      const $notesHolders = $(this.$el)\n        .closest('.code')\n        .find('.notes_holder');\n      const $visibleNotesHolders = $notesHolders.filter(':visible');\n      const $toggleDiffCommentsBtn = $(this.$el)\n        .closest('.diff-file')\n        .find('.js-toggle-diff-comments');\n\n      $toggleDiffCommentsBtn.toggleClass(\n        'active',\n        $notesHolders.length === $visibleNotesHolders.length,\n      );\n    },\n    setDiscussionVisible() {\n      this.isVisible = $(`.diffs .notes[data-discussion-id=\"${this.discussion.id}\"]`).is(\n        ':visible',\n      );\n    },\n    getTooltipText(note) {\n      return `${note.authorName}: ${note.noteTruncated}`;\n    },\n  },\n  template: `\n    <div class=\"diff-comment-avatar-holders\"\n      :class=\"discussionClassName\"\n      v-show=\"notesCount !== 0\">\n      <div v-if=\"!isVisible\">\n        <!-- FIXME: Pass an alt attribute here for accessibility -->\n        <user-avatar-image\n          v-for=\"note in notesSubset\"\n          :key=\"note.id\"\n          class=\"diff-comment-avatar js-diff-comment-avatar\"\n          @click.native=\"clickedAvatar($event)\"\n          :img-src=\"note.authorAvatar\"\n          :tooltip-text=\"getTooltipText(note)\"\n          :data-line-type=\"lineType\"\n          :size=\"19\"\n          data-html=\"true\"\n        />\n        <span v-if=\"notesCount > shownAvatars\"\n          class=\"diff-comments-more-count has-tooltip js-diff-comment-avatar\"\n          data-container=\"body\"\n          data-placement=\"top\"\n          ref=\"extraComments\"\n          role=\"button\"\n          :data-line-type=\"lineType\"\n          :title=\"extraNotesTitle\"\n          @click=\"clickedAvatar($event)\">{{ moreText }}</span>\n      </div>\n      <button class=\"diff-notes-collapse js-diff-comment-avatar\"\n        type=\"button\"\n        aria-label=\"Show comments\"\n        :data-line-type=\"lineType\"\n        @click=\"clickedAvatar($event)\"\n        v-if=\"isVisible\"\n        v-html=\"collapseIcon\">\n      </button>\n    </div>\n  `,\n});\n\nVue.component('diff-note-avatars', DiffNoteAvatars);\n","/* global CommentsStore */\n\nimport Vue from 'vue';\n\nconst NewIssueForDiscussion = Vue.extend({\n  props: {\n    discussionId: {\n      type: String,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      discussions: CommentsStore.state,\n    };\n  },\n  computed: {\n    discussion() {\n      return this.discussions[this.discussionId];\n    },\n    showButton() {\n      if (this.discussion) return !this.discussion.isResolved();\n      return false;\n    },\n  },\n});\n\nVue.component('new-issue-for-discussion-btn', NewIssueForDiscussion);\n","/* eslint-disable func-names, new-cap */\n\nimport $ from 'jquery';\nimport Vue from 'vue';\nimport './models/discussion';\nimport './models/note';\nimport './stores/comments';\nimport './services/resolve';\nimport './mixins/discussion';\nimport './components/comment_resolve_btn';\nimport './components/jump_to_discussion';\nimport './components/resolve_btn';\nimport './components/resolve_count';\nimport './components/resolve_discussion_btn';\nimport './components/diff_note_avatars';\nimport './components/new_issue_for_discussion';\n\nexport default () => {\n  const projectPathHolder =\n    document.querySelector('.merge-request') || document.querySelector('.commit-box');\n  const { projectPath } = projectPathHolder.dataset;\n  const COMPONENT_SELECTOR =\n    'resolve-btn, resolve-discussion-btn, jump-to-discussion, comment-and-resolve-btn, new-issue-for-discussion-btn';\n\n  window.gl = window.gl || {};\n  window.gl.diffNoteApps = {};\n\n  window.ResolveService = new gl.DiffNotesResolveServiceClass(projectPath);\n\n  gl.diffNotesCompileComponents = () => {\n    $('diff-note-avatars').each(function() {\n      const tmp = Vue.extend({\n        template: $(this).get(0).outerHTML,\n      });\n      const tmpApp = new tmp().$mount();\n\n      $(this).replaceWith(tmpApp.$el);\n      $(tmpApp.$el).one('remove.vue', () => {\n        tmpApp.$destroy();\n        tmpApp.$el.remove();\n      });\n    });\n\n    const $components = $(COMPONENT_SELECTOR).filter(function() {\n      return $(this).closest('resolve-count').length !== 1;\n    });\n\n    if ($components) {\n      $components.each(function() {\n        const $this = $(this);\n        const noteId = $this.attr(':note-id');\n        const discussionId = $this.attr(':discussion-id');\n\n        if ($this.is('comment-and-resolve-btn') && !discussionId) return;\n\n        const tmp = Vue.extend({\n          template: $this.get(0).outerHTML,\n        });\n        const tmpApp = new tmp().$mount();\n\n        if (noteId) {\n          gl.diffNoteApps[`note_${noteId}`] = tmpApp;\n        }\n\n        $this.replaceWith(tmpApp.$el);\n      });\n    }\n  };\n\n  gl.diffNotesCompileComponents();\n\n  $(window).trigger('resize.nav');\n};\n","/* global Flash */\n\nimport $ from 'jquery';\nimport axios from './lib/utils/axios_utils';\nimport { n__, s__ } from './locale';\n\nexport function getHeaderText(childElementCount, mergeRequestCount) {\n  if (childElementCount === 0) {\n    return `${mergeRequestCount} ${n__('merge request', 'merge requests', mergeRequestCount)}`;\n  }\n  return ',';\n}\n\nexport function createHeader(childElementCount, mergeRequestCount) {\n  const headerText = getHeaderText(childElementCount, mergeRequestCount);\n\n  return $('<span />', {\n    class: 'append-right-5',\n    text: headerText,\n  });\n}\n\nexport function createLink(mergeRequest) {\n  return $('<a />', {\n    class: 'append-right-5',\n    href: mergeRequest.path,\n    text: `!${mergeRequest.iid}`,\n  });\n}\n\nexport function createTitle(mergeRequest) {\n  return $('<span />', {\n    text: mergeRequest.title,\n  });\n}\n\nexport function createItem(mergeRequest) {\n  const $item = $('<span />');\n  const $link = createLink(mergeRequest);\n  const $title = createTitle(mergeRequest);\n  $item.append($link);\n  $item.append($title);\n\n  return $item;\n}\n\nexport function createContent(mergeRequests) {\n  const $content = $('<span />');\n\n  if (mergeRequests.length === 0) {\n    $content.text(s__('Commits|No related merge requests found'));\n  } else {\n    mergeRequests.forEach(mergeRequest => {\n      const $header = createHeader($content.children().length, mergeRequests.length);\n      const $item = createItem(mergeRequest);\n      $content.append($header);\n      $content.append($item);\n    });\n  }\n\n  return $content;\n}\n\nexport function fetchCommitMergeRequests() {\n  const $container = $('.merge-requests');\n\n  axios\n    .get($container.data('projectCommitPath'))\n    .then(response => {\n      const $content = createContent(response.data);\n\n      $container.html($content);\n    })\n    .catch(() => Flash(s__('Commits|An error occurred while fetching merge requests data.')));\n}\n","/* eslint-disable no-new */\n\nimport $ from 'jquery';\nimport Diff from '~/diff';\nimport ZenMode from '~/zen_mode';\nimport ShortcutsNavigation from '~/behaviors/shortcuts/shortcuts_navigation';\nimport MiniPipelineGraph from '~/mini_pipeline_graph_dropdown';\nimport initNotes from '~/init_notes';\nimport initChangesDropdown from '~/init_changes_dropdown';\nimport initDiffNotes from '~/diff_notes/diff_notes_bundle';\nimport { fetchCommitMergeRequests } from '~/commit_merge_requests';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const hasPerfBar = document.querySelector('.with-performance-bar');\n  const performanceHeight = hasPerfBar ? 35 : 0;\n  new Diff();\n  new ZenMode();\n  new ShortcutsNavigation();\n  new MiniPipelineGraph({\n    container: '.js-commit-pipeline-graph',\n  }).bindEvents();\n  initNotes();\n  initChangesDropdown(document.querySelector('.navbar-gitlab').offsetHeight + performanceHeight);\n  $('.commit-info.branches').load(document.querySelector('.js-commit-box').dataset.commitPath);\n  fetchCommitMergeRequests();\n  initDiffNotes();\n});\n","import $ from 'jquery';\nimport 'deckar01-task_list';\nimport axios from './lib/utils/axios_utils';\nimport Flash from './flash';\n\nexport default class TaskList {\n  constructor(options = {}) {\n    this.selector = options.selector;\n    this.dataType = options.dataType;\n    this.fieldName = options.fieldName;\n    this.onSuccess = options.onSuccess || (() => {});\n    this.onError = function showFlash(e) {\n      let errorMessages = '';\n\n      if (e.response.data && typeof e.response.data === 'object') {\n        errorMessages = e.response.data.errors.join(' ');\n      }\n\n      return new Flash(errorMessages || 'Update failed', 'alert');\n    };\n\n    this.init();\n  }\n\n  init() {\n    // Prevent duplicate event bindings\n    this.disable();\n    $(`${this.selector} .js-task-list-container`).taskList('enable');\n    $(document).on(\n      'tasklist:changed',\n      `${this.selector} .js-task-list-container`,\n      this.update.bind(this),\n    );\n  }\n\n  disable() {\n    $(`${this.selector} .js-task-list-container`).taskList('disable');\n    $(document).off('tasklist:changed', `${this.selector} .js-task-list-container`);\n  }\n\n  update(e) {\n    const $target = $(e.target);\n    const patchData = {};\n    patchData[this.dataType] = {\n      [this.fieldName]: $target.val(),\n    };\n\n    return axios\n      .patch($target.data('updateUrl') || $('form.js-issuable-update').attr('action'), patchData)\n      .then(({ data }) => this.onSuccess(data))\n      .catch(err => this.onError(err));\n  }\n}\n","/* eslint-disable */\n\nconst InputSetter = {\n  init(hook) {\n    this.hook = hook;\n    this.destroyed = false;\n    this.config = hook.config.InputSetter || (this.hook.config.InputSetter = {});\n\n    this.eventWrapper = {};\n\n    this.addEvents();\n  },\n\n  addEvents() {\n    this.eventWrapper.setInputs = this.setInputs.bind(this);\n    this.hook.list.list.addEventListener('click.dl', this.eventWrapper.setInputs);\n  },\n\n  removeEvents() {\n    this.hook.list.list.removeEventListener('click.dl', this.eventWrapper.setInputs);\n  },\n\n  setInputs(e) {\n    if (this.destroyed) return;\n\n    const selectedItem = e.detail.selected;\n\n    if (!Array.isArray(this.config)) this.config = [this.config];\n\n    this.config.forEach(config => this.setInput(config, selectedItem));\n  },\n\n  setInput(config, selectedItem) {\n    const input = config.input || this.hook.trigger;\n    const newValue = selectedItem.getAttribute(config.valueAttribute);\n    const inputAttribute = config.inputAttribute;\n\n    if (input.hasAttribute(inputAttribute)) return input.setAttribute(inputAttribute, newValue);\n    if (input.tagName === 'INPUT') return (input.value = newValue);\n    return (input.textContent = newValue);\n  },\n\n  destroy() {\n    this.destroyed = true;\n\n    this.removeEvents();\n  },\n};\n\nexport default InputSetter;\n","import StickyFill from 'stickyfilljs';\n\nexport const createPlaceholder = () => {\n  const placeholder = document.createElement('div');\n  placeholder.classList.add('sticky-placeholder');\n\n  return placeholder;\n};\n\nexport const isSticky = (el, scrollY, stickyTop, insertPlaceholder) => {\n  const top = Math.floor(el.offsetTop - scrollY);\n\n  if (top <= stickyTop && !el.classList.contains('is-stuck')) {\n    const placeholder = insertPlaceholder ? createPlaceholder() : null;\n    const heightBefore = el.offsetHeight;\n\n    el.classList.add('is-stuck');\n\n    if (insertPlaceholder) {\n      el.parentNode.insertBefore(placeholder, el.nextElementSibling);\n\n      placeholder.style.height = `${heightBefore - el.offsetHeight}px`;\n    }\n  } else if (top > stickyTop && el.classList.contains('is-stuck')) {\n    el.classList.remove('is-stuck');\n\n    if (\n      insertPlaceholder &&\n      el.nextElementSibling &&\n      el.nextElementSibling.classList.contains('sticky-placeholder')\n    ) {\n      el.nextElementSibling.remove();\n    }\n  }\n};\n\n/**\n * Create a listener that will toggle a 'is-stuck' class, based on the current scroll position.\n *\n * - If the current environment does not support `position: sticky`, do nothing.\n *\n * @param {HTMLElement} el The `position: sticky` element.\n * @param {Number} stickyTop Used to determine when an element is stuck.\n * @param {Boolean} insertPlaceholder Should a placeholder element be created when element is stuck?\n */\nexport const stickyMonitor = (el, stickyTop, insertPlaceholder = true) => {\n  if (!el) return;\n\n  if (\n    typeof CSS === 'undefined' ||\n    !CSS.supports('(position: -webkit-sticky) or (position: sticky)')\n  )\n    return;\n\n  document.addEventListener(\n    'scroll',\n    () => isSticky(el, window.scrollY, stickyTop, insertPlaceholder),\n    {\n      passive: true,\n    },\n  );\n};\n\n/**\n * Polyfill the `position: sticky` behavior.\n *\n * - If the current environment supports `position: sticky`, do nothing.\n * - Can receive an iterable element list (NodeList, jQuery collection, etc.) or single HTMLElement.\n */\nexport const polyfillSticky = el => {\n  StickyFill.add(el);\n};\n","/* Developer beware! Do not add logic to showButton or hideButton\n * that will force a reflow. Doing so will create a significant performance\n * bottleneck for pages with large diffs. For a comprehensive list of what\n * causes reflows, visit https://gist.github.com/paulirish/5d52fb081b3570c81e3a\n */\n\nimport Cookies from 'js-cookie';\n\nconst LINE_NUMBER_CLASS = 'diff-line-num';\nconst UNFOLDABLE_LINE_CLASS = 'js-unfold';\nconst NO_COMMENT_CLASS = 'no-comment-btn';\nconst EMPTY_CELL_CLASS = 'empty-cell';\nconst OLD_LINE_CLASS = 'old_line';\nconst LINE_COLUMN_CLASSES = `.${LINE_NUMBER_CLASS}, .line_content`;\nconst DIFF_CONTAINER_SELECTOR = '.files';\nconst DIFF_EXPANDED_CLASS = 'diff-expanded';\n\nexport default {\n  init($diffFile) {\n    /* Caching is used only when the following members are *true*.\n     * This is because there are likely to be\n     * differently configured versions of diffs in the same session.\n     * However if these values are true, they\n     * will be true in all cases */\n\n    if (!this.userCanCreateNote) {\n      // data-can-create-note is an empty string when true, otherwise undefined\n      this.userCanCreateNote =\n        $diffFile.closest(DIFF_CONTAINER_SELECTOR).data('canCreateNote') === '';\n    }\n\n    this.isParallelView = Cookies.get('diff_view') === 'parallel';\n\n    if (this.userCanCreateNote) {\n      $diffFile\n        .on('mouseover', LINE_COLUMN_CLASSES, e => this.showButton(this.isParallelView, e))\n        .on('mouseleave', LINE_COLUMN_CLASSES, e => this.hideButton(this.isParallelView, e));\n    }\n  },\n\n  showButton(isParallelView, e) {\n    const buttonParentElement = this.getButtonParent(e.currentTarget, isParallelView);\n\n    if (!this.validateButtonParent(buttonParentElement)) return;\n\n    buttonParentElement.classList.add('is-over');\n    buttonParentElement.nextElementSibling.classList.add('is-over');\n  },\n\n  hideButton(isParallelView, e) {\n    const buttonParentElement = this.getButtonParent(e.currentTarget, isParallelView);\n\n    buttonParentElement.classList.remove('is-over');\n    buttonParentElement.nextElementSibling.classList.remove('is-over');\n  },\n\n  getButtonParent(hoveredElement, isParallelView) {\n    if (isParallelView) {\n      if (!hoveredElement.classList.contains(LINE_NUMBER_CLASS)) {\n        return hoveredElement.previousElementSibling;\n      }\n    } else if (!hoveredElement.classList.contains(OLD_LINE_CLASS)) {\n      return hoveredElement.parentNode.querySelector(`.${OLD_LINE_CLASS}`);\n    }\n    return hoveredElement;\n  },\n\n  validateButtonParent(buttonParentElement) {\n    return (\n      !buttonParentElement.classList.contains(EMPTY_CELL_CLASS) &&\n      !buttonParentElement.classList.contains(UNFOLDABLE_LINE_CLASS) &&\n      !buttonParentElement.classList.contains(NO_COMMENT_CLASS) &&\n      !buttonParentElement.parentNode.classList.contains(DIFF_EXPANDED_CLASS)\n    );\n  },\n};\n","/* eslint-disable func-names, prefer-arrow-callback, consistent-return, */\n\nimport $ from 'jquery';\nimport { __ } from './locale';\nimport axios from './lib/utils/axios_utils';\nimport createFlash from './flash';\nimport FilesCommentButton from './files_comment_button';\nimport imageDiffHelper from './image_diff/helpers/index';\nimport syntaxHighlight from './syntax_highlight';\n\nconst WRAPPER = '<div class=\"diff-content\"></div>';\nconst LOADING_HTML = '<i class=\"fa fa-spinner fa-spin\"></i>';\nconst ERROR_HTML =\n  '<div class=\"nothing-here-block\"><i class=\"fa fa-warning\"></i> Could not load diff</div>';\nconst COLLAPSED_HTML =\n  '<div class=\"nothing-here-block diff-collapsed\">This diff is collapsed. <button class=\"click-to-expand btn btn-link\">Click to expand it.</button></div>';\n\nexport default class SingleFileDiff {\n  constructor(file) {\n    this.file = file;\n    this.toggleDiff = this.toggleDiff.bind(this);\n    this.content = $('.diff-content', this.file);\n    this.$toggleIcon = $('.diff-toggle-caret', this.file);\n    this.diffForPath = this.content.find('[data-diff-for-path]').data('diffForPath');\n    this.isOpen = !this.diffForPath;\n    if (this.diffForPath) {\n      this.collapsedContent = this.content;\n      this.loadingContent = $(WRAPPER)\n        .addClass('loading')\n        .html(LOADING_HTML)\n        .hide();\n      this.content = null;\n      this.collapsedContent.after(this.loadingContent);\n      this.$toggleIcon.addClass('fa-caret-right');\n    } else {\n      this.collapsedContent = $(WRAPPER)\n        .html(COLLAPSED_HTML)\n        .hide();\n      this.content.after(this.collapsedContent);\n      this.$toggleIcon.addClass('fa-caret-down');\n    }\n\n    $('.js-file-title, .click-to-expand', this.file).on(\n      'click',\n      function(e) {\n        this.toggleDiff($(e.target));\n      }.bind(this),\n    );\n  }\n\n  toggleDiff($target, cb) {\n    if (\n      !$target.hasClass('js-file-title') &&\n      !$target.hasClass('click-to-expand') &&\n      !$target.hasClass('diff-toggle-caret')\n    )\n      return;\n    this.isOpen = !this.isOpen;\n    if (!this.isOpen && !this.hasError) {\n      this.content.hide();\n      this.$toggleIcon.addClass('fa-caret-right').removeClass('fa-caret-down');\n      this.collapsedContent.show();\n      if (typeof gl.diffNotesCompileComponents !== 'undefined') {\n        gl.diffNotesCompileComponents();\n      }\n    } else if (this.content) {\n      this.collapsedContent.hide();\n      this.content.show();\n      this.$toggleIcon.addClass('fa-caret-down').removeClass('fa-caret-right');\n      if (typeof gl.diffNotesCompileComponents !== 'undefined') {\n        gl.diffNotesCompileComponents();\n      }\n    } else {\n      this.$toggleIcon.addClass('fa-caret-down').removeClass('fa-caret-right');\n      return this.getContentHTML(cb);\n    }\n  }\n\n  getContentHTML(cb) {\n    this.collapsedContent.hide();\n    this.loadingContent.show();\n\n    axios\n      .get(this.diffForPath)\n      .then(({ data }) => {\n        this.loadingContent.hide();\n        if (data.html) {\n          this.content = $(data.html);\n          syntaxHighlight(this.content);\n        } else {\n          this.hasError = true;\n          this.content = $(ERROR_HTML);\n        }\n        this.collapsedContent.after(this.content);\n\n        if (typeof gl.diffNotesCompileComponents !== 'undefined') {\n          gl.diffNotesCompileComponents();\n        }\n\n        const $file = $(this.file);\n        FilesCommentButton.init($file);\n\n        const canCreateNote = $file.closest('.files').is('[data-can-create-note]');\n        imageDiffHelper.initImageDiff($file[0], canCreateNote);\n\n        if (cb) cb();\n      })\n      .catch(() => {\n        createFlash(__('An error occurred while retrieving diff'));\n      });\n  }\n}\n","import $ from 'jquery';\nimport axios from '~/lib/utils/axios_utils';\nimport flash from '~/flash';\nimport { __ } from '~/locale';\nimport { getLocationHash } from './lib/utils/url_utility';\nimport FilesCommentButton from './files_comment_button';\nimport SingleFileDiff from './single_file_diff';\nimport imageDiffHelper from './image_diff/helpers/index';\n\nconst UNFOLD_COUNT = 20;\nlet isBound = false;\n\nexport default class Diff {\n  constructor() {\n    const $diffFile = $('.files .diff-file');\n\n    $diffFile.each((index, file) => {\n      if (!$.data(file, 'singleFileDiff')) {\n        $.data(file, 'singleFileDiff', new SingleFileDiff(file));\n      }\n    });\n\n    const tab = document.getElementById('diffs');\n    if (!tab || (tab && tab.dataset && tab.dataset.isLocked !== ''))\n      FilesCommentButton.init($diffFile);\n\n    const firstFile = $('.files')\n      .first()\n      .get(0);\n    const canCreateNote = firstFile && firstFile.hasAttribute('data-can-create-note');\n    $diffFile.each((index, file) => imageDiffHelper.initImageDiff(file, canCreateNote));\n\n    if (!isBound) {\n      $(document)\n        .on('click', '.js-unfold', this.handleClickUnfold.bind(this))\n        .on('click', '.diff-line-num a', this.handleClickLineNum.bind(this))\n        .on('mousedown', 'td.line_content.parallel', this.handleParallelLineDown.bind(this));\n      isBound = true;\n    }\n\n    if (getLocationHash()) {\n      this.highlightSelectedLine();\n    }\n\n    this.openAnchoredDiff();\n  }\n\n  handleClickUnfold(e) {\n    const $target = $(e.target);\n    const [oldLineNumber, newLineNumber] = this.lineNumbers($target.parent());\n    const offset = newLineNumber - oldLineNumber;\n    const bottom = $target.hasClass('js-unfold-bottom');\n    let since;\n    let to;\n    let unfold = true;\n\n    if (bottom) {\n      const lineNumber = newLineNumber + 1;\n      since = lineNumber;\n      to = lineNumber + UNFOLD_COUNT;\n    } else {\n      const lineNumber = newLineNumber - 1;\n      since = lineNumber - UNFOLD_COUNT;\n      to = lineNumber;\n\n      // make sure we aren't loading more than we need\n      const prevNewLine = this.lineNumbers($target.parent().prev())[1];\n      if (since <= prevNewLine + 1) {\n        since = prevNewLine + 1;\n        unfold = false;\n      }\n    }\n\n    const file = $target.parents('.diff-file');\n    const link = file.data('blobDiffPath');\n    const view = file.data('view');\n\n    const params = { since, to, bottom, offset, unfold, view };\n    axios\n      .get(link, { params })\n      .then(({ data }) => $target.parent().replaceWith(data))\n      .catch(() => flash(__('An error occurred while loading diff')));\n  }\n\n  openAnchoredDiff(cb) {\n    const locationHash = getLocationHash();\n    const anchoredDiff = locationHash && locationHash.split('_')[0];\n\n    if (!anchoredDiff) return;\n\n    const diffTitle = $(`#${anchoredDiff}`);\n    const diffFile = diffTitle.closest('.diff-file');\n    const nothingHereBlock = $('.nothing-here-block:visible', diffFile);\n    if (nothingHereBlock.length) {\n      const clickTarget = $('.js-file-title, .click-to-expand', diffFile);\n      diffFile.data('singleFileDiff').toggleDiff(clickTarget, () => {\n        this.highlightSelectedLine();\n        if (cb) cb();\n      });\n    } else if (cb) {\n      cb();\n    }\n  }\n\n  handleClickLineNum(e) {\n    const hash = $(e.currentTarget).attr('href');\n    e.preventDefault();\n    if (window.history.pushState) {\n      window.history.pushState(null, null, hash);\n    } else {\n      window.location.hash = hash;\n    }\n    this.highlightSelectedLine();\n  }\n  // eslint-disable-next-line class-methods-use-this\n  handleParallelLineDown(e) {\n    const line = $(e.currentTarget);\n    const table = line.closest('table');\n\n    table.removeClass('left-side-selected right-side-selected');\n\n    const lineClass = ['left-side', 'right-side'].filter(name => line.hasClass(name))[0];\n    if (lineClass) {\n      table.addClass(`${lineClass}-selected`);\n    }\n  }\n  // eslint-disable-next-line class-methods-use-this\n  diffViewType() {\n    return $('.inline-parallel-buttons a.active').data('viewType');\n  }\n  // eslint-disable-next-line class-methods-use-this\n  lineNumbers(line) {\n    const children = line.find('.diff-line-num').toArray();\n    if (children.length !== 2) {\n      return [0, 0];\n    }\n    return children.map(elm => parseInt($(elm).data('linenumber'), 10) || 0);\n  }\n  // eslint-disable-next-line class-methods-use-this\n  highlightSelectedLine() {\n    const hash = getLocationHash();\n    const $diffFiles = $('.diff-file');\n    $diffFiles.find('.hll').removeClass('hll');\n\n    if (hash) {\n      $diffFiles\n        .find(`tr#${hash}:not(.match) td, td#${hash}, td[data-line-code=\"${hash}\"]`)\n        .addClass('hll');\n    }\n  }\n}\n","/*!\r\n  * Stickyfill  `position: sticky` polyfill\r\n  * v. 2.0.5 | https://github.com/wilddeer/stickyfill\r\n  * MIT License\r\n  */\r\n\r\n;(function(window, document) {\r\n    'use strict';\r\n    \r\n    /*\r\n     * 1. Check if the browser supports `position: sticky` natively or is too old to run the polyfill.\r\n     *    If either of these is the case set `seppuku` flag. It will be checked later to disable key features\r\n     *    of the polyfill, but the API will remain functional to avoid breaking things.\r\n     */\r\n    \r\n    var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n    \r\n    function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n    \r\n    var seppuku = false;\r\n    \r\n    // The polyfill cantt function properly without `getComputedStyle`.\r\n    if (!window.getComputedStyle) seppuku = true;\r\n    // Dontt get in a way if the browser supports `position: sticky` natively.\r\n    else {\r\n            var testNode = document.createElement('div');\r\n    \r\n            if (['', '-webkit-', '-moz-', '-ms-'].some(function (prefix) {\r\n                try {\r\n                    testNode.style.position = prefix + 'sticky';\r\n                } catch (e) {}\r\n    \r\n                return testNode.style.position != '';\r\n            })) seppuku = true;\r\n        }\r\n    \r\n    /*\r\n     * 2. Global vars used across the polyfill\r\n     */\r\n    \r\n    // Check if Shadow Root constructor exists to make further checks simpler\r\n    var shadowRootExists = typeof ShadowRoot !== 'undefined';\r\n    \r\n    // Last saved scroll position\r\n    var scroll = {\r\n        top: null,\r\n        left: null\r\n    };\r\n    \r\n    // Array of created Sticky instances\r\n    var stickies = [];\r\n    \r\n    /*\r\n     * 3. Utility functions\r\n     */\r\n    function extend(targetObj, sourceObject) {\r\n        for (var key in sourceObject) {\r\n            if (sourceObject.hasOwnProperty(key)) {\r\n                targetObj[key] = sourceObject[key];\r\n            }\r\n        }\r\n    }\r\n    \r\n    function parseNumeric(val) {\r\n        return parseFloat(val) || 0;\r\n    }\r\n    \r\n    function getDocOffsetTop(node) {\r\n        var docOffsetTop = 0;\r\n    \r\n        while (node) {\r\n            docOffsetTop += node.offsetTop;\r\n            node = node.offsetParent;\r\n        }\r\n    \r\n        return docOffsetTop;\r\n    }\r\n    \r\n    /*\r\n     * 4. Sticky class\r\n     */\r\n    \r\n    var Sticky = function () {\r\n        function Sticky(node) {\r\n            _classCallCheck(this, Sticky);\r\n    \r\n            if (!(node instanceof HTMLElement)) throw new Error('First argument must be HTMLElement');\r\n            if (stickies.some(function (sticky) {\r\n                return sticky._node === node;\r\n            })) throw new Error('Stickyfill is already applied to this node');\r\n    \r\n            this._node = node;\r\n            this._stickyMode = null;\r\n            this._active = false;\r\n    \r\n            stickies.push(this);\r\n    \r\n            this.refresh();\r\n        }\r\n    \r\n        _createClass(Sticky, [{\r\n            key: 'refresh',\r\n            value: function refresh() {\r\n                if (seppuku || this._removed) return;\r\n                if (this._active) this._deactivate();\r\n    \r\n                var node = this._node;\r\n    \r\n                /*\r\n                 * 1. Save node computed props\r\n                 */\r\n                var nodeComputedStyle = getComputedStyle(node);\r\n                var nodeComputedProps = {\r\n                    top: nodeComputedStyle.top,\r\n                    display: nodeComputedStyle.display,\r\n                    marginTop: nodeComputedStyle.marginTop,\r\n                    marginBottom: nodeComputedStyle.marginBottom,\r\n                    marginLeft: nodeComputedStyle.marginLeft,\r\n                    marginRight: nodeComputedStyle.marginRight,\r\n                    cssFloat: nodeComputedStyle.cssFloat\r\n                };\r\n    \r\n                /*\r\n                 * 2. Check if the node can be activated\r\n                 */\r\n                if (isNaN(parseFloat(nodeComputedProps.top)) || nodeComputedProps.display == 'table-cell' || nodeComputedProps.display == 'none') return;\r\n    \r\n                this._active = true;\r\n    \r\n                /*\r\n                 * 3. Get necessary node parameters\r\n                 */\r\n                var referenceNode = node.parentNode;\r\n                var parentNode = shadowRootExists && referenceNode instanceof ShadowRoot ? referenceNode.host : referenceNode;\r\n                var nodeWinOffset = node.getBoundingClientRect();\r\n                var parentWinOffset = parentNode.getBoundingClientRect();\r\n                var parentComputedStyle = getComputedStyle(parentNode);\r\n    \r\n                this._parent = {\r\n                    node: parentNode,\r\n                    styles: {\r\n                        position: parentNode.style.position\r\n                    },\r\n                    offsetHeight: parentNode.offsetHeight\r\n                };\r\n                this._offsetToWindow = {\r\n                    left: nodeWinOffset.left,\r\n                    right: document.documentElement.clientWidth - nodeWinOffset.right\r\n                };\r\n                this._offsetToParent = {\r\n                    top: nodeWinOffset.top - parentWinOffset.top - parseNumeric(parentComputedStyle.borderTopWidth),\r\n                    left: nodeWinOffset.left - parentWinOffset.left - parseNumeric(parentComputedStyle.borderLeftWidth),\r\n                    right: -nodeWinOffset.right + parentWinOffset.right - parseNumeric(parentComputedStyle.borderRightWidth)\r\n                };\r\n                this._styles = {\r\n                    position: node.style.position,\r\n                    top: node.style.top,\r\n                    bottom: node.style.bottom,\r\n                    left: node.style.left,\r\n                    right: node.style.right,\r\n                    width: node.style.width,\r\n                    marginTop: node.style.marginTop,\r\n                    marginLeft: node.style.marginLeft,\r\n                    marginRight: node.style.marginRight\r\n                };\r\n    \r\n                var nodeTopValue = parseNumeric(nodeComputedProps.top);\r\n                this._limits = {\r\n                    start: nodeWinOffset.top + window.pageYOffset - nodeTopValue,\r\n                    end: parentWinOffset.top + window.pageYOffset + parentNode.offsetHeight - parseNumeric(parentComputedStyle.borderBottomWidth) - node.offsetHeight - nodeTopValue - parseNumeric(nodeComputedProps.marginBottom)\r\n                };\r\n    \r\n                /*\r\n                 * 4. Ensure that the node will be positioned relatively to the parent node\r\n                 */\r\n                var parentPosition = parentComputedStyle.position;\r\n    \r\n                if (parentPosition != 'absolute' && parentPosition != 'relative') {\r\n                    parentNode.style.position = 'relative';\r\n                }\r\n    \r\n                /*\r\n                 * 5. Recalc node position.\r\n                 *    Its important to do this before clone injection to avoid scrolling bug in Chrome.\r\n                 */\r\n                this._recalcPosition();\r\n    \r\n                /*\r\n                 * 6. Create a clone\r\n                 */\r\n                var clone = this._clone = {};\r\n                clone.node = document.createElement('div');\r\n    \r\n                // Apply styles to the clone\r\n                extend(clone.node.style, {\r\n                    width: nodeWinOffset.right - nodeWinOffset.left + 'px',\r\n                    height: nodeWinOffset.bottom - nodeWinOffset.top + 'px',\r\n                    marginTop: nodeComputedProps.marginTop,\r\n                    marginBottom: nodeComputedProps.marginBottom,\r\n                    marginLeft: nodeComputedProps.marginLeft,\r\n                    marginRight: nodeComputedProps.marginRight,\r\n                    cssFloat: nodeComputedProps.cssFloat,\r\n                    padding: 0,\r\n                    border: 0,\r\n                    borderSpacing: 0,\r\n                    fontSize: '1em',\r\n                    position: 'static'\r\n                });\r\n    \r\n                referenceNode.insertBefore(clone.node, node);\r\n                clone.docOffsetTop = getDocOffsetTop(clone.node);\r\n            }\r\n        }, {\r\n            key: '_recalcPosition',\r\n            value: function _recalcPosition() {\r\n                if (!this._active || this._removed) return;\r\n    \r\n                var stickyMode = scroll.top <= this._limits.start ? 'start' : scroll.top >= this._limits.end ? 'end' : 'middle';\r\n    \r\n                if (this._stickyMode == stickyMode) return;\r\n    \r\n                switch (stickyMode) {\r\n                    case 'start':\r\n                        extend(this._node.style, {\r\n                            position: 'absolute',\r\n                            left: this._offsetToParent.left + 'px',\r\n                            right: this._offsetToParent.right + 'px',\r\n                            top: this._offsetToParent.top + 'px',\r\n                            bottom: 'auto',\r\n                            width: 'auto',\r\n                            marginLeft: 0,\r\n                            marginRight: 0,\r\n                            marginTop: 0\r\n                        });\r\n                        break;\r\n    \r\n                    case 'middle':\r\n                        extend(this._node.style, {\r\n                            position: 'fixed',\r\n                            left: this._offsetToWindow.left + 'px',\r\n                            right: this._offsetToWindow.right + 'px',\r\n                            top: this._styles.top,\r\n                            bottom: 'auto',\r\n                            width: 'auto',\r\n                            marginLeft: 0,\r\n                            marginRight: 0,\r\n                            marginTop: 0\r\n                        });\r\n                        break;\r\n    \r\n                    case 'end':\r\n                        extend(this._node.style, {\r\n                            position: 'absolute',\r\n                            left: this._offsetToParent.left + 'px',\r\n                            right: this._offsetToParent.right + 'px',\r\n                            top: 'auto',\r\n                            bottom: 0,\r\n                            width: 'auto',\r\n                            marginLeft: 0,\r\n                            marginRight: 0\r\n                        });\r\n                        break;\r\n                }\r\n    \r\n                this._stickyMode = stickyMode;\r\n            }\r\n        }, {\r\n            key: '_fastCheck',\r\n            value: function _fastCheck() {\r\n                if (!this._active || this._removed) return;\r\n    \r\n                if (Math.abs(getDocOffsetTop(this._clone.node) - this._clone.docOffsetTop) > 1 || Math.abs(this._parent.node.offsetHeight - this._parent.offsetHeight) > 1) this.refresh();\r\n            }\r\n        }, {\r\n            key: '_deactivate',\r\n            value: function _deactivate() {\r\n                var _this = this;\r\n    \r\n                if (!this._active || this._removed) return;\r\n    \r\n                this._clone.node.parentNode.removeChild(this._clone.node);\r\n                delete this._clone;\r\n    \r\n                extend(this._node.style, this._styles);\r\n                delete this._styles;\r\n    \r\n                // Check whether elements parent node is used by other stickies.\r\n                // If not, restore parent nodes styles.\r\n                if (!stickies.some(function (sticky) {\r\n                    return sticky !== _this && sticky._parent && sticky._parent.node === _this._parent.node;\r\n                })) {\r\n                    extend(this._parent.node.style, this._parent.styles);\r\n                }\r\n                delete this._parent;\r\n    \r\n                this._stickyMode = null;\r\n                this._active = false;\r\n    \r\n                delete this._offsetToWindow;\r\n                delete this._offsetToParent;\r\n                delete this._limits;\r\n            }\r\n        }, {\r\n            key: 'remove',\r\n            value: function remove() {\r\n                var _this2 = this;\r\n    \r\n                this._deactivate();\r\n    \r\n                stickies.some(function (sticky, index) {\r\n                    if (sticky._node === _this2._node) {\r\n                        stickies.splice(index, 1);\r\n                        return true;\r\n                    }\r\n                });\r\n    \r\n                this._removed = true;\r\n            }\r\n        }]);\r\n    \r\n        return Sticky;\r\n    }();\r\n    \r\n    /*\r\n     * 5. Stickyfill API\r\n     */\r\n    \r\n    \r\n    var Stickyfill = {\r\n        stickies: stickies,\r\n        Sticky: Sticky,\r\n    \r\n        addOne: function addOne(node) {\r\n            // Check whether its a node\r\n            if (!(node instanceof HTMLElement)) {\r\n                // Maybe its a node list of some sort?\r\n                // Take first node from the list then\r\n                if (node.length && node[0]) node = node[0];else return;\r\n            }\r\n    \r\n            // Check if Stickyfill is already applied to the node\r\n            // and return existing sticky\r\n            for (var i = 0; i < stickies.length; i++) {\r\n                if (stickies[i]._node === node) return stickies[i];\r\n            }\r\n    \r\n            // Create and return new sticky\r\n            return new Sticky(node);\r\n        },\r\n        add: function add(nodeList) {\r\n            // If its a node make an array of one node\r\n            if (nodeList instanceof HTMLElement) nodeList = [nodeList];\r\n            // Check if the argument is an iterable of some sort\r\n            if (!nodeList.length) return;\r\n    \r\n            // Add every element as a sticky and return an array of created Sticky instances\r\n            var addedStickies = [];\r\n    \r\n            var _loop = function _loop(i) {\r\n                var node = nodeList[i];\r\n    \r\n                // If its not an HTMLElement  create an empty element to preserve 1-to-1\r\n                // correlation with input list\r\n                if (!(node instanceof HTMLElement)) {\r\n                    addedStickies.push(void 0);\r\n                    return 'continue';\r\n                }\r\n    \r\n                // If Stickyfill is already applied to the node\r\n                // add existing sticky\r\n                if (stickies.some(function (sticky) {\r\n                    if (sticky._node === node) {\r\n                        addedStickies.push(sticky);\r\n                        return true;\r\n                    }\r\n                })) return 'continue';\r\n    \r\n                // Create and add new sticky\r\n                addedStickies.push(new Sticky(node));\r\n            };\r\n    \r\n            for (var i = 0; i < nodeList.length; i++) {\r\n                var _ret = _loop(i);\r\n    \r\n                if (_ret === 'continue') continue;\r\n            }\r\n    \r\n            return addedStickies;\r\n        },\r\n        refreshAll: function refreshAll() {\r\n            stickies.forEach(function (sticky) {\r\n                return sticky.refresh();\r\n            });\r\n        },\r\n        removeOne: function removeOne(node) {\r\n            // Check whether its a node\r\n            if (!(node instanceof HTMLElement)) {\r\n                // Maybe its a node list of some sort?\r\n                // Take first node from the list then\r\n                if (node.length && node[0]) node = node[0];else return;\r\n            }\r\n    \r\n            // Remove the stickies bound to the nodes in the list\r\n            stickies.some(function (sticky) {\r\n                if (sticky._node === node) {\r\n                    sticky.remove();\r\n                    return true;\r\n                }\r\n            });\r\n        },\r\n        remove: function remove(nodeList) {\r\n            // If its a node make an array of one node\r\n            if (nodeList instanceof HTMLElement) nodeList = [nodeList];\r\n            // Check if the argument is an iterable of some sort\r\n            if (!nodeList.length) return;\r\n    \r\n            // Remove the stickies bound to the nodes in the list\r\n    \r\n            var _loop2 = function _loop2(i) {\r\n                var node = nodeList[i];\r\n    \r\n                stickies.some(function (sticky) {\r\n                    if (sticky._node === node) {\r\n                        sticky.remove();\r\n                        return true;\r\n                    }\r\n                });\r\n            };\r\n    \r\n            for (var i = 0; i < nodeList.length; i++) {\r\n                _loop2(i);\r\n            }\r\n        },\r\n        removeAll: function removeAll() {\r\n            while (stickies.length) {\r\n                stickies[0].remove();\r\n            }\r\n        }\r\n    };\r\n    \r\n    /*\r\n     * 6. Setup events (unless the polyfill was disabled)\r\n     */\r\n    function init() {\r\n        // Watch for scroll position changes and trigger recalc/refresh if needed\r\n        function checkScroll() {\r\n            if (window.pageXOffset != scroll.left) {\r\n                scroll.top = window.pageYOffset;\r\n                scroll.left = window.pageXOffset;\r\n    \r\n                Stickyfill.refreshAll();\r\n            } else if (window.pageYOffset != scroll.top) {\r\n                scroll.top = window.pageYOffset;\r\n                scroll.left = window.pageXOffset;\r\n    \r\n                // recalc position for all stickies\r\n                stickies.forEach(function (sticky) {\r\n                    return sticky._recalcPosition();\r\n                });\r\n            }\r\n        }\r\n    \r\n        checkScroll();\r\n        window.addEventListener('scroll', checkScroll);\r\n    \r\n        // Watch for window resizes and device orientation changes and trigger refresh\r\n        window.addEventListener('resize', Stickyfill.refreshAll);\r\n        window.addEventListener('orientationchange', Stickyfill.refreshAll);\r\n    \r\n        //Fast dirty check for layout changes every 500ms\r\n        var fastCheckTimer = void 0;\r\n    \r\n        function startFastCheckTimer() {\r\n            fastCheckTimer = setInterval(function () {\r\n                stickies.forEach(function (sticky) {\r\n                    return sticky._fastCheck();\r\n                });\r\n            }, 500);\r\n        }\r\n    \r\n        function stopFastCheckTimer() {\r\n            clearInterval(fastCheckTimer);\r\n        }\r\n    \r\n        var docHiddenKey = void 0;\r\n        var visibilityChangeEventName = void 0;\r\n    \r\n        if ('hidden' in document) {\r\n            docHiddenKey = 'hidden';\r\n            visibilityChangeEventName = 'visibilitychange';\r\n        } else if ('webkitHidden' in document) {\r\n            docHiddenKey = 'webkitHidden';\r\n            visibilityChangeEventName = 'webkitvisibilitychange';\r\n        }\r\n    \r\n        if (visibilityChangeEventName) {\r\n            if (!document[docHiddenKey]) startFastCheckTimer();\r\n    \r\n            document.addEventListener(visibilityChangeEventName, function () {\r\n                if (document[docHiddenKey]) {\r\n                    stopFastCheckTimer();\r\n                } else {\r\n                    startFastCheckTimer();\r\n                }\r\n            });\r\n        } else startFastCheckTimer();\r\n    }\r\n    \r\n    if (!seppuku) init();\r\n    \r\n    /*\r\n     * 7. Expose Stickyfill\r\n     */\r\n    if (typeof module != 'undefined' && module.exports) {\r\n        module.exports = Stickyfill;\r\n    } else {\r\n        window.Stickyfill = Stickyfill;\r\n    }\r\n    \r\n})(window, document);","import DropLab from './droplab/drop_lab';\nimport ISetter from './droplab/plugins/input_setter';\n\n// Todo: Remove this when fixing issue in input_setter plugin\nconst InputSetter = Object.assign({}, ISetter);\n\nclass CommentTypeToggle {\n  constructor(opts = {}) {\n    this.dropdownTrigger = opts.dropdownTrigger;\n    this.dropdownList = opts.dropdownList;\n    this.noteTypeInput = opts.noteTypeInput;\n    this.submitButton = opts.submitButton;\n    this.closeButton = opts.closeButton;\n    this.reopenButton = opts.reopenButton;\n  }\n\n  initDroplab() {\n    this.droplab = new DropLab();\n\n    const config = this.setConfig();\n\n    this.droplab.init(this.dropdownTrigger, this.dropdownList, [InputSetter], config);\n  }\n\n  setConfig() {\n    const config = {\n      InputSetter: [\n        {\n          input: this.noteTypeInput,\n          valueAttribute: 'data-value',\n        },\n        {\n          input: this.submitButton,\n          valueAttribute: 'data-submit-text',\n        },\n      ],\n    };\n\n    if (this.closeButton) {\n      config.InputSetter.push(\n        {\n          input: this.closeButton,\n          valueAttribute: 'data-close-text',\n        },\n        {\n          input: this.closeButton,\n          valueAttribute: 'data-close-text',\n          inputAttribute: 'data-alternative-text',\n        },\n      );\n    }\n\n    if (this.reopenButton) {\n      config.InputSetter.push(\n        {\n          input: this.reopenButton,\n          valueAttribute: 'data-reopen-text',\n        },\n        {\n          input: this.reopenButton,\n          valueAttribute: 'data-reopen-text',\n          inputAttribute: 'data-alternative-text',\n        },\n      );\n    }\n\n    return config;\n  }\n}\n\nexport default CommentTypeToggle;\n","/* eslint-disable no-restricted-properties, func-names, no-var, camelcase,\nno-unused-expressions, one-var, default-case,\nprefer-template, consistent-return, no-alert, no-return-assign,\nno-param-reassign, prefer-arrow-callback, no-else-return, vars-on-top,\nno-unused-vars, no-shadow, no-useless-escape, class-methods-use-this */\n\n/* global ResolveService */\n/* global mrRefreshWidgetUrl */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport Cookies from 'js-cookie';\nimport Autosize from 'autosize';\nimport 'vendor/jquery.caret'; // required by jquery.atwho\nimport 'vendor/jquery.atwho';\nimport AjaxCache from '~/lib/utils/ajax_cache';\nimport Vue from 'vue';\nimport syntaxHighlight from '~/syntax_highlight';\nimport { GlSkeletonLoading } from '@gitlab/ui';\nimport axios from './lib/utils/axios_utils';\nimport { getLocationHash } from './lib/utils/url_utility';\nimport Flash from './flash';\nimport { defaultAutocompleteConfig } from './gfm_auto_complete';\nimport CommentTypeToggle from './comment_type_toggle';\nimport GLForm from './gl_form';\nimport loadAwardsHandler from './awards_handler';\nimport Autosave from './autosave';\nimport TaskList from './task_list';\nimport {\n  isInViewport,\n  getPagePath,\n  scrollToElement,\n  isMetaKey,\n  isInMRPage,\n} from './lib/utils/common_utils';\nimport imageDiffHelper from './image_diff/helpers/index';\nimport { localTimeAgo } from './lib/utils/datetime_utility';\n\nwindow.autosize = Autosize;\n\nfunction normalizeNewlines(str) {\n  return str.replace(/\\r\\n/g, '\\n');\n}\n\nconst MAX_VISIBLE_COMMIT_LIST_COUNT = 3;\nconst REGEX_QUICK_ACTIONS = /^\\/\\w+.*$/gm;\n\nexport default class Notes {\n  static initialize(notes_url, note_ids, last_fetched_at, view, enableGFM) {\n    if (!this.instance) {\n      this.instance = new Notes(notes_url, note_ids, last_fetched_at, view, enableGFM);\n    }\n  }\n\n  static getInstance() {\n    return this.instance;\n  }\n\n  constructor(notes_url, note_ids, last_fetched_at, view, enableGFM = defaultAutocompleteConfig) {\n    this.updateTargetButtons = this.updateTargetButtons.bind(this);\n    this.updateComment = this.updateComment.bind(this);\n    this.visibilityChange = this.visibilityChange.bind(this);\n    this.cancelDiscussionForm = this.cancelDiscussionForm.bind(this);\n    this.onAddDiffNote = this.onAddDiffNote.bind(this);\n    this.onAddImageDiffNote = this.onAddImageDiffNote.bind(this);\n    this.setupDiscussionNoteForm = this.setupDiscussionNoteForm.bind(this);\n    this.onReplyToDiscussionNote = this.onReplyToDiscussionNote.bind(this);\n    this.removeNote = this.removeNote.bind(this);\n    this.cancelEdit = this.cancelEdit.bind(this);\n    this.updateNote = this.updateNote.bind(this);\n    this.addDiscussionNote = this.addDiscussionNote.bind(this);\n    this.addNoteError = this.addNoteError.bind(this);\n    this.addNote = this.addNote.bind(this);\n    this.resetMainTargetForm = this.resetMainTargetForm.bind(this);\n    this.refresh = this.refresh.bind(this);\n    this.keydownNoteText = this.keydownNoteText.bind(this);\n    this.toggleCommitList = this.toggleCommitList.bind(this);\n    this.postComment = this.postComment.bind(this);\n    this.clearFlashWrapper = this.clearFlash.bind(this);\n    this.onHashChange = this.onHashChange.bind(this);\n\n    this.notes_url = notes_url;\n    this.note_ids = note_ids;\n    this.enableGFM = enableGFM;\n    // Used to keep track of updated notes while people are editing things\n    this.updatedNotesTrackingMap = {};\n    this.last_fetched_at = last_fetched_at;\n    this.noteable_url = document.URL;\n    this.notesCountBadge ||\n      (this.notesCountBadge = $('.issuable-details').find('.notes-tab .badge'));\n    this.basePollingInterval = 15000;\n    this.maxPollingSteps = 4;\n\n    this.$wrapperEl = isInMRPage() ? $(document).find('.diffs') : $(document);\n    this.cleanBinding();\n    this.addBinding();\n    this.setPollingInterval();\n    this.setupMainTargetNoteForm(enableGFM);\n    this.taskList = new TaskList({\n      dataType: 'note',\n      fieldName: 'note',\n      selector: '.notes',\n    });\n    this.collapseLongCommitList();\n    this.setViewType(view);\n\n    // We are in the Merge Requests page so we need another edit form for Changes tab\n    if (getPagePath(1) === 'merge_requests') {\n      $('.note-edit-form')\n        .clone()\n        .addClass('mr-note-edit-form')\n        .insertAfter('.note-edit-form');\n    }\n\n    const hash = getLocationHash();\n    const $anchor = hash && document.getElementById(hash);\n\n    if ($anchor) {\n      this.loadLazyDiff({ currentTarget: $anchor });\n    }\n  }\n\n  setViewType(view) {\n    this.view = Cookies.get('diff_view') || view;\n  }\n\n  addBinding() {\n    // Edit note link\n    this.$wrapperEl.on('click', '.js-note-edit', this.showEditForm.bind(this));\n    this.$wrapperEl.on('click', '.note-edit-cancel', this.cancelEdit);\n    // Reopen and close actions for Issue/MR combined with note form submit\n    this.$wrapperEl.on('click', '.js-comment-submit-button', this.postComment);\n    this.$wrapperEl.on('click', '.js-comment-save-button', this.updateComment);\n    this.$wrapperEl.on('keyup input', '.js-note-text', this.updateTargetButtons);\n    // resolve a discussion\n    this.$wrapperEl.on('click', '.js-comment-resolve-button', this.postComment);\n    // remove a note (in general)\n    this.$wrapperEl.on('click', '.js-note-delete', this.removeNote);\n    // delete note attachment\n    this.$wrapperEl.on('click', '.js-note-attachment-delete', this.removeAttachment);\n    // update the file name when an attachment is selected\n    this.$wrapperEl.on('change', '.js-note-attachment-input', this.updateFormAttachment);\n    // reply to diff/discussion notes\n    this.$wrapperEl.on('click', '.js-discussion-reply-button', this.onReplyToDiscussionNote);\n    // add diff note\n    this.$wrapperEl.on('click', '.js-add-diff-note-button', this.onAddDiffNote);\n    // add diff note for images\n    this.$wrapperEl.on('click', '.js-add-image-diff-note-button', this.onAddImageDiffNote);\n    // hide diff note form\n    this.$wrapperEl.on('click', '.js-close-discussion-note-form', this.cancelDiscussionForm);\n    // toggle commit list\n    this.$wrapperEl.on('click', '.system-note-commit-list-toggler', this.toggleCommitList);\n\n    this.$wrapperEl.on('click', '.js-toggle-lazy-diff', this.loadLazyDiff);\n    this.$wrapperEl.on(\n      'click',\n      '.js-toggle-lazy-diff-retry-button',\n      this.onClickRetryLazyLoad.bind(this),\n    );\n\n    // fetch notes when tab becomes visible\n    this.$wrapperEl.on('visibilitychange', this.visibilityChange);\n    // when issue status changes, we need to refresh data\n    this.$wrapperEl.on('issuable:change', this.refresh);\n    // ajax:events that happen on Form when actions like Reopen, Close are performed on Issues and MRs.\n    this.$wrapperEl.on('ajax:success', '.js-main-target-form', this.addNote);\n    this.$wrapperEl.on('ajax:success', '.js-discussion-note-form', this.addDiscussionNote);\n    this.$wrapperEl.on('ajax:success', '.js-main-target-form', this.resetMainTargetForm);\n    this.$wrapperEl.on(\n      'ajax:complete',\n      '.js-main-target-form',\n      this.reenableTargetFormSubmitButton,\n    );\n    // when a key is clicked on the notes\n    this.$wrapperEl.on('keydown', '.js-note-text', this.keydownNoteText);\n    // When the URL fragment/hash has changed, `#note_xxx`\n    $(window).on('hashchange', this.onHashChange);\n  }\n\n  cleanBinding() {\n    this.$wrapperEl.off('click', '.js-note-edit');\n    this.$wrapperEl.off('click', '.note-edit-cancel');\n    this.$wrapperEl.off('click', '.js-note-delete');\n    this.$wrapperEl.off('click', '.js-note-attachment-delete');\n    this.$wrapperEl.off('click', '.js-discussion-reply-button');\n    this.$wrapperEl.off('click', '.js-add-diff-note-button');\n    this.$wrapperEl.off('click', '.js-add-image-diff-note-button');\n    this.$wrapperEl.off('visibilitychange');\n    this.$wrapperEl.off('keyup input', '.js-note-text');\n    this.$wrapperEl.off('click', '.js-note-target-reopen');\n    this.$wrapperEl.off('click', '.js-note-target-close');\n    this.$wrapperEl.off('keydown', '.js-note-text');\n    this.$wrapperEl.off('click', '.js-comment-resolve-button');\n    this.$wrapperEl.off('click', '.system-note-commit-list-toggler');\n    this.$wrapperEl.off('click', '.js-toggle-lazy-diff');\n    this.$wrapperEl.off('click', '.js-toggle-lazy-diff-retry-button');\n    this.$wrapperEl.off('ajax:success', '.js-main-target-form');\n    this.$wrapperEl.off('ajax:success', '.js-discussion-note-form');\n    this.$wrapperEl.off('ajax:complete', '.js-main-target-form');\n    $(window).off('hashchange', this.onHashChange);\n  }\n\n  static initCommentTypeToggle(form) {\n    const dropdownTrigger = form.querySelector('.js-comment-type-dropdown .dropdown-toggle');\n    const dropdownList = form.querySelector('.js-comment-type-dropdown .dropdown-menu');\n    const noteTypeInput = form.querySelector('#note_type');\n    const submitButton = form.querySelector('.js-comment-type-dropdown .js-comment-submit-button');\n    const closeButton = form.querySelector('.js-note-target-close');\n    const reopenButton = form.querySelector('.js-note-target-reopen');\n\n    const commentTypeToggle = new CommentTypeToggle({\n      dropdownTrigger,\n      dropdownList,\n      noteTypeInput,\n      submitButton,\n      closeButton,\n      reopenButton,\n    });\n\n    commentTypeToggle.initDroplab();\n  }\n\n  keydownNoteText(e) {\n    var $textarea,\n      discussionNoteForm,\n      editNote,\n      myLastNote,\n      myLastNoteEditBtn,\n      newText,\n      originalText;\n    if (isMetaKey(e)) {\n      return;\n    }\n\n    $textarea = $(e.target);\n    // Edit previous note when UP arrow is hit\n    switch (e.which) {\n      case 38:\n        if ($textarea.val() !== '') {\n          return;\n        }\n        myLastNote = $(\n          `li.note[data-author-id='${gon.current_user_id}'][data-editable]:last`,\n          $textarea.closest('.note, .notes_holder, #notes'),\n        );\n        if (myLastNote.length) {\n          myLastNoteEditBtn = myLastNote.find('.js-note-edit');\n          return myLastNoteEditBtn.trigger('click', [true, myLastNote]);\n        }\n        break;\n      // Cancel creating diff note or editing any note when ESCAPE is hit\n      case 27:\n        discussionNoteForm = $textarea.closest('.js-discussion-note-form');\n        if (discussionNoteForm.length) {\n          if ($textarea.val() !== '') {\n            if (!window.confirm('Are you sure you want to cancel creating this comment?')) {\n              return;\n            }\n          }\n          this.removeDiscussionNoteForm(discussionNoteForm);\n          return;\n        }\n        editNote = $textarea.closest('.note');\n        if (editNote.length) {\n          originalText = $textarea.closest('form').data('originalNote');\n          newText = $textarea.val();\n          if (originalText !== newText) {\n            if (!window.confirm('Are you sure you want to cancel editing this comment?')) {\n              return;\n            }\n          }\n          return this.removeNoteEditForm(editNote);\n        }\n    }\n  }\n\n  initRefresh() {\n    if (Notes.interval) {\n      clearInterval(Notes.interval);\n    }\n    return (Notes.interval = setInterval(\n      (function(_this) {\n        return function() {\n          return _this.refresh();\n        };\n      })(this),\n      this.pollingInterval,\n    ));\n  }\n\n  refresh() {\n    if (!document.hidden) {\n      return this.getContent();\n    }\n  }\n\n  getContent() {\n    if (this.refreshing) {\n      return;\n    }\n\n    this.refreshing = true;\n\n    axios\n      .get(`${this.notes_url}?html=true`, {\n        headers: {\n          'X-Last-Fetched-At': this.last_fetched_at,\n        },\n      })\n      .then(({ data }) => {\n        const { notes } = data;\n        this.last_fetched_at = data.last_fetched_at;\n        this.setPollingInterval(data.notes.length);\n        $.each(notes, (i, note) => this.renderNote(note));\n\n        this.refreshing = false;\n      })\n      .catch(() => {\n        this.refreshing = false;\n      });\n  }\n\n  /**\n   * Increase @pollingInterval up to 120 seconds on every function call,\n   * if `shouldReset` has a truthy value, 'null' or 'undefined' the variable\n   * will reset to @basePollingInterval.\n   *\n   * Note: this function is used to gradually increase the polling interval\n   * if there aren't new notes coming from the server\n   */\n  setPollingInterval(shouldReset) {\n    var nthInterval;\n    if (shouldReset == null) {\n      shouldReset = true;\n    }\n    nthInterval = this.basePollingInterval * Math.pow(2, this.maxPollingSteps - 1);\n    if (shouldReset) {\n      this.pollingInterval = this.basePollingInterval;\n    } else if (this.pollingInterval < nthInterval) {\n      this.pollingInterval *= 2;\n    }\n    return this.initRefresh();\n  }\n\n  handleQuickActions(noteEntity) {\n    var votesBlock;\n    if (noteEntity.commands_changes) {\n      if ('merge' in noteEntity.commands_changes) {\n        Notes.checkMergeRequestStatus();\n      }\n\n      if ('emoji_award' in noteEntity.commands_changes) {\n        votesBlock = $('.js-awards-block').eq(0);\n\n        loadAwardsHandler()\n          .then(awardsHandler => {\n            awardsHandler.addAwardToEmojiBar(votesBlock, noteEntity.commands_changes.emoji_award);\n            awardsHandler.scrollToAwards();\n          })\n          .catch(() => {\n            // ignore\n          });\n      }\n    }\n  }\n\n  setupNewNote($note) {\n    // Update datetime format on the recent note\n    localTimeAgo($note.find('.js-timeago'), false);\n\n    this.collapseLongCommitList();\n    this.taskList.init();\n\n    // This stops the note highlight, #note_xxx`, from being removed after real time update\n    // The `:target` selector does not re-evaluate after we replace element in the DOM\n    Notes.updateNoteTargetSelector($note);\n    this.$noteToCleanHighlight = $note;\n  }\n\n  onHashChange() {\n    if (this.$noteToCleanHighlight) {\n      Notes.updateNoteTargetSelector(this.$noteToCleanHighlight);\n    }\n\n    this.$noteToCleanHighlight = null;\n  }\n\n  static updateNoteTargetSelector($note) {\n    const hash = getLocationHash();\n    // Needs to be an explicit true/false for the jQuery `toggleClass(force)`\n    const addTargetClass = Boolean(hash && $note.filter(`#${hash}`).length > 0);\n    $note.toggleClass('target', addTargetClass);\n  }\n\n  /**\n   * Render note in main comments area.\n   *\n   * Note: for rendering inline notes use renderDiscussionNote\n   */\n  renderNote(noteEntity, $form, $notesList = $('.main-notes-list')) {\n    if (noteEntity.discussion_html) {\n      return this.renderDiscussionNote(noteEntity, $form);\n    }\n\n    if (!noteEntity.valid) {\n      if (noteEntity.errors && noteEntity.errors.commands_only) {\n        if (noteEntity.commands_changes && Object.keys(noteEntity.commands_changes).length > 0) {\n          $notesList.find('.system-note.being-posted').remove();\n        }\n        this.addFlash(noteEntity.errors.commands_only, 'notice', this.parentTimeline.get(0));\n        this.refresh();\n      }\n      return;\n    }\n\n    const $note = $notesList.find(`#note_${noteEntity.id}`);\n    if (Notes.isNewNote(noteEntity, this.note_ids)) {\n      if (isInMRPage()) {\n        return;\n      }\n\n      this.note_ids.push(noteEntity.id);\n\n      if ($notesList.length) {\n        $notesList.find('.system-note.being-posted').remove();\n      }\n      const $newNote = Notes.animateAppendNote(noteEntity.html, $notesList);\n\n      this.setupNewNote($newNote);\n      this.refresh();\n      return this.updateNotesCount(1);\n    } else if (Notes.isUpdatedNote(noteEntity, $note)) {\n      // The server can send the same update multiple times so we need to make sure to only update once per actual update.\n      const isEditing = $note.hasClass('is-editing');\n      const initialContent = normalizeNewlines(\n        $note\n          .find('.original-note-content')\n          .text()\n          .trim(),\n      );\n      const $textarea = $note.find('.js-note-text');\n      const currentContent = $textarea.val();\n      // There can be CRLF vs LF mismatches if we don't sanitize and compare the same way\n      const sanitizedNoteNote = normalizeNewlines(noteEntity.note);\n      const isTextareaUntouched =\n        currentContent === initialContent || currentContent === sanitizedNoteNote;\n\n      if (isEditing && isTextareaUntouched) {\n        $textarea.val(noteEntity.note);\n        this.updatedNotesTrackingMap[noteEntity.id] = noteEntity;\n      } else if (isEditing && !isTextareaUntouched) {\n        this.putConflictEditWarningInPlace(noteEntity, $note);\n        this.updatedNotesTrackingMap[noteEntity.id] = noteEntity;\n      } else {\n        const $updatedNote = Notes.animateUpdateNote(noteEntity.html, $note);\n        this.setupNewNote($updatedNote);\n      }\n    }\n  }\n\n  isParallelView() {\n    return Cookies.get('diff_view') === 'parallel';\n  }\n\n  /**\n   * Render note in discussion area. To render inline notes use renderDiscussionNote.\n   */\n  renderDiscussionNote(noteEntity, $form) {\n    var discussionContainer, form, row, lineType, diffAvatarContainer;\n\n    if (!Notes.isNewNote(noteEntity, this.note_ids)) {\n      return;\n    }\n    this.note_ids.push(noteEntity.id);\n\n    form = $form || $(`.js-discussion-note-form[data-discussion-id=\"${noteEntity.discussion_id}\"]`);\n    row =\n      form.length || !noteEntity.discussion_line_code\n        ? form.closest('tr')\n        : $(`#${noteEntity.discussion_line_code}`);\n\n    if (noteEntity.on_image) {\n      row = form;\n    }\n\n    lineType = this.isParallelView() ? form.find('#line_type').val() : 'old';\n    diffAvatarContainer = row\n      .prevAll('.line_holder')\n      .first()\n      .find('.js-avatar-container.' + lineType + '_line');\n    // is this the first note of discussion?\n    discussionContainer = $(`.notes[data-discussion-id=\"${noteEntity.discussion_id}\"]`);\n    if (!discussionContainer.length) {\n      discussionContainer = form.closest('.discussion').find('.notes');\n    }\n    if (discussionContainer.length === 0) {\n      if (noteEntity.diff_discussion_html) {\n        var $discussion = $(noteEntity.diff_discussion_html).renderGFM();\n\n        if (!this.isParallelView() || row.hasClass('js-temp-notes-holder') || noteEntity.on_image) {\n          // insert the note and the reply button after the temp row\n          row.after($discussion);\n        } else {\n          // Merge new discussion HTML in\n          var $notes = $discussion.find(`.notes[data-discussion-id=\"${noteEntity.discussion_id}\"]`);\n          var contentContainerClass =\n            '.' +\n            $notes\n              .closest('.notes_content')\n              .attr('class')\n              .split(' ')\n              .join('.');\n\n          row\n            .find(contentContainerClass + ' .content')\n            .append($notes.closest('.content').children());\n        }\n      } else {\n        Notes.animateAppendNote(noteEntity.discussion_html, $('.main-notes-list'));\n      }\n    } else {\n      // append new note to all matching discussions\n      Notes.animateAppendNote(noteEntity.html, discussionContainer);\n    }\n\n    if (typeof gl.diffNotesCompileComponents !== 'undefined' && noteEntity.discussion_resolvable) {\n      gl.diffNotesCompileComponents();\n\n      this.renderDiscussionAvatar(diffAvatarContainer, noteEntity);\n    }\n\n    localTimeAgo($('.js-timeago'), false);\n    Notes.checkMergeRequestStatus();\n    return this.updateNotesCount(1);\n  }\n\n  getLineHolder(changesDiscussionContainer) {\n    return $(changesDiscussionContainer)\n      .closest('.notes_holder')\n      .prevAll('.line_holder')\n      .first()\n      .get(0);\n  }\n\n  renderDiscussionAvatar(diffAvatarContainer, noteEntity) {\n    var avatarHolder = diffAvatarContainer.find('.diff-comment-avatar-holders');\n\n    if (!avatarHolder.length) {\n      avatarHolder = document.createElement('diff-note-avatars');\n      avatarHolder.setAttribute('discussion-id', noteEntity.discussion_id);\n\n      diffAvatarContainer.append(avatarHolder);\n\n      gl.diffNotesCompileComponents();\n    }\n  }\n\n  /**\n   * Called in response the main target form has been successfully submitted.\n   *\n   * Removes any errors.\n   * Resets text and preview.\n   * Resets buttons.\n   */\n  resetMainTargetForm(e) {\n    var form;\n    form = $('.js-main-target-form');\n    // remove validation errors\n    form.find('.js-errors').remove();\n    // reset text and preview\n    form.find('.js-md-write-button').click();\n    form\n      .find('.js-note-text')\n      .val('')\n      .trigger('input');\n    form\n      .find('.js-note-text')\n      .data('autosave')\n      .reset();\n\n    var event = document.createEvent('Event');\n    event.initEvent('autosize:update', true, false);\n    form.find('.js-autosize')[0].dispatchEvent(event);\n\n    this.updateTargetButtons(e);\n  }\n\n  reenableTargetFormSubmitButton() {\n    var form;\n    form = $('.js-main-target-form');\n    return form.find('.js-note-text').trigger('input');\n  }\n\n  /**\n   * Shows the main form and does some setup on it.\n   *\n   * Sets some hidden fields in the form.\n   */\n  setupMainTargetNoteForm(enableGFM) {\n    var form;\n    // find the form\n    form = $('.js-new-note-form');\n    // Set a global clone of the form for later cloning\n    this.formClone = form.clone();\n    // show the form\n    this.setupNoteForm(form, enableGFM);\n    // fix classes\n    form.removeClass('js-new-note-form');\n    form.addClass('js-main-target-form');\n    form.find('#note_line_code').remove();\n    form.find('#note_position').remove();\n    form.find('#note_type').val('');\n    form.find('#note_project_id').remove();\n    form.find('#in_reply_to_discussion_id').remove();\n    form\n      .find('.js-comment-resolve-button')\n      .closest('comment-and-resolve-btn')\n      .remove();\n    this.parentTimeline = form.parents('.timeline');\n\n    if (form.length) {\n      Notes.initCommentTypeToggle(form.get(0));\n    }\n  }\n\n  /**\n   * General note form setup.\n   *\n   * deactivates the submit button when text is empty\n   * hides the preview button when text is empty\n   * set up GFM auto complete\n   * show the form\n   */\n  setupNoteForm(form, enableGFM = defaultAutocompleteConfig) {\n    var textarea, key;\n    this.glForm = new GLForm(form, enableGFM);\n    textarea = form.find('.js-note-text');\n    key = [\n      'Note',\n      form.find('#note_noteable_type').val(),\n      form.find('#note_noteable_id').val(),\n      form.find('#note_commit_id').val(),\n      form.find('#note_type').val(),\n      form.find('#note_project_id').val(),\n      form.find('#in_reply_to_discussion_id').val(),\n\n      // LegacyDiffNote\n      form.find('#note_line_code').val(),\n\n      // DiffNote\n      form.find('#note_position').val(),\n    ];\n    return new Autosave(textarea, key);\n  }\n\n  /**\n   * Called in response to the new note form being submitted\n   *\n   * Adds new note to list.\n   */\n  addNote($form, note) {\n    return this.renderNote(note);\n  }\n\n  addNoteError($form) {\n    let formParentTimeline;\n    if ($form.hasClass('js-main-target-form')) {\n      formParentTimeline = $form.parents('.timeline');\n    } else if ($form.hasClass('js-discussion-note-form')) {\n      formParentTimeline = $form.closest('.discussion-notes').find('.notes');\n    }\n    return this.addFlash(\n      'Your comment could not be submitted! Please check your network connection and try again.',\n      'alert',\n      formParentTimeline.get(0),\n    );\n  }\n\n  updateNoteError($parentTimeline) {\n    // eslint-disable-next-line no-new\n    new Flash(\n      'Your comment could not be updated! Please check your network connection and try again.',\n    );\n  }\n\n  /**\n   * Called in response to the new note form being submitted\n   *\n   * Adds new note to list.\n   */\n  addDiscussionNote($form, note, isNewDiffComment) {\n    if ($form.attr('data-resolve-all') != null) {\n      var projectPath = $form.data('projectPath');\n      var discussionId = $form.data('discussionId');\n      var mergeRequestId = $form.data('noteableIid');\n\n      if (ResolveService != null) {\n        ResolveService.toggleResolveForDiscussion(mergeRequestId, discussionId);\n      }\n    }\n\n    this.renderNote(note, $form);\n    // cleanup after successfully creating a diff/discussion note\n    if (isNewDiffComment) {\n      this.removeDiscussionNoteForm($form);\n    }\n  }\n\n  /**\n   * Called in response to the edit note form being submitted\n   *\n   * Updates the current note field.\n   */\n  updateNote(noteEntity, $targetNote) {\n    var $noteEntityEl, $note_li;\n    // Convert returned HTML to a jQuery object so we can modify it further\n    $noteEntityEl = $(noteEntity.html);\n    this.revertNoteEditForm($targetNote);\n    $noteEntityEl.renderGFM();\n    // Find the note's `li` element by ID and replace it with the updated HTML\n    $note_li = $('.note-row-' + noteEntity.id);\n\n    $note_li.replaceWith($noteEntityEl);\n    this.setupNewNote($noteEntityEl);\n\n    if (typeof gl.diffNotesCompileComponents !== 'undefined') {\n      gl.diffNotesCompileComponents();\n    }\n  }\n\n  checkContentToAllowEditing($el) {\n    var initialContent = $el\n      .find('.original-note-content')\n      .text()\n      .trim();\n    var currentContent = $el.find('.js-note-text').val();\n    var isAllowed = true;\n\n    if (currentContent === initialContent) {\n      this.removeNoteEditForm($el);\n    } else {\n      var $buttons = $el.find('.note-form-actions');\n      var isWidgetVisible = isInViewport($el.get(0));\n\n      if (!isWidgetVisible) {\n        scrollToElement($el);\n      }\n\n      $el.find('.js-finish-edit-warning').show();\n      isAllowed = false;\n    }\n\n    return isAllowed;\n  }\n\n  /**\n   * Called in response to clicking the edit note link\n   *\n   * Replaces the note text with the note edit form\n   * Adds a data attribute to the form with the original content of the note for cancellations\n   */\n  showEditForm(e, scrollTo, myLastNote) {\n    e.preventDefault();\n\n    var $target = $(e.target);\n    var $editForm = $(this.getEditFormSelector($target));\n    var $note = $target.closest('.note');\n    var $currentlyEditing = $('.note.is-editing:visible');\n\n    if ($currentlyEditing.length) {\n      var isEditAllowed = this.checkContentToAllowEditing($currentlyEditing);\n\n      if (!isEditAllowed) {\n        return;\n      }\n    }\n\n    $note.find('.js-note-attachment-delete').show();\n    $editForm.addClass('current-note-edit-form');\n    $note.addClass('is-editing');\n    this.putEditFormInPlace($target);\n  }\n\n  /**\n   * Called in response to clicking the edit note link\n   *\n   * Hides edit form and restores the original note text to the editor textarea.\n   */\n  cancelEdit(e) {\n    e.preventDefault();\n    const $target = $(e.target);\n    const $note = $target.closest('.note');\n    const noteId = $note.attr('data-note-id');\n\n    this.revertNoteEditForm($target);\n\n    if (this.updatedNotesTrackingMap[noteId]) {\n      const $newNote = $(this.updatedNotesTrackingMap[noteId].html);\n      $note.replaceWith($newNote);\n      this.setupNewNote($newNote);\n      // Now that we have taken care of the update, clear it out\n      delete this.updatedNotesTrackingMap[noteId];\n    } else {\n      $note.find('.js-finish-edit-warning').hide();\n      this.removeNoteEditForm($note);\n    }\n  }\n\n  revertNoteEditForm($target) {\n    $target = $target || $('.note.is-editing:visible');\n    var selector = this.getEditFormSelector($target);\n    var $editForm = $(selector);\n\n    $editForm.insertBefore('.diffs');\n    $editForm.find('.js-comment-save-button').enable();\n    $editForm.find('.js-finish-edit-warning').hide();\n  }\n\n  getEditFormSelector($el) {\n    var selector = '.note-edit-form:not(.mr-note-edit-form)';\n\n    if ($el.parents('#diffs').length) {\n      selector = '.note-edit-form.mr-note-edit-form';\n    }\n\n    return selector;\n  }\n\n  removeNoteEditForm($note) {\n    var form = $note.find('.diffs .current-note-edit-form');\n\n    $note.removeClass('is-editing');\n    form.removeClass('current-note-edit-form');\n    form.find('.js-finish-edit-warning').hide();\n    // Replace markdown textarea text with original note text.\n    return form.find('.js-note-text').val(form.find('form.edit-note').data('originalNote'));\n  }\n\n  /**\n   * Called in response to deleting a note of any kind.\n   *\n   * Removes the actual note from view.\n   * Removes the whole discussion if the last note is being removed.\n   */\n  removeNote(e) {\n    var noteElId, noteId, dataNoteId, $note, lineHolder;\n    $note = $(e.currentTarget).closest('.note');\n    noteElId = $note.attr('id');\n    noteId = $note.attr('data-note-id');\n    lineHolder = $(e.currentTarget)\n      .closest('.notes[data-discussion-id]')\n      .closest('.notes_holder')\n      .prev('.line_holder');\n    $(`.note[id=\"${noteElId}\"]`).each(\n      (function(_this) {\n        // A same note appears in the \"Discussion\" and in the \"Changes\" tab, we have\n        // to remove all. Using $('.note[id='noteId']') ensure we get all the notes,\n        // where $('#noteId') would return only one.\n        return function(i, el) {\n          var $note, $notes;\n          $note = $(el);\n          $notes = $note.closest('.discussion-notes');\n          const discussionId = $('.notes', $notes).data('discussionId');\n\n          if (typeof gl.diffNotesCompileComponents !== 'undefined') {\n            if (gl.diffNoteApps[noteElId]) {\n              gl.diffNoteApps[noteElId].$destroy();\n            }\n          }\n\n          $note.remove();\n\n          // check if this is the last note for this line\n          if ($notes.find('.note').length === 0) {\n            var notesTr = $notes.closest('tr');\n\n            // \"Discussions\" tab\n            $notes.closest('.timeline-entry').remove();\n\n            $(`.js-diff-avatars-${discussionId}`).trigger('remove.vue');\n\n            // The notes tr can contain multiple lists of notes, like on the parallel diff\n            // notesTr does not exist for image diffs\n            if (notesTr.find('.discussion-notes').length > 1 || notesTr.length === 0) {\n              const $diffFile = $notes.closest('.diff-file');\n              if ($diffFile.length > 0) {\n                const removeBadgeEvent = new CustomEvent('removeBadge.imageDiff', {\n                  detail: {\n                    // badgeNumber's start with 1 and index starts with 0\n                    badgeNumber: $notes.index() + 1,\n                  },\n                });\n\n                $diffFile[0].dispatchEvent(removeBadgeEvent);\n              }\n\n              $notes.remove();\n            } else if (notesTr.length > 0) {\n              notesTr.remove();\n            }\n          }\n        };\n      })(this),\n    );\n\n    Notes.checkMergeRequestStatus();\n    return this.updateNotesCount(-1);\n  }\n\n  /**\n   * Called in response to clicking the delete attachment link\n   *\n   * Removes the attachment wrapper view, including image tag if it exists\n   * Resets the note editing form\n   */\n  removeAttachment() {\n    const $note = $(this).closest('.note');\n    $note.find('.note-attachment').remove();\n    $note.find('.note-body > .note-text').show();\n    $note.find('.note-header').show();\n    return $note.find('.diffs .current-note-edit-form').remove();\n  }\n\n  /**\n   * Called when clicking on the \"reply\" button for a diff line.\n   *\n   * Shows the note form below the notes.\n   */\n  onReplyToDiscussionNote(e) {\n    this.replyToDiscussionNote(e.target);\n  }\n\n  replyToDiscussionNote(target) {\n    var form, replyLink;\n    form = this.cleanForm(this.formClone.clone());\n    replyLink = $(target).closest('.js-discussion-reply-button');\n    // insert the form after the button\n    replyLink\n      .closest('.discussion-reply-holder')\n      .hide()\n      .after(form);\n    // show the form\n    return this.setupDiscussionNoteForm(replyLink, form);\n  }\n\n  /**\n   * Shows the diff or discussion form and does some setup on it.\n   *\n   * Sets some hidden fields in the form.\n   *\n   * Note: dataHolder must have the \"discussionId\" and \"lineCode\" data attributes set.\n   */\n  setupDiscussionNoteForm(dataHolder, form) {\n    // set up note target\n    let diffFileData = dataHolder.closest('.text-file');\n\n    if (diffFileData.length === 0) {\n      diffFileData = dataHolder.closest('.image');\n    }\n\n    var discussionID = dataHolder.data('discussionId');\n\n    if (discussionID) {\n      form.attr('data-discussion-id', discussionID);\n      form.find('#in_reply_to_discussion_id').val(discussionID);\n    }\n\n    form.find('#note_project_id').val(dataHolder.data('discussionProjectId'));\n\n    form.attr('data-line-code', dataHolder.data('lineCode'));\n    form.find('#line_type').val(dataHolder.data('lineType'));\n\n    form.find('#note_noteable_type').val(diffFileData.data('noteableType'));\n    form.find('#note_noteable_id').val(diffFileData.data('noteableId'));\n    form.find('#note_commit_id').val(diffFileData.data('commitId'));\n\n    form.find('#note_type').val(dataHolder.data('noteType'));\n\n    // LegacyDiffNote\n    form.find('#note_line_code').val(dataHolder.data('lineCode'));\n\n    // DiffNote\n    form.find('#note_position').val(dataHolder.attr('data-position'));\n\n    form\n      .find('.js-close-discussion-note-form')\n      .show()\n      .removeClass('hide');\n    form.find('.js-note-target-close').remove();\n    form.find('.js-note-new-discussion').remove();\n    this.setupNoteForm(form);\n\n    form.removeClass('js-main-target-form').addClass('discussion-form js-discussion-note-form');\n\n    if (typeof gl.diffNotesCompileComponents !== 'undefined') {\n      var $commentBtn = form.find('comment-and-resolve-btn');\n      $commentBtn.attr(':discussion-id', `'${discussionID}'`);\n\n      gl.diffNotesCompileComponents();\n    }\n\n    form.find('.js-note-text').focus();\n    form.find('.js-comment-resolve-button').attr('data-discussion-id', discussionID);\n  }\n\n  /**\n   * Called when clicking on the \"add a comment\" button on the side of a diff line.\n   *\n   * Inserts a temporary row for the form below the line.\n   * Sets up the form and shows it.\n   */\n  onAddDiffNote(e) {\n    e.preventDefault();\n    const link = e.currentTarget || e.target;\n    const $link = $(link);\n    const showReplyInput = !$link.hasClass('js-diff-comment-avatar');\n    this.toggleDiffNote({\n      target: $link,\n      lineType: link.dataset.lineType,\n      showReplyInput,\n    });\n  }\n\n  onAddImageDiffNote(e) {\n    const $link = $(e.currentTarget || e.target);\n    const $diffFile = $link.closest('.diff-file');\n\n    const clickEvent = new CustomEvent('click.imageDiff', {\n      detail: e,\n    });\n\n    $diffFile[0].dispatchEvent(clickEvent);\n\n    // Set up comment form\n    let newForm;\n    const $noteContainer = $link.closest('.diff-viewer').find('.note-container');\n    const $form = $noteContainer.find('> .discussion-form');\n\n    if ($form.length === 0) {\n      newForm = this.cleanForm(this.formClone.clone());\n      newForm.appendTo($noteContainer);\n    } else {\n      newForm = $form;\n    }\n\n    this.setupDiscussionNoteForm($link, newForm);\n  }\n\n  toggleDiffNote({ target, lineType, forceShow, showReplyInput = false }) {\n    var $link,\n      addForm,\n      hasNotes,\n      newForm,\n      noteForm,\n      replyButton,\n      row,\n      rowCssToAdd,\n      targetContent,\n      isDiffCommentAvatar;\n    $link = $(target);\n    row = $link.closest('tr');\n    const nextRow = row.next();\n    let targetRow = row;\n    if (nextRow.is('.notes_holder')) {\n      targetRow = nextRow;\n    }\n\n    hasNotes = nextRow.is('.notes_holder');\n    addForm = false;\n    let lineTypeSelector = '';\n    rowCssToAdd =\n      '<tr class=\"notes_holder js-temp-notes-holder\"><td class=\"notes_content\" colspan=\"3\"><div class=\"content\"></div></td></tr>';\n    // In parallel view, look inside the correct left/right pane\n    if (this.isParallelView()) {\n      lineTypeSelector = `.${lineType}`;\n      rowCssToAdd =\n        '<tr class=\"notes_holder js-temp-notes-holder\"><td class=\"notes_line old\"></td><td class=\"notes_content parallel old\"><div class=\"content\"></div></td><td class=\"notes_line new\"></td><td class=\"notes_content parallel new\"><div class=\"content\"></div></td></tr>';\n    }\n    const notesContentSelector = `.notes_content${lineTypeSelector} .content`;\n    let notesContent = targetRow.find(notesContentSelector);\n\n    if (hasNotes && showReplyInput) {\n      targetRow.show();\n      notesContent = targetRow.find(notesContentSelector);\n      if (notesContent.length) {\n        notesContent.show();\n        replyButton = notesContent.find('.js-discussion-reply-button:visible');\n        if (replyButton.length) {\n          this.replyToDiscussionNote(replyButton[0]);\n        } else {\n          // In parallel view, the form may not be present in one of the panes\n          noteForm = notesContent.find('.js-discussion-note-form');\n          if (noteForm.length === 0) {\n            addForm = true;\n          }\n        }\n      }\n    } else if (showReplyInput) {\n      // add a notes row and insert the form\n      row.after(rowCssToAdd);\n      targetRow = row.next();\n      notesContent = targetRow.find(notesContentSelector);\n      addForm = true;\n    } else {\n      const isCurrentlyShown = targetRow.find('.content:not(:empty)').is(':visible');\n      const isForced = forceShow === true || forceShow === false;\n      const showNow = forceShow === true || (!isCurrentlyShown && !isForced);\n\n      targetRow.toggleClass('hide', !showNow);\n      notesContent.toggleClass('hide', !showNow);\n    }\n\n    if (addForm) {\n      newForm = this.cleanForm(this.formClone.clone());\n      newForm.appendTo(notesContent);\n      // show the form\n      return this.setupDiscussionNoteForm($link, newForm);\n    }\n  }\n\n  /**\n   * Called in response to \"cancel\" on a diff note form.\n   *\n   * Shows the reply button again.\n   * Removes the form and if necessary it's temporary row.\n   */\n  removeDiscussionNoteForm(form) {\n    var glForm, row;\n    row = form.closest('tr');\n    glForm = form.data('glForm');\n    glForm.destroy();\n    form\n      .find('.js-note-text')\n      .data('autosave')\n      .reset();\n    // show the reply button (will only work for replies)\n    form.prev('.discussion-reply-holder').show();\n    if (row.is('.js-temp-notes-holder')) {\n      // remove temporary row for diff lines\n      return row.remove();\n    } else {\n      // only remove the form\n      return form.remove();\n    }\n  }\n\n  cancelDiscussionForm(e) {\n    e.preventDefault();\n    const $form = $(e.target).closest('.js-discussion-note-form');\n    const $discussionNote = $(e.target).closest('.discussion-notes');\n\n    if ($discussionNote.length === 0) {\n      // Only send blur event when the discussion form\n      // is not part of a discussion note\n      const $diffFile = $form.closest('.diff-file');\n\n      if ($diffFile.length > 0) {\n        const blurEvent = new CustomEvent('blur.imageDiff', {\n          detail: e,\n        });\n\n        $diffFile[0].dispatchEvent(blurEvent);\n      }\n    }\n\n    return this.removeDiscussionNoteForm($form);\n  }\n\n  /**\n   * Called after an attachment file has been selected.\n   *\n   * Updates the file name for the selected attachment.\n   */\n  updateFormAttachment() {\n    var filename, form;\n    form = $(this).closest('form');\n    // get only the basename\n    filename = $(this)\n      .val()\n      .replace(/^.*[\\\\\\/]/, '');\n    return form.find('.js-attachment-filename').text(filename);\n  }\n\n  /**\n   * Called when the tab visibility changes\n   */\n  visibilityChange() {\n    return this.refresh();\n  }\n\n  updateTargetButtons(e) {\n    var closebtn, closetext, form, reopenbtn, reopentext, textarea;\n    textarea = $(e.target);\n    form = textarea.parents('form');\n    reopenbtn = form.find('.js-note-target-reopen');\n    closebtn = form.find('.js-note-target-close');\n\n    if (textarea.val().trim().length > 0) {\n      reopentext = reopenbtn.attr('data-alternative-text');\n      closetext = closebtn.attr('data-alternative-text');\n      if (reopenbtn.text() !== reopentext) {\n        reopenbtn.text(reopentext);\n      }\n      if (closebtn.text() !== closetext) {\n        closebtn.text(closetext);\n      }\n      if (reopenbtn.is(':not(.btn-comment-and-reopen)')) {\n        reopenbtn.addClass('btn-comment-and-reopen');\n      }\n      if (closebtn.is(':not(.btn-comment-and-close)')) {\n        closebtn.addClass('btn-comment-and-close');\n      }\n    } else {\n      reopentext = reopenbtn.data('originalText');\n      closetext = closebtn.data('originalText');\n      if (reopenbtn.text() !== reopentext) {\n        reopenbtn.text(reopentext);\n      }\n      if (closebtn.text() !== closetext) {\n        closebtn.text(closetext);\n      }\n      if (reopenbtn.is('.btn-comment-and-reopen')) {\n        reopenbtn.removeClass('btn-comment-and-reopen');\n      }\n      if (closebtn.is('.btn-comment-and-close')) {\n        closebtn.removeClass('btn-comment-and-close');\n      }\n    }\n  }\n\n  putEditFormInPlace($el) {\n    var $editForm = $(this.getEditFormSelector($el));\n    var $note = $el.closest('.note');\n\n    $editForm.insertAfter($note.find('.note-text'));\n\n    var $originalContentEl = $note.find('.original-note-content');\n    var originalContent = $originalContentEl.text().trim();\n    var postUrl = $originalContentEl.data('postUrl');\n    var targetId = $originalContentEl.data('targetId');\n    var targetType = $originalContentEl.data('targetType');\n    var markdownVersion = $originalContentEl.data('markdownVersion');\n\n    this.glForm = new GLForm($editForm.find('form'), this.enableGFM);\n\n    $editForm\n      .find('form')\n      .attr('action', `${postUrl}?html=true`)\n      .attr('data-remote', 'true')\n      .attr('data-markdown-version', markdownVersion);\n    $editForm.find('.js-form-target-id').val(targetId);\n    $editForm.find('.js-form-target-type').val(targetType);\n    $editForm\n      .find('.js-note-text')\n      .focus()\n      .val(originalContent);\n    $editForm.find('.js-md-write-button').trigger('click');\n    $editForm.find('.referenced-users').hide();\n  }\n\n  putConflictEditWarningInPlace(noteEntity, $note) {\n    if ($note.find('.js-conflict-edit-warning').length === 0) {\n      const $alert = $(`<div class=\"js-conflict-edit-warning alert alert-danger\">\n        This comment has changed since you started editing, please review the\n        <a href=\"#note_${noteEntity.id}\" target=\"_blank\" rel=\"noopener noreferrer\">\n          updated comment\n        </a>\n        to ensure information is not lost\n      </div>`);\n      $alert.insertAfter($note.find('.note-text'));\n    }\n  }\n\n  updateNotesCount(updateCount) {\n    return this.notesCountBadge.text(parseInt(this.notesCountBadge.text(), 10) + updateCount);\n  }\n\n  static renderPlaceholderComponent($container) {\n    const el = $container.find('.js-code-placeholder').get(0);\n    // eslint-disable-next-line no-new\n    new Vue({\n      el,\n      components: {\n        GlSkeletonLoading,\n      },\n      render(createElement) {\n        return createElement('gl-skeleton-loading');\n      },\n    });\n  }\n\n  static renderDiffContent($container, data) {\n    const { discussion_html } = data;\n    const lines = $(discussion_html).find('.line_holder');\n    lines.addClass('fade-in');\n    $container.find('.diff-content > table > tbody').prepend(lines);\n    const fileHolder = $container.find('.file-holder');\n    $container.find('.line-holder-placeholder').remove();\n    syntaxHighlight(fileHolder);\n  }\n\n  onClickRetryLazyLoad(e) {\n    const $retryButton = $(e.currentTarget);\n\n    $retryButton.prop('disabled', true);\n\n    return this.loadLazyDiff(e).then(() => {\n      $retryButton.prop('disabled', false);\n    });\n  }\n\n  loadLazyDiff(e) {\n    const $container = $(e.currentTarget).closest('.js-toggle-container');\n    Notes.renderPlaceholderComponent($container);\n\n    $container.find('.js-toggle-lazy-diff').removeClass('js-toggle-lazy-diff');\n\n    const $tableEl = $container.find('tbody');\n    if ($tableEl.length === 0) return;\n\n    const fileHolder = $container.find('.file-holder');\n    const url = fileHolder.data('linesPath');\n\n    const $errorContainer = $container.find('.js-error-lazy-load-diff');\n    const $successContainer = $container.find('.js-success-lazy-load');\n\n    /**\n     * We only fetch resolved discussions.\n     * Unresolved discussions don't have an endpoint being provided.\n     */\n    if (url) {\n      return axios\n        .get(url)\n        .then(({ data }) => {\n          // Reset state in case last request returned error\n          $successContainer.removeClass('hidden');\n          $errorContainer.addClass('hidden');\n\n          Notes.renderDiffContent($container, data);\n        })\n        .catch(() => {\n          $successContainer.addClass('hidden');\n          $errorContainer.removeClass('hidden');\n        });\n    }\n    return Promise.resolve();\n  }\n\n  toggleCommitList(e) {\n    const $element = $(e.currentTarget);\n    const $closestSystemCommitList = $element.siblings('.system-note-commit-list');\n\n    $element\n      .find('.fa')\n      .toggleClass('fa-angle-down')\n      .toggleClass('fa-angle-up');\n    $closestSystemCommitList.toggleClass('hide-shade');\n  }\n\n  /**\n   * Scans system notes with `ul` elements in system note body\n   * then collapse long commit list pushed by user to make it less\n   * intrusive.\n   */\n  collapseLongCommitList() {\n    const systemNotes = $('#notes-list')\n      .find('li.system-note')\n      .has('ul');\n\n    $.each(systemNotes, function(index, systemNote) {\n      const $systemNote = $(systemNote);\n      const headerMessage = $systemNote\n        .find('.note-text')\n        .find('p:first')\n        .text()\n        .replace(':', '');\n\n      $systemNote.find('.note-header .system-note-message').html(headerMessage);\n\n      if ($systemNote.find('li').length > MAX_VISIBLE_COMMIT_LIST_COUNT) {\n        $systemNote.find('.note-text').addClass('system-note-commit-list');\n        $systemNote.find('.system-note-commit-list-toggler').show();\n      } else {\n        $systemNote.find('.note-text').addClass('system-note-commit-list hide-shade');\n      }\n    });\n  }\n\n  addFlash(...flashParams) {\n    this.flashContainer = new Flash(...flashParams);\n  }\n\n  clearFlash() {\n    if (this.flashContainer) {\n      this.flashContainer.style.display = 'none';\n      this.flashContainer = null;\n    }\n  }\n\n  cleanForm($form) {\n    // Remove JS classes that are not needed here\n    $form.find('.js-comment-type-dropdown').removeClass('btn-group');\n\n    // Remove dropdown\n    $form.find('.dropdown-menu').remove();\n\n    return $form;\n  }\n\n  /**\n   * Check if note does not exists on page\n   */\n  static isNewNote(noteEntity, noteIds) {\n    return $.inArray(noteEntity.id, noteIds) === -1;\n  }\n\n  /**\n   * Check if $note already contains the `noteEntity` content\n   */\n  static isUpdatedNote(noteEntity, $note) {\n    // There can be CRLF vs LF mismatches if we don't sanitize and compare the same way\n    const sanitizedNoteEntityText = normalizeNewlines(noteEntity.note.trim());\n    const currentNoteText = normalizeNewlines(\n      $note\n        .find('.original-note-content')\n        .first()\n        .text()\n        .trim(),\n    );\n    return sanitizedNoteEntityText !== currentNoteText;\n  }\n\n  static checkMergeRequestStatus() {\n    if (getPagePath(1) === 'merge_requests' && gl.mrWidget) {\n      gl.mrWidget.checkStatus();\n    }\n  }\n\n  static animateAppendNote(noteHtml, $notesList) {\n    const $note = $(noteHtml);\n\n    $note.addClass('fade-in-full').renderGFM();\n    $notesList.append($note);\n    return $note;\n  }\n\n  static animateUpdateNote(noteHtml, $note) {\n    const $updatedNote = $(noteHtml);\n\n    $updatedNote.addClass('fade-in').renderGFM();\n    $note.replaceWith($updatedNote);\n    return $updatedNote;\n  }\n\n  /**\n   * Get data from Form attributes to use for saving/submitting comment.\n   */\n  getFormData($form) {\n    const content = $form.find('.js-note-text').val();\n    return {\n      formData: $form.serialize(),\n      formContent: _.escape(content),\n      formAction: $form.attr('action'),\n      formContentOriginal: content,\n    };\n  }\n\n  /**\n   * Identify if comment has any quick actions\n   */\n  hasQuickActions(formContent) {\n    return REGEX_QUICK_ACTIONS.test(formContent);\n  }\n\n  /**\n   * Remove quick actions and leave comment with pure message\n   */\n  stripQuickActions(formContent) {\n    return formContent.replace(REGEX_QUICK_ACTIONS, '').trim();\n  }\n\n  /**\n   * Gets appropriate description from quick actions found in provided `formContent`\n   */\n  getQuickActionDescription(formContent, availableQuickActions = []) {\n    let tempFormContent;\n\n    // Identify executed quick actions from `formContent`\n    const executedCommands = availableQuickActions.filter((command, index) => {\n      const commandRegex = new RegExp(`/${command.name}`);\n      return commandRegex.test(formContent);\n    });\n\n    if (executedCommands && executedCommands.length) {\n      if (executedCommands.length > 1) {\n        tempFormContent = 'Applying multiple commands';\n      } else {\n        const commandDescription = executedCommands[0].description.toLowerCase();\n        tempFormContent = `Applying command to ${commandDescription}`;\n      }\n    } else {\n      tempFormContent = 'Applying command';\n    }\n\n    return tempFormContent;\n  }\n\n  /**\n   * Create placeholder note DOM element populated with comment body\n   * that we will show while comment is being posted.\n   * Once comment is _actually_ posted on server, we will have final element\n   * in response that we will show in place of this temporary element.\n   */\n  createPlaceholderNote({\n    formContent,\n    uniqueId,\n    isDiscussionNote,\n    currentUsername,\n    currentUserFullname,\n    currentUserAvatar,\n  }) {\n    const discussionClass = isDiscussionNote ? 'discussion' : '';\n    const $tempNote = $(\n      `<li id=\"${uniqueId}\" class=\"note being-posted fade-in-half timeline-entry\">\n         <div class=\"timeline-entry-inner\">\n            <div class=\"timeline-icon\">\n               <a href=\"/${_.escape(currentUsername)}\">\n                 <img class=\"avatar s40\" src=\"${currentUserAvatar}\" />\n               </a>\n            </div>\n            <div class=\"timeline-content ${discussionClass}\">\n               <div class=\"note-header\">\n                  <div class=\"note-header-info\">\n                     <a href=\"/${_.escape(currentUsername)}\">\n                       <span class=\"d-none d-sm-inline-block\">${_.escape(currentUsername)}</span>\n                       <span class=\"note-headline-light\">${_.escape(currentUsername)}</span>\n                     </a>\n                  </div>\n               </div>\n               <div class=\"note-body\">\n                 <div class=\"note-text\">\n                   <p>${formContent}</p>\n                 </div>\n               </div>\n            </div>\n         </div>\n      </li>`,\n    );\n\n    $tempNote.find('.d-none.d-sm-inline-block').text(_.escape(currentUserFullname));\n    $tempNote.find('.note-headline-light').text(`@${_.escape(currentUsername)}`);\n\n    return $tempNote;\n  }\n\n  /**\n   * Create Placeholder System Note DOM element populated with quick action description\n   */\n  createPlaceholderSystemNote({ formContent, uniqueId }) {\n    const $tempNote = $(\n      `<li id=\"${uniqueId}\" class=\"note system-note timeline-entry being-posted fade-in-half\">\n         <div class=\"timeline-entry-inner\">\n           <div class=\"timeline-content\">\n             <i>${formContent}</i>\n           </div>\n         </div>\n       </li>`,\n    );\n\n    return $tempNote;\n  }\n\n  /**\n   * This method does following tasks step-by-step whenever a new comment\n   * is submitted by user (both main thread comments as well as discussion comments).\n   *\n   * 1) Get Form metadata\n   * 2) Identify comment type; a) Main thread b) Discussion thread c) Discussion resolve\n   * 3) Build temporary placeholder element (using `createPlaceholderNote`)\n   * 4) Show placeholder note on UI\n   * 5) Perform network request to submit the note using `axios.post`\n   *    a) If request is successfully completed\n   *        1. Remove placeholder element\n   *        2. Show submitted Note element\n   *        3. Perform post-submit errands\n   *           a. Mark discussion as resolved if comment submission was for resolve.\n   *           b. Reset comment form to original state.\n   *    b) If request failed\n   *        1. Remove placeholder element\n   *        2. Show error Flash message about failure\n   */\n  postComment(e) {\n    e.preventDefault();\n\n    // Get Form metadata\n    const $submitBtn = $(e.target);\n    $submitBtn.prop('disabled', true);\n    let $form = $submitBtn.parents('form');\n    const $closeBtn = $form.find('.js-note-target-close');\n    const isDiscussionNote =\n      $submitBtn\n        .parent()\n        .find('li.droplab-item-selected')\n        .attr('id') === 'discussion';\n    const isMainForm = $form.hasClass('js-main-target-form');\n    const isDiscussionForm = $form.hasClass('js-discussion-note-form');\n    const isDiscussionResolve = $submitBtn.hasClass('js-comment-resolve-button');\n    const { formData, formContent, formAction, formContentOriginal } = this.getFormData($form);\n    let noteUniqueId;\n    let systemNoteUniqueId;\n    let hasQuickActions = false;\n    let $notesContainer;\n    let tempFormContent;\n\n    // Get reference to notes container based on type of comment\n    if (isDiscussionForm) {\n      $notesContainer = $form.parent('.discussion-notes').find('.notes');\n    } else if (isMainForm) {\n      $notesContainer = $('ul.main-notes-list');\n    }\n\n    // If comment is to resolve discussion, disable submit buttons while\n    // comment posting is finished.\n    if (isDiscussionResolve) {\n      $form.find('.js-comment-submit-button').disable();\n    }\n\n    tempFormContent = formContent;\n    if (this.hasQuickActions(formContent)) {\n      tempFormContent = this.stripQuickActions(formContent);\n      hasQuickActions = true;\n    }\n\n    // Show placeholder note\n    if (tempFormContent) {\n      noteUniqueId = _.uniqueId('tempNote_');\n      $notesContainer.append(\n        this.createPlaceholderNote({\n          formContent: tempFormContent,\n          uniqueId: noteUniqueId,\n          isDiscussionNote,\n          currentUsername: gon.current_username,\n          currentUserFullname: gon.current_user_fullname,\n          currentUserAvatar: gon.current_user_avatar_url,\n        }),\n      );\n    }\n\n    // Show placeholder system note\n    if (hasQuickActions) {\n      systemNoteUniqueId = _.uniqueId('tempSystemNote_');\n      $notesContainer.append(\n        this.createPlaceholderSystemNote({\n          formContent: this.getQuickActionDescription(\n            formContent,\n            AjaxCache.get(gl.GfmAutoComplete.dataSources.commands),\n          ),\n          uniqueId: systemNoteUniqueId,\n        }),\n      );\n    }\n\n    // Clear the form textarea\n    if ($notesContainer.length) {\n      if (isMainForm) {\n        this.resetMainTargetForm(e);\n      } else if (isDiscussionForm) {\n        this.removeDiscussionNoteForm($form);\n      }\n    }\n\n    $closeBtn.text($closeBtn.data('originalText'));\n\n    // Make request to submit comment on server\n    return axios\n      .post(`${formAction}?html=true`, formData)\n      .then(res => {\n        const note = res.data;\n\n        $submitBtn.prop('disabled', false);\n        // Submission successful! remove placeholder\n        $notesContainer.find(`#${noteUniqueId}`).remove();\n\n        const $diffFile = $form.closest('.diff-file');\n        if ($diffFile.length > 0) {\n          const blurEvent = new CustomEvent('blur.imageDiff', {\n            detail: e,\n          });\n\n          $diffFile[0].dispatchEvent(blurEvent);\n        }\n\n        // Reset cached commands list when command is applied\n        if (hasQuickActions) {\n          $form.find('textarea.js-note-text').trigger('clear-commands-cache.atwho');\n        }\n\n        // Clear previous form errors\n        this.clearFlashWrapper();\n\n        // Check if this was discussion comment\n        if (isDiscussionForm) {\n          // Remove flash-container\n          $notesContainer.find('.flash-container').remove();\n\n          // If comment intends to resolve discussion, do the same.\n          if (isDiscussionResolve) {\n            $form\n              .attr('data-discussion-id', $submitBtn.data('discussionId'))\n              .attr('data-resolve-all', 'true')\n              .attr('data-project-path', $submitBtn.data('projectPath'));\n          }\n\n          // Show final note element on UI\n          const isNewDiffComment = $notesContainer.length === 0;\n          this.addDiscussionNote($form, note, isNewDiffComment);\n\n          if (isNewDiffComment) {\n            // Add image badge, avatar badge and toggle discussion badge for new image diffs\n            const notePosition = $form.find('#note_position').val();\n            if ($diffFile.length > 0 && notePosition.length > 0) {\n              const { x, y, width, height } = JSON.parse(notePosition);\n              const addBadgeEvent = new CustomEvent('addBadge.imageDiff', {\n                detail: {\n                  x,\n                  y,\n                  width,\n                  height,\n                  noteId: `note_${note.id}`,\n                  discussionId: note.discussion_id,\n                },\n              });\n\n              $diffFile[0].dispatchEvent(addBadgeEvent);\n            }\n          }\n\n          // append flash-container to the Notes list\n          if ($notesContainer.length) {\n            $notesContainer.append('<div class=\"flash-container\" style=\"display: none;\"></div>');\n          }\n        } else if (isMainForm) {\n          // Check if this was main thread comment\n          // Show final note element on UI and perform form and action buttons cleanup\n          this.addNote($form, note);\n          this.reenableTargetFormSubmitButton(e);\n        }\n\n        if (note.commands_changes) {\n          this.handleQuickActions(note);\n        }\n\n        $form.trigger('ajax:success', [note]);\n      })\n      .catch(() => {\n        // Submission failed, remove placeholder note and show Flash error message\n        $notesContainer.find(`#${noteUniqueId}`).remove();\n        $submitBtn.prop('disabled', false);\n        const blurEvent = new CustomEvent('blur.imageDiff', {\n          detail: e,\n        });\n\n        const closestDiffFile = $form.closest('.diff-file');\n\n        if (closestDiffFile.length) {\n          closestDiffFile[0].dispatchEvent(blurEvent);\n        }\n\n        if (hasQuickActions) {\n          $notesContainer.find(`#${systemNoteUniqueId}`).remove();\n        }\n\n        // Show form again on UI on failure\n        if (isDiscussionForm && $notesContainer.length) {\n          const replyButton = $notesContainer.parent().find('.js-discussion-reply-button');\n          this.replyToDiscussionNote(replyButton[0]);\n          $form = $notesContainer.parent().find('form');\n        }\n\n        $form.find('.js-note-text').val(formContentOriginal);\n        this.reenableTargetFormSubmitButton(e);\n        this.addNoteError($form);\n      });\n  }\n\n  /**\n   * This method does following tasks step-by-step whenever an existing comment\n   * is updated by user (both main thread comments as well as discussion comments).\n   *\n   * 1) Get Form metadata\n   * 2) Update note element with new content\n   * 3) Perform network request to submit the updated note using `axios.post`\n   *    a) If request is successfully completed\n   *        1. Show submitted Note element\n   *    b) If request failed\n   *        1. Revert Note element to original content\n   *        2. Show error Flash message about failure\n   */\n  updateComment(e) {\n    e.preventDefault();\n\n    // Get Form metadata\n    const $submitBtn = $(e.target);\n    const $form = $submitBtn.parents('form');\n    const $closeBtn = $form.find('.js-note-target-close');\n    const $editingNote = $form.parents('.note.is-editing');\n    const $noteBody = $editingNote.find('.js-task-list-container');\n    const $noteBodyText = $noteBody.find('.note-text');\n    const { formData, formContent, formAction } = this.getFormData($form);\n    const $diffFile = $form.closest('.diff-file');\n    const $notesContainer = $form.closest('.notes');\n\n    // Cache original comment content\n    const cachedNoteBodyText = $noteBodyText.html();\n\n    // Show updated comment content temporarily\n    $noteBodyText.html(formContent);\n    $editingNote.removeClass('is-editing fade-in-full').addClass('being-posted fade-in-half');\n    $editingNote\n      .find('.note-headline-meta a')\n      .html(\n        '<i class=\"fa fa-spinner fa-spin\" aria-label=\"Comment is being updated\" aria-hidden=\"true\"></i>',\n      );\n\n    // Make request to update comment on server\n    axios\n      .post(`${formAction}?html=true`, formData)\n      .then(({ data }) => {\n        // Submission successful! render final note element\n        this.updateNote(data, $editingNote);\n      })\n      .catch(() => {\n        // Submission failed, revert back to original note\n        $noteBodyText.html(_.escape(cachedNoteBodyText));\n        $editingNote.removeClass('being-posted fade-in');\n        $editingNote.find('.fa.fa-spinner').remove();\n\n        // Show Flash message about failure\n        this.updateNoteError();\n      });\n\n    return $closeBtn.text($closeBtn.data('originalText'));\n  }\n}\n\nwindow.Notes = Notes;\n","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"TaskList\"] = factory();\n\telse\n\t\troot[\"TaskList\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports) {\n\nvar NodeArray, TaskList, closest, createEvent,\n  indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nNodeArray = function(nodeList) {\n  return Array.prototype.slice.apply(nodeList);\n};\n\nclosest = function(el, className) {\n  while (el && !el.classList.contains(className)) {\n    el = el.parentNode;\n  }\n  return el;\n};\n\ncreateEvent = function(eventName, detail) {\n  var event;\n  if (typeof Event === 'function') {\n    event = new Event(eventName, {\n      bubbles: true,\n      cancelable: true\n    });\n    event.detail = detail;\n  } else {\n    event = document.createEvent('CustomEvent');\n    event.initCustomEvent(eventName, true, true, detail);\n  }\n  return event;\n};\n\nTaskList = (function() {\n  function TaskList(el1) {\n    this.el = el1;\n    this.container = closest(this.el, 'js-task-list-container');\n    this.field = this.container.querySelector('.js-task-list-field');\n    this.container.addEventListener('change', (function(_this) {\n      return function(event) {\n        if (event.target.classList.contains('task-list-item-checkbox')) {\n          return _this.updateTaskList(event.target);\n        }\n      };\n    })(this));\n    this.enable();\n  }\n\n  TaskList.prototype.enable = function() {\n    var event;\n    if (this.container.querySelectorAll('.js-task-list-field').length > 0) {\n      NodeArray(this.container.querySelectorAll('.task-list-item')).forEach(function(item) {\n        return item.classList.add('enabled');\n      });\n      NodeArray(this.container.querySelectorAll('.task-list-item-checkbox')).forEach(function(checkbox) {\n        return checkbox.disabled = false;\n      });\n      this.container.classList.add('is-task-list-enabled');\n      event = createEvent('tasklist:enabled');\n      return this.container.dispatchEvent(event);\n    }\n  };\n\n  TaskList.prototype.disable = function() {\n    var event;\n    NodeArray(this.container.querySelectorAll('.task-list-item')).forEach(function(item) {\n      return item.classList.remove('enabled');\n    });\n    NodeArray(this.container.querySelectorAll('.task-list-item-checkbox')).forEach(function(checkbox) {\n      return checkbox.disabled = true;\n    });\n    this.container.classList.remove('is-task-list-enabled');\n    event = createEvent('tasklist:disabled');\n    return this.container.dispatchEvent(event);\n  };\n\n  TaskList.prototype.updateTaskList = function(item) {\n    var changeEvent, changedEvent, checkboxes, index;\n    checkboxes = this.container.querySelectorAll('.task-list-item-checkbox');\n    index = 1 + NodeArray(checkboxes).indexOf(item);\n    changeEvent = createEvent('tasklist:change', {\n      index: index,\n      checked: item.checked\n    });\n    this.field.dispatchEvent(changeEvent);\n    if (!changeEvent.defaultPrevented) {\n      this.field.value = TaskList.updateSource(this.field.value, index, item.checked);\n      changeEvent = createEvent('change');\n      this.field.dispatchEvent(changeEvent);\n      changedEvent = createEvent('tasklist:changed', {\n        index: index,\n        checked: item.checked\n      });\n      return this.field.dispatchEvent(changedEvent);\n    }\n  };\n\n  TaskList.incomplete = \"[ ]\";\n\n  TaskList.complete = \"[x]\";\n\n  TaskList.escapePattern = function(str) {\n    return str.replace(/([\\[\\]])/g, \"\\\\$1\").replace(/\\s/, \"\\\\s\").replace(\"x\", \"[xX]\");\n  };\n\n  TaskList.incompletePattern = RegExp(\"\" + (TaskList.escapePattern(TaskList.incomplete)));\n\n  TaskList.completePattern = RegExp(\"\" + (TaskList.escapePattern(TaskList.complete)));\n\n  TaskList.itemPattern = RegExp(\"^(?:\\\\s*(?:>\\\\s*)*(?:[-+*]|(?:\\\\d+\\\\.)))\\\\s*(\" + (TaskList.escapePattern(TaskList.complete)) + \"|\" + (TaskList.escapePattern(TaskList.incomplete)) + \")\\\\s+(?!\\\\(.*?\\\\))(?=(?:\\\\[.*?\\\\]\\\\s*(?:\\\\[.*?\\\\]|\\\\(.*?\\\\))\\\\s*)*(?:[^\\\\[]|$))\");\n\n  TaskList.startFencesPattern = /^`{3}.*$/;\n\n  TaskList.endFencesPattern = /^`{3}$/;\n\n  TaskList.itemsInParasPattern = RegExp(\"^(\" + (TaskList.escapePattern(TaskList.complete)) + \"|\" + (TaskList.escapePattern(TaskList.incomplete)) + \").+$\", \"g\");\n\n  TaskList.updateSource = function(source, itemIndex, checked) {\n    var clean, inCodeBlock, index, line, result;\n    clean = source.replace(/\\r/g, '').replace(this.itemsInParasPattern, '').split(\"\\n\");\n    index = 0;\n    inCodeBlock = false;\n    result = (function() {\n      var i, len, ref, results;\n      ref = source.split(\"\\n\");\n      results = [];\n      for (i = 0, len = ref.length; i < len; i++) {\n        line = ref[i];\n        if (inCodeBlock) {\n          if (line.match(this.endFencesPattern)) {\n            inCodeBlock = false;\n          }\n        } else if (line.match(this.startFencesPattern)) {\n          inCodeBlock = true;\n        } else if (indexOf.call(clean, line) >= 0 && line.match(this.itemPattern)) {\n          index += 1;\n          if (index === itemIndex) {\n            line = checked ? line.replace(this.incompletePattern, this.complete) : line.replace(this.completePattern, this.incomplete);\n          }\n        }\n        results.push(line);\n      }\n      return results;\n    }).call(this);\n    return result.join(\"\\n\");\n  };\n\n  return TaskList;\n\n})();\n\nif (typeof jQuery !== 'undefined') {\n  jQuery.fn.taskList = function(method) {\n    return this.each(function(index, el) {\n      var taskList;\n      taskList = jQuery(el).data('task-list');\n      if (!taskList) {\n        taskList = new TaskList(el);\n        jQuery(el).data('task-list', taskList);\n        if (!method || method === 'enable') {\n          return;\n        }\n      }\n      return taskList[method || 'enable']();\n    });\n  };\n}\n\nmodule.exports = TaskList;\n\n\n/***/ })\n/******/ ]);\n});","import Mousetrap from 'mousetrap';\nimport findAndFollowLink from '../../lib/utils/navigation_utility';\nimport Shortcuts from './shortcuts';\n\nexport default class ShortcutsNavigation extends Shortcuts {\n  constructor() {\n    super();\n\n    Mousetrap.bind('g p', () => findAndFollowLink('.shortcuts-project'));\n    Mousetrap.bind('g v', () => findAndFollowLink('.shortcuts-project-activity'));\n    Mousetrap.bind('g r', () => findAndFollowLink('.shortcuts-project-releases'));\n    Mousetrap.bind('g f', () => findAndFollowLink('.shortcuts-tree'));\n    Mousetrap.bind('g c', () => findAndFollowLink('.shortcuts-commits'));\n    Mousetrap.bind('g j', () => findAndFollowLink('.shortcuts-builds'));\n    Mousetrap.bind('g n', () => findAndFollowLink('.shortcuts-network'));\n    Mousetrap.bind('g d', () => findAndFollowLink('.shortcuts-repository-charts'));\n    Mousetrap.bind('g i', () => findAndFollowLink('.shortcuts-issues'));\n    Mousetrap.bind('g b', () => findAndFollowLink('.shortcuts-issue-boards'));\n    Mousetrap.bind('g m', () => findAndFollowLink('.shortcuts-merge_requests'));\n    Mousetrap.bind('g w', () => findAndFollowLink('.shortcuts-wiki'));\n    Mousetrap.bind('g s', () => findAndFollowLink('.shortcuts-snippets'));\n    Mousetrap.bind('g k', () => findAndFollowLink('.shortcuts-kubernetes'));\n    Mousetrap.bind('g e', () => findAndFollowLink('.shortcuts-environments'));\n    Mousetrap.bind('g l', () => findAndFollowLink('.shortcuts-metrics'));\n    Mousetrap.bind('i', () => findAndFollowLink('.shortcuts-new-issue'));\n\n    this.enabledHelp.push('.hidden-shortcut.project');\n  }\n}\n","import $ from 'jquery';\nimport AccessorUtilities from './lib/utils/accessor';\n\nexport default class ProjectSelectComboButton {\n  constructor(select) {\n    this.projectSelectInput = $(select);\n    this.newItemBtn = $('.new-project-item-link');\n    this.resourceType = this.newItemBtn.data('type');\n    this.resourceLabel = this.newItemBtn.data('label');\n    this.formattedText = this.deriveTextVariants();\n    this.groupId = this.projectSelectInput.data('groupId');\n    this.bindEvents();\n    this.initLocalStorage();\n  }\n\n  bindEvents() {\n    this.projectSelectInput\n      .siblings('.new-project-item-select-button')\n      .on('click', e => this.openDropdown(e));\n\n    this.newItemBtn.on('click', e => {\n      if (!this.getProjectFromLocalStorage()) {\n        e.preventDefault();\n        this.openDropdown(e);\n      }\n    });\n\n    this.projectSelectInput.on('change', () => this.selectProject());\n  }\n\n  initLocalStorage() {\n    const localStorageIsSafe = AccessorUtilities.isLocalStorageAccessSafe();\n\n    if (localStorageIsSafe) {\n      this.localStorageKey = [\n        'group',\n        this.groupId,\n        this.formattedText.localStorageItemType,\n        'recent-project',\n      ].join('-');\n      this.setBtnTextFromLocalStorage();\n    }\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  openDropdown(event) {\n    $(event.currentTarget)\n      .siblings('.project-item-select')\n      .select2('open');\n  }\n\n  selectProject() {\n    const selectedProjectData = JSON.parse(this.projectSelectInput.val());\n    const projectUrl = `${selectedProjectData.url}/${this.projectSelectInput.data('relativePath')}`;\n    const projectName = selectedProjectData.name;\n\n    const projectMeta = {\n      url: projectUrl,\n      name: projectName,\n    };\n\n    this.setNewItemBtnAttributes(projectMeta);\n    this.setProjectInLocalStorage(projectMeta);\n  }\n\n  setBtnTextFromLocalStorage() {\n    const cachedProjectData = this.getProjectFromLocalStorage();\n\n    this.setNewItemBtnAttributes(cachedProjectData);\n  }\n\n  setNewItemBtnAttributes(project) {\n    if (project) {\n      this.newItemBtn.attr('href', project.url);\n      this.newItemBtn.text(`${this.formattedText.defaultTextPrefix} in ${project.name}`);\n    } else {\n      this.newItemBtn.text(`Select project to create ${this.formattedText.presetTextSuffix}`);\n    }\n  }\n\n  getProjectFromLocalStorage() {\n    const projectString = localStorage.getItem(this.localStorageKey);\n\n    return JSON.parse(projectString);\n  }\n\n  setProjectInLocalStorage(projectMeta) {\n    const projectString = JSON.stringify(projectMeta);\n\n    localStorage.setItem(this.localStorageKey, projectString);\n  }\n\n  deriveTextVariants() {\n    const defaultTextPrefix = this.resourceLabel;\n\n    // the trailing slice call depluralizes each of these strings (e.g. new-issues -> new-issue)\n    const localStorageItemType = `new-${this.resourceType\n      .split('_')\n      .join('-')\n      .slice(0, -1)}`;\n    const presetTextSuffix = this.resourceType\n      .split('_')\n      .join(' ')\n      .slice(0, -1);\n\n    return {\n      localStorageItemType, // new-issue / new-merge-request\n      defaultTextPrefix, // New issue / New merge request\n      presetTextSuffix, // issue / merge request\n    };\n  }\n}\n","/* eslint-disable func-names, no-var, object-shorthand, one-var, no-else-return */\n\nimport $ from 'jquery';\nimport Api from './api';\nimport ProjectSelectComboButton from './project_select_combo_button';\n\nexport default function projectSelect() {\n  $('.ajax-project-select').each(function(i, select) {\n    var placeholder;\n    const simpleFilter = $(select).data('simpleFilter') || false;\n    this.groupId = $(select).data('groupId');\n    this.includeGroups = $(select).data('includeGroups');\n    this.allProjects = $(select).data('allProjects') || false;\n    this.orderBy = $(select).data('orderBy') || 'id';\n    this.withIssuesEnabled = $(select).data('withIssuesEnabled');\n    this.withMergeRequestsEnabled = $(select).data('withMergeRequestsEnabled');\n    this.withShared =\n      $(select).data('withShared') === undefined ? true : $(select).data('withShared');\n    this.includeProjectsInSubgroups = $(select).data('includeProjectsInSubgroups') || false;\n    this.allowClear = $(select).data('allowClear') || false;\n\n    placeholder = 'Search for project';\n    if (this.includeGroups) {\n      placeholder += ' or group';\n    }\n\n    $(select).select2({\n      placeholder: placeholder,\n      minimumInputLength: 0,\n      query: (function(_this) {\n        return function(query) {\n          var finalCallback, projectsCallback;\n          finalCallback = function(projects) {\n            var data;\n            data = {\n              results: projects,\n            };\n            return query.callback(data);\n          };\n          if (_this.includeGroups) {\n            projectsCallback = function(projects) {\n              var groupsCallback;\n              groupsCallback = function(groups) {\n                var data;\n                data = groups.concat(projects);\n                return finalCallback(data);\n              };\n              return Api.groups(query.term, {}, groupsCallback);\n            };\n          } else {\n            projectsCallback = finalCallback;\n          }\n          if (_this.groupId) {\n            return Api.groupProjects(\n              _this.groupId,\n              query.term,\n              {\n                with_issues_enabled: _this.withIssuesEnabled,\n                with_merge_requests_enabled: _this.withMergeRequestsEnabled,\n                with_shared: _this.withShared,\n                include_subgroups: _this.includeProjectsInSubgroups,\n              },\n              projectsCallback,\n            );\n          } else {\n            return Api.projects(\n              query.term,\n              {\n                order_by: _this.orderBy,\n                with_issues_enabled: _this.withIssuesEnabled,\n                with_merge_requests_enabled: _this.withMergeRequestsEnabled,\n                membership: !_this.allProjects,\n              },\n              projectsCallback,\n            );\n          }\n        };\n      })(this),\n      id: function(project) {\n        if (simpleFilter) return project.id;\n        return JSON.stringify({\n          name: project.name,\n          url: project.web_url,\n        });\n      },\n      text: function(project) {\n        return project.name_with_namespace || project.name;\n      },\n\n      initSelection: function(el, callback) {\n        return Api.project(el.val()).then(({ data }) => callback(data));\n      },\n\n      allowClear: this.allowClear,\n\n      dropdownCssClass: 'ajax-project-dropdown',\n    });\n    if (simpleFilter) return select;\n    return new ProjectSelectComboButton(select);\n  });\n}\n","/* eslint-disable func-names, no-var, no-return-assign, one-var, object-shorthand, vars-on-top */\n\nimport $ from 'jquery';\nimport Cookies from 'js-cookie';\nimport { __ } from '~/locale';\nimport { visitUrl } from '~/lib/utils/url_utility';\nimport axios from '~/lib/utils/axios_utils';\nimport flash from '~/flash';\nimport projectSelect from '../../project_select';\n\nexport default class Project {\n  constructor() {\n    const $cloneOptions = $('ul.clone-options-dropdown');\n    const $projectCloneField = $('#project_clone');\n    const $cloneBtnLabel = $('.js-git-clone-holder .js-clone-dropdown-label');\n    const mobileCloneField = document.querySelector(\n      '.js-mobile-git-clone .js-clone-dropdown-label',\n    );\n\n    const selectedCloneOption = $cloneBtnLabel.text().trim();\n    if (selectedCloneOption.length > 0) {\n      $(`a:contains('${selectedCloneOption}')`, $cloneOptions).addClass('is-active');\n    }\n\n    $('a', $cloneOptions).on('click', e => {\n      e.preventDefault();\n      const $this = $(e.currentTarget);\n      const url = $this.attr('href');\n      const cloneType = $this.data('cloneType');\n\n      $('.is-active', $cloneOptions).removeClass('is-active');\n      $(`a[data-clone-type=\"${cloneType}\"]`).each(function() {\n        const $el = $(this);\n        const activeText = $el.find('.dropdown-menu-inner-title').text();\n        const $container = $el.closest('.project-clone-holder');\n        const $label = $container.find('.js-clone-dropdown-label');\n\n        $el.toggleClass('is-active');\n        $label.text(activeText);\n      });\n\n      if (mobileCloneField) {\n        mobileCloneField.dataset.clipboardText = url;\n      } else {\n        $projectCloneField.val(url);\n      }\n      $('.js-git-empty .js-clone').text(url);\n    });\n    // Ref switcher\n    Project.initRefSwitcher();\n    $('.project-refs-select').on('change', function() {\n      return $(this)\n        .parents('form')\n        .submit();\n    });\n    $('.hide-no-ssh-message').on('click', function(e) {\n      Cookies.set('hide_no_ssh_message', 'false');\n      $(this)\n        .parents('.no-ssh-key-message')\n        .remove();\n      return e.preventDefault();\n    });\n    $('.hide-no-password-message').on('click', function(e) {\n      Cookies.set('hide_no_password_message', 'false');\n      $(this)\n        .parents('.no-password-message')\n        .remove();\n      return e.preventDefault();\n    });\n    $('.hide-auto-devops-implicitly-enabled-banner').on('click', function(e) {\n      const projectId = $(this).data('project-id');\n      const cookieKey = `hide_auto_devops_implicitly_enabled_banner_${projectId}`;\n      Cookies.set(cookieKey, 'false');\n      $(this)\n        .parents('.auto-devops-implicitly-enabled-banner')\n        .remove();\n      return e.preventDefault();\n    });\n    Project.projectSelectDropdown();\n  }\n\n  static projectSelectDropdown() {\n    projectSelect();\n    $('.project-item-select').on('click', e => Project.changeProject($(e.currentTarget).val()));\n  }\n\n  static changeProject(url) {\n    return (window.location = url);\n  }\n\n  static initRefSwitcher() {\n    var refListItem = document.createElement('li');\n    var refLink = document.createElement('a');\n\n    refLink.href = '#';\n\n    return $('.js-project-refs-dropdown').each(function() {\n      var $dropdown, selected;\n      $dropdown = $(this);\n      selected = $dropdown.data('selected');\n      return $dropdown.glDropdown({\n        data(term, callback) {\n          axios\n            .get($dropdown.data('refsUrl'), {\n              params: {\n                ref: $dropdown.data('ref'),\n                search: term,\n              },\n            })\n            .then(({ data }) => callback(data))\n            .catch(() => flash(__('An error occurred while getting projects')));\n        },\n        selectable: true,\n        filterable: true,\n        filterRemote: true,\n        filterByText: true,\n        inputFieldName: $dropdown.data('inputFieldName'),\n        fieldName: $dropdown.data('fieldName'),\n        renderRow: function(ref) {\n          var li = refListItem.cloneNode(false);\n\n          if (ref.header != null) {\n            li.className = 'dropdown-header';\n            li.textContent = ref.header;\n          } else {\n            var link = refLink.cloneNode(false);\n\n            if (ref === selected) {\n              link.className = 'is-active';\n            }\n\n            link.textContent = ref;\n            link.dataset.ref = ref;\n\n            li.appendChild(link);\n          }\n\n          return li;\n        },\n        id: function(obj, $el) {\n          return $el.attr('data-ref');\n        },\n        toggleLabel: function(obj, $el) {\n          return $el.text().trim();\n        },\n        clicked: function(options) {\n          const { e } = options;\n          e.preventDefault();\n          if ($('input[name=\"ref\"]').length) {\n            var $form = $dropdown.closest('form');\n\n            var $visit = $dropdown.data('visit');\n            var shouldVisit = $visit ? true : $visit;\n            var action = $form.attr('action');\n            var divider = action.indexOf('?') === -1 ? '?' : '&';\n            if (shouldVisit) {\n              visitUrl(`${action}${divider}${$form.serialize()}`);\n            }\n          }\n        },\n      });\n    });\n  }\n}\n","import $ from 'jquery';\nimport { stickyMonitor } from './lib/utils/sticky';\n\nexport default stickyTop => {\n  stickyMonitor(document.querySelector('.js-diff-files-changed'), stickyTop);\n\n  $('.js-diff-stats-dropdown').glDropdown({\n    filterable: true,\n    remoteFilter: false,\n  });\n};\n","import Notes from './notes';\n\nexport default () => {\n  const dataEl = document.querySelector('.js-notes-data');\n  const { notesUrl, notesIds, now, diffView, enableGFM } = JSON.parse(dataEl.innerHTML);\n\n  // Create a singleton so that we don't need to assign\n  // into the window object, we can just access the current isntance with Notes.instance\n  Notes.initialize(notesUrl, notesIds, now, diffView, enableGFM);\n};\n","import initGkeDropdowns from '~/projects/gke_cluster_dropdowns';\nimport PersistentUserCallout from '../../persistent_user_callout';\nimport Project from './project';\nimport ShortcutsNavigation from '../../behaviors/shortcuts/shortcuts_navigation';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const { page } = document.body.dataset;\n  const newClusterViews = [\n    'projects:clusters:new',\n    'projects:clusters:create_gcp',\n    'projects:clusters:create_user',\n  ];\n\n  if (newClusterViews.indexOf(page) > -1) {\n    const callout = document.querySelector('.gcp-signup-offer');\n    if (callout) new PersistentUserCallout(callout); // eslint-disable-line no-new\n\n    initGkeDropdowns();\n  }\n\n  new Project(); // eslint-disable-line no-new\n  new ShortcutsNavigation(); // eslint-disable-line no-new\n});\n","import $ from 'jquery';\nimport flash from './flash';\nimport axios from './lib/utils/axios_utils';\n\n/**\n * In each pipelines table we have a mini pipeline graph for each pipeline.\n *\n * When we click in a pipeline stage, we need to make an API call to get the\n * builds list to render in a dropdown.\n *\n * The container should be the table element.\n *\n * The stage icon clicked needs to have the following HTML structure:\n * <div class=\"dropdown\">\n *   <button class=\"dropdown js-builds-dropdown-button\" data-toggle=\"dropdown\"></button>\n *   <div class=\"js-builds-dropdown-container dropdown-menu\"></div>\n * </div>\n */\n\nexport default class MiniPipelineGraph {\n  constructor(opts = {}) {\n    this.container = opts.container || '';\n    this.dropdownListSelector = '.js-builds-dropdown-container';\n    this.getBuildsList = this.getBuildsList.bind(this);\n  }\n\n  /**\n   * Adds the event listener when the dropdown is opened.\n   * All dropdown events are fired at the .dropdown-menu's parent element.\n   */\n  bindEvents() {\n    $(document)\n      .off('shown.bs.dropdown', this.container)\n      .on('shown.bs.dropdown', this.container, this.getBuildsList);\n  }\n\n  /**\n   * When the user right clicks or cmd/ctrl + click in the job name\n   * the dropdown should not be closed and the link should open in another tab,\n   * so we stop propagation of the click event inside the dropdown.\n   *\n   * Since this component is rendered multiple times per page we need to guarantee we only\n   * target the click event of this component.\n   */\n  stopDropdownClickPropagation() {\n    $(document).on(\n      'click',\n      `${this.container} .js-builds-dropdown-list a.mini-pipeline-graph-dropdown-item`,\n      e => {\n        e.stopPropagation();\n      },\n    );\n  }\n\n  /**\n   * For the clicked stage, renders the given data in the dropdown list.\n   *\n   * @param  {HTMLElement} stageContainer\n   * @param  {Object} data\n   */\n  renderBuildsList(stageContainer, data) {\n    const dropdownContainer = stageContainer.parentElement.querySelector(\n      `${this.dropdownListSelector} .js-builds-dropdown-list ul`,\n    );\n\n    dropdownContainer.innerHTML = data;\n  }\n\n  /**\n   * For the clicked stage, gets the list of builds.\n   *\n   * All dropdown events have a relatedTarget property,\n   * whose value is the toggling anchor element.\n   *\n   * @param  {Object} e bootstrap dropdown event\n   * @return {Promise}\n   */\n  getBuildsList(e) {\n    const button = e.relatedTarget;\n    const endpoint = button.dataset.stageEndpoint;\n\n    this.renderBuildsList(button, '');\n    this.toggleLoading(button);\n\n    axios\n      .get(endpoint)\n      .then(({ data }) => {\n        this.toggleLoading(button);\n        this.renderBuildsList(button, data.html);\n        this.stopDropdownClickPropagation();\n      })\n      .catch(() => {\n        this.toggleLoading(button);\n        if (\n          $(button)\n            .parent()\n            .hasClass('open')\n        ) {\n          $(button).dropdown('toggle');\n        }\n        flash('An error occurred while fetching the builds.', 'alert');\n      });\n  }\n\n  /**\n   * Toggles the visibility of the loading icon.\n   *\n   * @param  {HTMLElement} stageContainer\n   * @return {type}\n   */\n  toggleLoading(stageContainer) {\n    stageContainer.parentElement\n      .querySelector(`${this.dropdownListSelector} .js-builds-dropdown-loading`)\n      .classList.toggle('hidden');\n  }\n}\n","import $ from 'jquery';\nimport Dropzone from 'dropzone';\nimport _ from 'underscore';\nimport './behaviors/preview_markdown';\nimport csrf from './lib/utils/csrf';\nimport axios from './lib/utils/axios_utils';\n\nDropzone.autoDiscover = false;\n\n/**\n * Return the error message string from the given response.\n *\n * @param {String|Object} res\n */\nfunction getErrorMessage(res) {\n  if (!res || _.isString(res)) {\n    return res;\n  }\n\n  return res.message;\n}\n\nexport default function dropzoneInput(form) {\n  const divHover = '<div class=\"div-dropzone-hover\"></div>';\n  const iconPaperclip = '<i class=\"fa fa-paperclip div-dropzone-icon\"></i>';\n  const $attachButton = form.find('.button-attach-file');\n  const $attachingFileMessage = form.find('.attaching-file-message');\n  const $cancelButton = form.find('.button-cancel-uploading-files');\n  const $retryLink = form.find('.retry-uploading-link');\n  const $uploadProgress = form.find('.uploading-progress');\n  const $uploadingErrorContainer = form.find('.uploading-error-container');\n  const $uploadingErrorMessage = form.find('.uploading-error-message');\n  const $uploadingProgressContainer = form.find('.uploading-progress-container');\n  const uploadsPath = form.data('uploads-path') || window.uploads_path || null;\n  const maxFileSize = gon.max_file_size || 10;\n  const formTextarea = form.find('.js-gfm-input');\n  let handlePaste;\n  let pasteText;\n  let addFileToForm;\n  let updateAttachingMessage;\n  let isImage;\n  let getFilename;\n  let uploadFile;\n\n  formTextarea.wrap('<div class=\"div-dropzone\"></div>');\n  formTextarea.on('paste', event => handlePaste(event));\n\n  // Add dropzone area to the form.\n  const $mdArea = formTextarea.closest('.md-area');\n  form.setupMarkdownPreview();\n  const $formDropzone = form.find('.div-dropzone');\n  $formDropzone.parent().addClass('div-dropzone-wrapper');\n  $formDropzone.append(divHover);\n  $formDropzone.find('.div-dropzone-hover').append(iconPaperclip);\n\n  if (!uploadsPath) {\n    $formDropzone.addClass('js-invalid-dropzone');\n    return null;\n  }\n\n  const dropzone = $formDropzone.dropzone({\n    url: uploadsPath,\n    dictDefaultMessage: '',\n    clickable: true,\n    paramName: 'file',\n    maxFilesize: maxFileSize,\n    uploadMultiple: false,\n    headers: csrf.headers,\n    previewContainer: false,\n    processing: () => $('.div-dropzone-alert').alert('close'),\n    dragover: () => {\n      $mdArea.addClass('is-dropzone-hover');\n      form.find('.div-dropzone-hover').css('opacity', 0.7);\n    },\n    dragleave: () => {\n      $mdArea.removeClass('is-dropzone-hover');\n      form.find('.div-dropzone-hover').css('opacity', 0);\n    },\n    drop: () => {\n      $mdArea.removeClass('is-dropzone-hover');\n      form.find('.div-dropzone-hover').css('opacity', 0);\n      formTextarea.focus();\n    },\n    success(header, response) {\n      const processingFileCount = this.getQueuedFiles().length + this.getUploadingFiles().length;\n      const shouldPad = processingFileCount >= 1;\n\n      pasteText(response.link.markdown, shouldPad);\n      // Show 'Attach a file' link only when all files have been uploaded.\n      if (!processingFileCount) $attachButton.removeClass('hide');\n      addFileToForm(response.link.url);\n    },\n    error: (file, errorMessage = 'Attaching the file failed.', xhr) => {\n      // If 'error' event is fired by dropzone, the second parameter is error message.\n      // If the 'errorMessage' parameter is empty, the default error message is set.\n      // If the 'error' event is fired by backend (xhr) error response, the third parameter is\n      // xhr object (xhr.responseText is error message).\n      // On error we hide the 'Attach' and 'Cancel' buttons\n      // and show an error.\n      const message = getErrorMessage(errorMessage || xhr.responseText);\n\n      $uploadingErrorContainer.removeClass('hide');\n      $uploadingErrorMessage.html(message);\n      $attachButton.addClass('hide');\n      $cancelButton.addClass('hide');\n    },\n    totaluploadprogress(totalUploadProgress) {\n      updateAttachingMessage(this.files, $attachingFileMessage);\n      $uploadProgress.text(`${Math.round(totalUploadProgress)}%`);\n    },\n    sending: () => {\n      // DOM elements already exist.\n      // Instead of dynamically generating them,\n      // we just either hide or show them.\n      $attachButton.addClass('hide');\n      $uploadingErrorContainer.addClass('hide');\n      $uploadingProgressContainer.removeClass('hide');\n      $cancelButton.removeClass('hide');\n    },\n    removedfile: () => {\n      $attachButton.removeClass('hide');\n      $cancelButton.addClass('hide');\n      $uploadingProgressContainer.addClass('hide');\n      $uploadingErrorContainer.addClass('hide');\n    },\n    queuecomplete: () => {\n      $('.dz-preview').remove();\n      $('.markdown-area').trigger('input');\n\n      $uploadingProgressContainer.addClass('hide');\n      $cancelButton.addClass('hide');\n    },\n  });\n\n  const child = $(dropzone[0]).children('textarea');\n\n  // removeAllFiles(true) stops uploading files (if any)\n  // and remove them from dropzone files queue.\n  $cancelButton.on('click', e => {\n    e.preventDefault();\n    e.stopPropagation();\n    Dropzone.forElement($formDropzone.get(0)).removeAllFiles(true);\n  });\n\n  // If 'error' event is fired, we store a failed files,\n  // clear dropzone files queue, change status of failed files to undefined,\n  // and add that files to the dropzone files queue again.\n  // addFile() adds file to dropzone files queue and upload it.\n  $retryLink.on('click', e => {\n    const dropzoneInstance = Dropzone.forElement(\n      e.target.closest('.js-main-target-form').querySelector('.div-dropzone'),\n    );\n    const failedFiles = dropzoneInstance.files;\n\n    e.preventDefault();\n\n    // 'true' parameter of removeAllFiles() cancels\n    // uploading of files that are being uploaded at the moment.\n    dropzoneInstance.removeAllFiles(true);\n\n    failedFiles.map(failedFile => {\n      const file = failedFile;\n\n      if (file.status === Dropzone.ERROR) {\n        file.status = undefined;\n        file.accepted = undefined;\n      }\n\n      return dropzoneInstance.addFile(file);\n    });\n  });\n  // eslint-disable-next-line consistent-return\n  handlePaste = event => {\n    const pasteEvent = event.originalEvent;\n    if (pasteEvent.clipboardData && pasteEvent.clipboardData.items) {\n      const image = isImage(pasteEvent);\n      if (image) {\n        event.preventDefault();\n        const filename = getFilename(pasteEvent) || 'image.png';\n        const text = `{{${filename}}}`;\n        pasteText(text);\n        return uploadFile(image.getAsFile(), filename);\n      }\n    }\n  };\n\n  isImage = data => {\n    let i = 0;\n    while (i < data.clipboardData.items.length) {\n      const item = data.clipboardData.items[i];\n      if (item.type.indexOf('image') !== -1) {\n        return item;\n      }\n      i += 1;\n    }\n    return false;\n  };\n\n  pasteText = (text, shouldPad) => {\n    let formattedText = text;\n    if (shouldPad) {\n      formattedText += '\\n\\n';\n    }\n    const textarea = child.get(0);\n    const caretStart = textarea.selectionStart;\n    const caretEnd = textarea.selectionEnd;\n    const textEnd = $(child).val().length;\n    const beforeSelection = $(child)\n      .val()\n      .substring(0, caretStart);\n    const afterSelection = $(child)\n      .val()\n      .substring(caretEnd, textEnd);\n    $(child).val(beforeSelection + formattedText + afterSelection);\n    textarea.setSelectionRange(caretStart + formattedText.length, caretEnd + formattedText.length);\n    textarea.style.height = `${textarea.scrollHeight}px`;\n    formTextarea.get(0).dispatchEvent(new Event('input'));\n    return formTextarea.trigger('input');\n  };\n\n  addFileToForm = path => {\n    $(form).append(`<input type=\"hidden\" name=\"files[]\" value=\"${_.escape(path)}\">`);\n  };\n\n  getFilename = e => {\n    let value;\n    if (window.clipboardData && window.clipboardData.getData) {\n      value = window.clipboardData.getData('Text');\n    } else if (e.clipboardData && e.clipboardData.getData) {\n      value = e.clipboardData.getData('text/plain');\n    }\n    value = value.split('\\r');\n    return value[0];\n  };\n\n  const showSpinner = () => $uploadingProgressContainer.removeClass('hide');\n\n  const closeSpinner = () => $uploadingProgressContainer.addClass('hide');\n\n  const showError = message => {\n    $uploadingErrorContainer.removeClass('hide');\n    $uploadingErrorMessage.html(message);\n  };\n\n  const closeAlertMessage = () => form.find('.div-dropzone-alert').alert('close');\n\n  const insertToTextArea = (filename, url) => {\n    const $child = $(child);\n    $child.val((index, val) => val.replace(`{{${filename}}}`, url));\n\n    $child.trigger('change');\n  };\n\n  uploadFile = (item, filename) => {\n    const formData = new FormData();\n    formData.append('file', item, filename);\n\n    showSpinner();\n    closeAlertMessage();\n\n    axios\n      .post(uploadsPath, formData)\n      .then(({ data }) => {\n        const md = data.link.markdown;\n\n        insertToTextArea(filename, md);\n        closeSpinner();\n      })\n      .catch(e => {\n        showError(e.response.data.message);\n        closeSpinner();\n      });\n  };\n\n  updateAttachingMessage = (files, messageContainer) => {\n    let attachingMessage;\n    const filesCount = files.filter(file => file.status === 'uploading' || file.status === 'queued')\n      .length;\n\n    // Dinamycally change uploading files text depending on files number in\n    // dropzone files queue.\n    if (filesCount > 1) {\n      attachingMessage = `Attaching ${filesCount} files -`;\n    } else {\n      attachingMessage = 'Attaching a file -';\n    }\n\n    messageContainer.text(attachingMessage);\n  };\n\n  form.find('.markdown-selector').click(function onMarkdownClick(e) {\n    e.preventDefault();\n    $(this)\n      .closest('.gfm-form')\n      .find('.div-dropzone')\n      .click();\n    formTextarea.focus();\n  });\n\n  return Dropzone.forElement($formDropzone.get(0));\n}\n","import $ from 'jquery';\nimport autosize from 'autosize';\nimport GfmAutoComplete, * as GFMConfig from './gfm_auto_complete';\nimport dropzoneInput from './dropzone_input';\nimport { addMarkdownListeners, removeMarkdownListeners } from './lib/utils/text_markdown';\n\nexport default class GLForm {\n  constructor(form, enableGFM = {}) {\n    this.form = form;\n    this.textarea = this.form.find('textarea.js-gfm-input');\n    this.enableGFM = Object.assign({}, GFMConfig.defaultAutocompleteConfig, enableGFM);\n    // Disable autocomplete for keywords which do not have dataSources available\n    const dataSources = (gl.GfmAutoComplete && gl.GfmAutoComplete.dataSources) || {};\n    Object.keys(this.enableGFM).forEach(item => {\n      if (item !== 'emojis') {\n        this.enableGFM[item] = !!dataSources[item];\n      }\n    });\n    // Before we start, we should clean up any previous data for this form\n    this.destroy();\n    // Set up the form\n    this.setupForm();\n    this.form.data('glForm', this);\n  }\n\n  destroy() {\n    // Clean form listeners\n    this.clearEventListeners();\n    if (this.autoComplete) {\n      this.autoComplete.destroy();\n    }\n    this.form.data('glForm', null);\n  }\n\n  setupForm() {\n    const isNewForm = this.form.is(':not(.gfm-form)');\n    this.form.removeClass('js-new-note-form');\n    if (isNewForm) {\n      this.form.find('.div-dropzone').remove();\n      this.form.addClass('gfm-form');\n      // remove notify commit author checkbox for non-commit notes\n      gl.utils.disableButtonIfEmptyField(\n        this.form.find('.js-note-text'),\n        this.form.find('.js-comment-button, .js-note-new-discussion'),\n      );\n      this.autoComplete = new GfmAutoComplete(gl.GfmAutoComplete && gl.GfmAutoComplete.dataSources);\n      this.autoComplete.setup(this.form.find('.js-gfm-input'), this.enableGFM);\n      dropzoneInput(this.form);\n      autosize(this.textarea);\n    }\n    // form and textarea event listeners\n    this.addEventListeners();\n    addMarkdownListeners(this.form);\n    this.form.show();\n    if (this.isAutosizeable) this.setupAutosize();\n  }\n\n  setupAutosize() {\n    this.textarea.off('autosize:resized').on('autosize:resized', this.setHeightData.bind(this));\n\n    this.textarea.off('mouseup.autosize').on('mouseup.autosize', this.destroyAutosize.bind(this));\n\n    setTimeout(() => {\n      autosize(this.textarea);\n      this.textarea.css('resize', 'vertical');\n    }, 0);\n  }\n\n  setHeightData() {\n    this.textarea.data('height', this.textarea.outerHeight());\n  }\n\n  destroyAutosize() {\n    const outerHeight = this.textarea.outerHeight();\n\n    if (this.textarea.data('height') === outerHeight) return;\n\n    autosize.destroy(this.textarea);\n\n    this.textarea.data('height', outerHeight);\n    this.textarea.outerHeight(outerHeight);\n    this.textarea.css('max-height', window.outerHeight);\n  }\n\n  clearEventListeners() {\n    this.textarea.off('focus');\n    this.textarea.off('blur');\n    removeMarkdownListeners(this.form);\n  }\n\n  addEventListeners() {\n    this.textarea.on('focus', function focusTextArea() {\n      $(this)\n        .closest('.md-area')\n        .addClass('is-focused');\n    });\n    this.textarea.on('blur', function blurTextArea() {\n      $(this)\n        .closest('.md-area')\n        .removeClass('is-focused');\n    });\n  }\n}\n","module.exports = \"<svg width=\\\"11\\\" height=\\\"11\\\" viewBox=\\\"0 0 9 13\\\"><path d=\\\"M2.57568253,6.49866948 C2.50548852,6.57199715 2.44637866,6.59708255 2.39835118,6.57392645 C2.3503237,6.55077034 2.32631032,6.48902165 2.32631032,6.38867852 L2.32631032,-2.13272614 C2.32631032,-2.23306927 2.3503237,-2.29481796 2.39835118,-2.31797406 C2.44637866,-2.34113017 2.50548852,-2.31604477 2.57568253,-2.24271709 L6.51022184,1.86747129 C6.53977721,1.8983461 6.56379059,1.93500939 6.5822627,1.97746225 L6.5822627,2.27849013 C6.56379059,2.31708364 6.53977721,2.35374693 6.51022184,2.38848109 L2.57568253,6.49866948 Z\\\" transform=\\\"translate(4.454287, 2.127976) rotate(90.000000) translate(-4.454287, -2.127976) \\\"></path><path d=\\\"M3.74312342,2.09553332 C3.74312342,1.99519019 3.77821989,1.9083561 3.8484139,1.83502843 C3.91860791,1.76170075 4.00173115,1.72503747 4.09778611,1.72503747 L4.80711151,1.72503747 C4.90316647,1.72503747 4.98628971,1.76170075 5.05648372,1.83502843 C5.12667773,1.9083561 5.16177421,1.99519019 5.16177421,2.09553332 L5.16177421,10.2464421 C5.16177421,10.3467853 5.12667773,10.4336194 5.05648372,10.506947 C4.98628971,10.5802747 4.90316647,10.616938 4.80711151,10.616938 L4.09778611,10.616938 C4.00173115,10.616938 3.91860791,10.5802747 3.8484139,10.506947 C3.77821989,10.4336194 3.74312342,10.3467853 3.74312342,10.2464421 L3.74312342,2.09553332 Z\\\" transform=\\\"translate(4.452449, 6.170988) rotate(-90.000000) translate(-4.452449, -6.170988) \\\"></path><path d=\\\"M2.57568253,14.6236695 C2.50548852,14.6969971 2.44637866,14.7220826 2.39835118,14.6989264 C2.3503237,14.6757703 2.32631032,14.6140216 2.32631032,14.5136785 L2.32631032,5.99227386 C2.32631032,5.89193073 2.3503237,5.83018204 2.39835118,5.80702594 C2.44637866,5.78386983 2.50548852,5.80895523 2.57568253,5.88228291 L6.51022184,9.99247129 C6.53977721,10.0233461 6.56379059,10.0600094 6.5822627,10.1024622 L6.5822627,10.4034901 C6.56379059,10.4420836 6.53977721,10.4787469 6.51022184,10.5134811 L2.57568253,14.6236695 Z\\\" transform=\\\"translate(4.454287, 10.252976) scale(1, -1) rotate(90.000000) translate(-4.454287, -10.252976) \\\"></path></svg>\\n\"","/* eslint-disable func-names, prefer-arrow-callback, no-unused-vars, consistent-return, camelcase, class-methods-use-this */\n\n// Zen Mode (full screen) textarea\n//\n/*= provides zen_mode:enter */\n/*= provides zen_mode:leave */\n\nimport $ from 'jquery';\nimport 'vendor/jquery.scrollTo';\nimport Dropzone from 'dropzone';\nimport Mousetrap from 'mousetrap';\nimport 'mousetrap/plugins/pause/mousetrap-pause';\n\nDropzone.autoDiscover = false;\n\n//\n// ### Events\n//\n// `zen_mode:enter`\n//\n// Fired when the \"Edit in fullscreen\" link is clicked.\n//\n// **Synchronicity** Sync\n// **Bubbles** Yes\n// **Cancelable** No\n// **Target** a.js-zen-enter\n//\n// `zen_mode:leave`\n//\n// Fired when the \"Leave Fullscreen\" link is clicked.\n//\n// **Synchronicity** Sync\n// **Bubbles** Yes\n// **Cancelable** No\n// **Target** a.js-zen-leave\n//\n\nexport default class ZenMode {\n  constructor() {\n    this.active_backdrop = null;\n    this.active_textarea = null;\n    $(document).on('click', '.js-zen-enter', function(e) {\n      e.preventDefault();\n      return $(e.currentTarget).trigger('zen_mode:enter');\n    });\n    $(document).on('click', '.js-zen-leave', function(e) {\n      e.preventDefault();\n      return $(e.currentTarget).trigger('zen_mode:leave');\n    });\n    $(document).on(\n      'zen_mode:enter',\n      (function(_this) {\n        return function(e) {\n          return _this.enter(\n            $(e.target)\n              .closest('.md-area')\n              .find('.zen-backdrop'),\n          );\n        };\n      })(this),\n    );\n    $(document).on(\n      'zen_mode:leave',\n      (function(_this) {\n        return function(e) {\n          return _this.exit();\n        };\n      })(this),\n    );\n    $(document).on('keydown', function(e) {\n      // Esc\n      if (e.keyCode === 27) {\n        e.preventDefault();\n        return $(document).trigger('zen_mode:leave');\n      }\n    });\n  }\n\n  enter(backdrop) {\n    Mousetrap.pause();\n    this.active_backdrop = $(backdrop);\n    this.active_backdrop.addClass('fullscreen');\n    this.active_textarea = this.active_backdrop.find('textarea');\n    // Prevent a user-resized textarea from persisting to fullscreen\n    this.active_textarea.removeAttr('style');\n    this.active_textarea.focus();\n  }\n\n  exit() {\n    if (this.active_textarea) {\n      Mousetrap.unpause();\n      this.active_textarea.closest('.zen-backdrop').removeClass('fullscreen');\n      this.scrollTo(this.active_textarea);\n      this.active_textarea = null;\n      this.active_backdrop = null;\n\n      const $dropzone = $('.div-dropzone');\n      if ($dropzone && !$dropzone.hasClass('js-invalid-dropzone')) {\n        Dropzone.forElement('.div-dropzone').enable();\n      }\n    }\n  }\n\n  scrollTo(zen_area) {\n    return $.scrollTo(zen_area, 0, {\n      offset: -150,\n    });\n  }\n}\n"],"sourceRoot":""}