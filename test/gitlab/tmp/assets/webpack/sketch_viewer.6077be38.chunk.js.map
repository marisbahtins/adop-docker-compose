{"version":3,"sources":["webpack:///./blob/sketch/index.js","webpack:///./blob/sketch_viewer.js"],"names":["SketchLoader","container","_classCallCheck","this","loadingIcon","querySelector","load","_this","getZipFile","then","data","JSZip","loadAsync","asyncResult","files","async","content","url","window","URL","webkitURL","blob","Blob","Uint8Array","type","previewUrl","createObjectURL","render","catch","error","bind","_this2","external","Promise","resolve","reject","JSZipUtils","getBinaryContent","dataset","endpoint","err","previewLink","document","createElement","previewImage","href","target","src","className","appendChild","removeLoadingIcon","errorMsg","textContent","remove","__webpack_exports__","el","getElementById"],"mappings":"6VAGqBA,aACnB,SAAAA,EAAYC,gGAAWC,CAAAC,KAAAH,GACrBG,KAAKF,UAAYA,EACjBE,KAAKC,YAAcD,KAAKF,UAAUI,cAAc,oBAEhDF,KAAKG,6DAGA,IAAAC,EAAAJ,KACL,OAAOA,KAAKK,aACTC,KAAK,SAAAC,GAAI,OAAIC,IAAMC,UAAUF,KAC7BD,KAAK,SAAAI,GAAW,OAAIA,EAAYC,MAAM,wBAAwBC,MAAM,gBACpEN,KAAK,SAAAO,GACJ,IAAMC,EAAMC,OAAOC,KAAOD,OAAOE,UAC3BC,EAAO,IAAIC,MAAM,IAAIC,WAAWP,KACpCQ,KAAM,cAEFC,EAAaR,EAAIS,gBAAgBL,GAEvCd,EAAKoB,OAAOF,KAEbG,MAAMzB,KAAK0B,MAAMC,KAAK3B,4CAGd,IAAA4B,EAAA5B,KACX,OAAO,IAAIQ,IAAMqB,SAASC,QAAQ,SAACC,EAASC,GAC1CC,IAAWC,iBAAiBN,EAAK9B,UAAUqC,QAAQC,SAAU,SAACC,EAAK9B,GAC7D8B,EACFL,EAAOK,GAEPN,EAAQxB,sCAMTe,GACL,IAAMgB,EAAcC,SAASC,cAAc,KACrCC,EAAeF,SAASC,cAAc,OAE5CF,EAAYI,KAAOpB,EACnBgB,EAAYK,OAAS,SACrBF,EAAaG,IAAMtB,EACnBmB,EAAaI,UAAY,YAEzBP,EAAYQ,YAAYL,GACxBzC,KAAKF,UAAUgD,YAAYR,GAE3BtC,KAAK+C,oDAIL,IAAMC,EAAWT,SAASC,cAAc,KAExCQ,EAASH,UAAY,wDACrBG,EAASC,YAAT,oJAIAjD,KAAKF,UAAUgD,YAAYE,GAE3BhD,KAAK+C,gEAID/C,KAAKC,aACPD,KAAKC,YAAYiD,8CClERC,EAAA,mBACb,IAAMC,EAAKb,SAASc,eAAe,oBAEnC,IAAIxD,EAAauD","file":"sketch_viewer.6077be38.chunk.js","sourcesContent":["import JSZip from 'jszip';\nimport JSZipUtils from 'jszip-utils';\n\nexport default class SketchLoader {\n  constructor(container) {\n    this.container = container;\n    this.loadingIcon = this.container.querySelector('.js-loading-icon');\n\n    this.load();\n  }\n\n  load() {\n    return this.getZipFile()\n      .then(data => JSZip.loadAsync(data))\n      .then(asyncResult => asyncResult.files['previews/preview.png'].async('uint8array'))\n      .then(content => {\n        const url = window.URL || window.webkitURL;\n        const blob = new Blob([new Uint8Array(content)], {\n          type: 'image/png',\n        });\n        const previewUrl = url.createObjectURL(blob);\n\n        this.render(previewUrl);\n      })\n      .catch(this.error.bind(this));\n  }\n\n  getZipFile() {\n    return new JSZip.external.Promise((resolve, reject) => {\n      JSZipUtils.getBinaryContent(this.container.dataset.endpoint, (err, data) => {\n        if (err) {\n          reject(err);\n        } else {\n          resolve(data);\n        }\n      });\n    });\n  }\n\n  render(previewUrl) {\n    const previewLink = document.createElement('a');\n    const previewImage = document.createElement('img');\n\n    previewLink.href = previewUrl;\n    previewLink.target = '_blank';\n    previewImage.src = previewUrl;\n    previewImage.className = 'img-fluid';\n\n    previewLink.appendChild(previewImage);\n    this.container.appendChild(previewLink);\n\n    this.removeLoadingIcon();\n  }\n\n  error() {\n    const errorMsg = document.createElement('p');\n\n    errorMsg.className = 'prepend-top-default append-bottom-default text-center';\n    errorMsg.textContent = `\n      Cannot show preview. For previews on sketch files, they must have the file format\n      introduced by Sketch version 43 and above.\n    `;\n    this.container.appendChild(errorMsg);\n\n    this.removeLoadingIcon();\n  }\n\n  removeLoadingIcon() {\n    if (this.loadingIcon) {\n      this.loadingIcon.remove();\n    }\n  }\n}\n","/* eslint-disable no-new */\nimport SketchLoader from './sketch';\n\nexport default () => {\n  const el = document.getElementById('js-sketch-viewer');\n\n  new SketchLoader(el);\n};\n"],"sourceRoot":""}