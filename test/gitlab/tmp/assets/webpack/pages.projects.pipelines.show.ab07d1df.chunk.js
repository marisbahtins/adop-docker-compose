(this.webpackJsonp=this.webpackJsonp||[]).push([[157],{1350:function(t,e,i){i(42),i(44),t.exports=i(470)},157:function(t,e,i){"use strict";var n=i(10),o=i(6),s=i(51),a=i(1),r=i(7),l={components:{Icon:i(15).a,GlButton:n.b},directives:{GlTooltip:n.n},props:{tooltipText:{type:String,required:!0},link:{type:String,required:!0},actionIcon:{type:String,required:!0}},data:function(){return{isDisabled:!1}},computed:{cssClass:function(){var t=Object(s.e)(this.actionIcon);return"".concat(t," js-icon-").concat(t)}},methods:{onClickAction:function(){var t=this;this.$root.$emit("bv::hide::tooltip","js-ci-action-".concat(this.link)),this.isDisabled=!0,o.a.post("".concat(this.link,".json")).then(function(){t.isDisabled=!1,t.$emit("pipelineActionRequestComplete")}).catch(function(){t.isDisabled=!1,Object(r.a)(Object(a.a)("An error occurred while making the request."))})}}},c=i(3),p=Object(c.a)(l,function(){var t=this.$createElement,e=this._self._c||t;return e("gl-button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip",value:{boundary:"viewport"},expression:"{ boundary: 'viewport' }"}],staticClass:"js-ci-action btn btn-blank\nbtn-transparent ci-action-icon-container ci-action-icon-wrapper",class:this.cssClass,attrs:{id:"js-ci-action-"+this.link,title:this.tooltipText,disabled:this.isDisabled},on:{click:this.onClickAction}},[e("icon",{attrs:{name:this.actionIcon}})],1)},[],!1,null,null,null);p.options.__file="action_component.vue";var u=p.exports,d={components:{ciIcon:i(89).a},props:{name:{type:String,required:!0},status:{type:Object,required:!0}}},h=Object(c.a)(d,function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"ci-job-name-component"},[e("ci-icon",{attrs:{status:this.status}}),this._v(" "),e("span",{staticClass:"ci-status-text"},[this._v(" "+this._s(this.name)+" ")])],1)},[],!1,null,null,null);h.options.__file="job_name_component.vue";var m=h.exports,f=i(189),b={components:{ActionComponent:u,JobNameComponent:m,GlLink:n.d},directives:{GlTooltip:n.n},mixins:[f.a],props:{job:{type:Object,required:!0},cssClassJobName:{type:String,required:!1,default:""},dropdownLength:{type:Number,required:!1,default:1/0}},computed:{status:function(){return this.job&&this.job.status?this.job.status:{}},tooltipText:function(){var t=[],e=this.job.name;e&&t.push(e);var i=this.status.tooltip;return e&&i&&t.push("-"),i&&(this.isDelayedJob?t.push(Object(a.f)(i,{remainingTime:this.remainingTime})):t.push(i)),t.join(" ")},hasAction:function(){return this.job.status&&this.job.status.action&&this.job.status.action.path}},methods:{pipelineActionRequestComplete:function(){this.$emit("pipelineActionRequestComplete")}}},g=Object(c.a)(b,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ci-job-component"},[t.status.has_details?i("gl-link",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],staticClass:"js-pipeline-graph-job-link",class:t.cssClassJobName,attrs:{href:t.status.details_path,title:t.tooltipText}},[i("job-name-component",{attrs:{name:t.job.name,status:t.job.status}})],1):i("div",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],staticClass:"js-job-component-tooltip non-details-job-component",class:t.cssClassJobName,attrs:{title:t.tooltipText}},[i("job-name-component",{attrs:{name:t.job.name,status:t.job.status}})],1),t._v(" "),t.hasAction?i("action-component",{attrs:{"tooltip-text":t.status.action.title,link:t.status.action.path,"action-icon":t.status.action.icon},on:{pipelineActionRequestComplete:t.pipelineActionRequestComplete}}):t._e()],1)},[],!1,null,null,null);g.options.__file="job_item.vue";e.a=g.exports},303:function(t,e,i){"use strict";var n=i(10),o=i(205),s=i(93),a=i(92),r=i(108),l={components:{CiIconBadge:o.a,TimeagoTooltip:s.a,UserAvatarImage:a.a,GlLink:n.d,GlButton:n.b,LoadingButton:r.a},directives:{GlTooltip:n.n},props:{status:{type:Object,required:!0},itemName:{type:String,required:!0},itemId:{type:Number,required:!0},time:{type:String,required:!0},user:{type:Object,required:!1,default:function(){return{}}},actions:{type:Array,required:!1,default:function(){return[]}},hasSidebarButton:{type:Boolean,required:!1,default:!1},shouldRenderTriggeredLabel:{type:Boolean,required:!1,default:!0}},computed:{userAvatarAltText:function(){return"".concat(this.user.name,"'s avatar")}},methods:{onClickAction:function(t){this.$emit("actionClicked",t)},onClickSidebarButton:function(){this.$emit("clickedSidebarButton")}}},c=i(3),p=Object(c.a)(l,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("header",{staticClass:"page-content-header ci-header-container"},[i("section",{staticClass:"header-main-content"},[i("ci-icon-badge",{attrs:{status:t.status}}),t._v(" "),i("strong",[t._v(" "+t._s(t.itemName)+" #"+t._s(t.itemId)+" ")]),t._v(" "),t.shouldRenderTriggeredLabel?[t._v("\n        triggered\n      ")]:[t._v("\n        created\n      ")],t._v(" "),i("timeago-tooltip",{attrs:{time:t.time}}),t._v("\n\n      by\n\n      "),t.user?[i("gl-link",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],staticClass:"js-user-link commit-committer-link",attrs:{href:t.user.path,title:t.user.email}},[i("user-avatar-image",{attrs:{"img-src":t.user.avatar_url,"img-alt":t.userAvatarAltText,"tooltip-text":t.user.name,"img-size":24}}),t._v("\n\n          "+t._s(t.user.name)+"\n        ")],1),t._v(" "),t.user.status_tooltip_html?i("span",{domProps:{innerHTML:t._s(t.user.status_tooltip_html)}}):t._e()]:t._e()],2),t._v(" "),t.actions.length?i("section",{staticClass:"header-action-buttons"},[t._l(t.actions,function(e,n){return["link"===e.type?i("gl-link",{key:n,class:e.cssClass,attrs:{href:e.path}},[t._v("\n          "+t._s(e.label)+"\n        ")]):"ujs-link"===e.type?i("gl-link",{key:n,class:e.cssClass,attrs:{href:e.path,"data-method":"post",rel:"nofollow"}},[t._v("\n          "+t._s(e.label)+"\n        ")]):"button"===e.type?i("loading-button",{key:n,class:e.cssClass,attrs:{loading:e.isLoading,disabled:e.isLoading,"container-class":"d-inline",label:e.label},on:{click:function(i){t.onClickAction(e)}}}):t._e()]})],2):t._e(),t._v(" "),t.hasSidebarButton?i("gl-button",{staticClass:"d-block d-sm-none\nsidebar-toggle-btn js-sidebar-build-toggle js-sidebar-build-toggle-header",attrs:{id:"toggleSidebar"},on:{click:t.onClickSidebarButton}},[i("i",{staticClass:"fa fa-angle-double-left",attrs:{"aria-hidden":"true","aria-labelledby":"toggleSidebar"}})]):t._e()],1)},[],!1,null,null,null);p.options.__file="header_ci_component.vue";e.a=p.exports},470:function(t,e,i){"use strict";i.r(e);var n=i(11),o=i(7),s=i(78),a=i(1),r=i(69),l=i.n(r),c=i(96);function p(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.state={},this.state.pipeline={}}var e,i,n;return e=t,(i=[{key:"storePipeline",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.pipeline=t}}])&&p(e.prototype,i),n&&p(e,n),t}(),d=i(6);function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var m=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pipeline=e}var e,i,n;return e=t,(i=[{key:"getPipeline",value:function(){return d.a.get(this.pipeline)}},{key:"postAction",value:function(t){return d.a.post("".concat(t,".json"))}}])&&h(e.prototype,i),n&&h(e,n),t}();function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var b=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e,this.store=new u,this.service=new m(e.endpoint),this.state={},this.state.isLoading=!1}var e,i,n;return e=t,(i=[{key:"fetchPipeline",value:function(){var t=this;this.poll=new c.a({resource:this.service,method:"getPipeline",successCallback:this.successCallback.bind(this),errorCallback:this.errorCallback.bind(this)}),l.a.hidden()?this.refreshPipeline():(this.state.isLoading=!0,this.poll.makeRequest()),l.a.change(function(){l.a.hidden()?t.poll.stop():t.poll.restart()})}},{key:"successCallback",value:function(t){this.state.isLoading=!1,this.store.storePipeline(t.data)}},{key:"errorCallback",value:function(){this.state.isLoading=!1,Object(o.a)(Object(a.a)("An error occurred while fetching the pipeline."))}},{key:"refreshPipeline",value:function(){var t=this;return this.poll.stop(),this.service.getPipeline().then(function(e){return t.successCallback(e)}).catch(function(){return t.errorCallback()}).finally(function(){return t.poll.restart()})}}])&&f(e.prototype,i),n&&f(e,n),t}(),g=i(5),v=i.n(g),_=i(10),C=i(157),j=i(0),y=i.n(j),w=i(89),k={directives:{GlTooltip:_.n},components:{JobItem:C.a,CiIcon:w.a},props:{group:{type:Object,required:!0}},computed:{tooltipText:function(){var t=this.group,e=t.name,i=t.status;return"".concat(e," - ").concat(i.label)}},mounted:function(){this.stopDropdownClickPropagation()},methods:{stopDropdownClickPropagation:function(){y()(".js-grouped-pipeline-dropdown button, .js-grouped-pipeline-dropdown a.mini-pipeline-graph-dropdown-item",this.$el).on("click",function(t){t.stopPropagation()})},pipelineActionRequestComplete:function(){this.$emit("pipelineActionRequestComplete")}}},A=i(3),q=Object(A.a)(k,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ci-job-dropdown-container dropdown dropright"},[i("button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip.hover",value:{boundary:"viewport"},expression:"{ boundary: 'viewport' }",modifiers:{hover:!0}}],staticClass:"dropdown-menu-toggle build-content",attrs:{title:t.tooltipText,type:"button","data-toggle":"dropdown","data-display":"static"}},[i("ci-icon",{attrs:{status:t.group.status}}),t._v(" "),i("span",{staticClass:"ci-status-text"},[t._v(" "+t._s(t.group.name)+" ")]),t._v(" "),i("span",{staticClass:"dropdown-counter-badge"},[t._v(" "+t._s(t.group.size)+" ")])],1),t._v(" "),i("ul",{staticClass:"dropdown-menu big-pipeline-graph-dropdown-menu js-grouped-pipeline-dropdown"},[i("li",{staticClass:"scrollable-menu"},[i("ul",t._l(t.group.jobs,function(e){return i("li",{key:e.id},[i("job-item",{attrs:{"dropdown-length":t.group.size,job:e,"css-class-job-name":"mini-pipeline-graph-dropdown-item"},on:{pipelineActionRequestComplete:t.pipelineActionRequestComplete}})],1)}),0)])])])},[],!1,null,null,null);q.options.__file="job_group_dropdown.vue";var O=q.exports,P={components:{JobItem:C.a,JobGroupDropdown:O},props:{title:{type:String,required:!0},groups:{type:Array,required:!0},isFirstColumn:{type:Boolean,required:!1,default:!1},stageConnectorClass:{type:String,required:!1,default:""}},methods:{groupId:function(t){return"ci-badge-".concat(v.a.escape(t.name))},buildConnnectorClass:function(t){return 0!==t||this.isFirstColumn?"":"left-connector"},pipelineActionRequestComplete:function(){this.$emit("refreshPipelineGraph")}}},L=Object(A.a)(P,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"stage-column",class:t.stageConnectorClass},[i("div",{staticClass:"stage-name"},[t._v(t._s(t.title))]),t._v(" "),i("div",{staticClass:"builds-container"},[i("ul",t._l(t.groups,function(e,n){return i("li",{key:e.id,staticClass:"build",class:t.buildConnnectorClass(n),attrs:{id:t.groupId(e)}},[i("div",{staticClass:"curve"}),t._v(" "),1===e.size?i("job-item",{attrs:{job:e.jobs[0],"css-class-job-name":"build-content"},on:{pipelineActionRequestComplete:t.pipelineActionRequestComplete}}):t._e(),t._v(" "),e.size>1?i("job-group-dropdown",{attrs:{group:e},on:{pipelineActionRequestComplete:t.pipelineActionRequestComplete}}):t._e()],1)}),0)])])},[],!1,null,null,null);L.options.__file="stage_column_component.vue";var S={components:{StageColumnComponent:L.exports,GlLoadingIcon:_.e},props:{isLoading:{type:Boolean,required:!0},pipeline:{type:Object,required:!0}},computed:{graph:function(){return this.pipeline.details&&this.pipeline.details.stages}},methods:{capitalizeStageName:function(t){var e=v.a.escape(t);return e.charAt(0).toUpperCase()+e.slice(1)},isFirstColumn:function(t){return 0===t},stageConnectorClass:function(t,e){var i;return 0===t&&1===e.groups.length?i="no-margin":t>0&&(i="left-margin"),i},refreshPipelineGraph:function(){this.$emit("refreshPipelineGraph")}}},x=Object(A.a)(S,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"build-content middle-block js-pipeline-graph"},[i("div",{staticClass:"pipeline-visualization pipeline-graph pipeline-tab-content"},[i("div",{staticClass:"text-center"},[t.isLoading?i("gl-loading-icon",{attrs:{size:3}}):t._e()],1),t._v(" "),t.isLoading?t._e():i("ul",{staticClass:"stage-column-list"},t._l(t.graph,function(e,n){return i("stage-column-component",{key:e.name,attrs:{title:t.capitalizeStageName(e.name),groups:e.groups,"stage-connector-class":t.stageConnectorClass(n,e),"is-first-column":t.isFirstColumn(n)},on:{refreshPipelineGraph:t.refreshPipelineGraph}})}),1)])])},[],!1,null,null,null);x.options.__file="graph_component.vue";var T=x.exports,$=i(303),R=i(59),G={name:"PipelineHeaderSection",components:{ciHeader:$.a,GlLoadingIcon:_.e},props:{pipeline:{type:Object,required:!0},isLoading:{type:Boolean,required:!0}},data:function(){return{actions:this.getActions()}},computed:{status:function(){return this.pipeline.details&&this.pipeline.details.status},shouldRenderContent:function(){return!this.isLoading&&Object.keys(this.pipeline).length}},watch:{pipeline:function(){this.actions=this.getActions()}},methods:{postAction:function(t){var e=this.actions.indexOf(t);this.$set(this.actions[e],"isLoading",!0),R.a.$emit("headerPostAction",t)},getActions:function(){var t=[];return this.pipeline.retry_path&&t.push({label:"Retry",path:this.pipeline.retry_path,cssClass:"js-retry-button btn btn-inverted-secondary",type:"button",isLoading:!1}),this.pipeline.cancel_path&&t.push({label:"Cancel running",path:this.pipeline.cancel_path,cssClass:"js-btn-cancel-pipeline btn btn-danger",type:"button",isLoading:!1}),t}}},E=Object(A.a)(G,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"pipeline-header-container"},[t.shouldRenderContent?i("ci-header",{attrs:{status:t.status,"item-id":t.pipeline.id,time:t.pipeline.created_at,user:t.pipeline.user,actions:t.actions,"item-name":"Pipeline"},on:{actionClicked:t.postAction}}):t._e(),t._v(" "),t.isLoading?i("gl-loading-icon",{staticClass:"prepend-top-default append-bottom-default",attrs:{size:2}}):t._e()],1)},[],!1,null,null,null);E.options.__file="header_component.vue";var I=E.exports;n.default.use(s.a);function N(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var B=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=i,this.defaultAction=this.options.defaultAction,this.action=this.options.action||this.defaultAction,"show"===this.action&&(this.action=this.defaultAction),this.currentLocation=window.location;var n="".concat(this.options.parentEl,' a[data-toggle="tab"]');y()(document).off("shown.bs.tab",n).on("shown.bs.tab",n,function(t){return e.tabShown(t)}),this.activateTab(this.action)}var e,i,n;return e=t,(i=[{key:"tabShown",value:function(t){var e=t.target.getAttribute("href");return this.setCurrentAction(e)}},{key:"setCurrentAction",value:function(t){var e=t;e.replace(/\/+$/,"");var i="".concat(e).concat(this.currentLocation.search).concat(this.currentLocation.hash);return window.history.replaceState({url:i},document.title,i),i}},{key:"activateTab",value:function(){return y()("".concat(this.options.parentEl," a[data-action='").concat(this.action,"']")).tab("show")}}])&&N(e.prototype,i),n&&N(e,n),t}(),D=i(13);var z=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e.initTabs&&e.tabsOptions&&new B(e.tabsOptions),e.pipelineStatusUrl&&Object(D.H)(e.pipelineStatusUrl)};document.addEventListener("DOMContentLoaded",function(){var t,e,i,s;t=document.querySelector(".js-pipeline-container").dataset.controllerAction,e="".concat(document.querySelector(".js-pipeline-tab-link a").getAttribute("href"),"/status.json"),new z({initTabs:!0,pipelineStatusUrl:e,tabsOptions:{action:t,defaultAction:"pipelines",parentEl:".pipelines-tabs"}}),i=document.querySelector(".js-pipeline-details-vue").dataset,(s=new b({endpoint:i.endpoint})).fetchPipeline(),new n.default({el:"#js-pipeline-graph-vue",components:{pipelineGraph:T},data:function(){return{mediator:s}},methods:{requestRefreshPipelineGraph:function(){this.mediator.refreshPipeline().catch(function(){return Object(o.a)(Object(a.a)("An error occurred while making the request."))})}},render:function(t){return t("pipeline-graph",{props:{isLoading:this.mediator.state.isLoading,pipeline:this.mediator.store.state.pipeline},on:{refreshPipelineGraph:this.requestRefreshPipelineGraph}})}}),new n.default({el:"#js-pipeline-header-vue",components:{pipelineHeader:I},data:function(){return{mediator:s}},created:function(){R.a.$on("headerPostAction",this.postAction)},beforeDestroy:function(){R.a.$off("headerPostAction",this.postAction)},methods:{postAction:function(t){var e=this;this.mediator.service.postAction(t.path).then(function(){return e.mediator.refreshPipeline()}).catch(function(){return Object(o.a)(Object(a.a)("An error occurred while making the request."))})}},render:function(t){return t("pipeline-header",{props:{isLoading:this.mediator.state.isLoading,pipeline:this.mediator.store.state.pipeline}})}})})},59:function(t,e,i){"use strict";var n=i(11);e.a=new n.default},93:function(t,e,i){"use strict";var n=i(10),o=i(84),s=(i(20),{directives:{GlTooltip:n.n},mixins:[o.a],props:{time:{type:String,required:!0},tooltipPlacement:{type:String,required:!1,default:"top"},cssClass:{type:String,required:!1,default:""}}}),a=i(3),r=Object(a.a)(s,function(){var t=this.$createElement;return(this._self._c||t)("time",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip",value:{placement:this.tooltipPlacement},expression:"{ placement: tooltipPlacement }"}],class:this.cssClass,attrs:{title:this.tooltipTitle(this.time)},domProps:{textContent:this._s(this.timeFormated(this.time))}})},[],!1,null,null,null);r.options.__file="time_ago_tooltip.vue";e.a=r.exports}},[[1350,1,0,2,7]]]);
//# sourceMappingURL=pages.projects.pipelines.show.ab07d1df.chunk.js.map