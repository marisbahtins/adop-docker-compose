(this.webpackJsonp=this.webpackJsonp||[]).push([[165],{1365:function(e,t,n){n(42),n(44),e.exports=n(1366)},1366:function(e,t,n){"use strict";n.r(t);var o=n(500);document.addEventListener("DOMContentLoaded",o.a)},155:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var o=n(0),a=n.n(o),r=n(1);function i(e){e.find(".js-settings-toggle:not(.js-settings-toggle-trigger-only)").text(Object(r.a)("Collapse")),e.find(".settings-content").off("scroll.expandSection").scrollTop(0),e.addClass("expanded"),e.hasClass("no-animate")||e.addClass("animating").one("animationend.animateSection",function(){return e.removeClass("animating")})}function s(e){e.removeClass("no-animate"),e.hasClass("expanded")?function(e){e.find(".js-settings-toggle:not(.js-settings-toggle-trigger-only)").text(Object(r.a)("Expand")),e.find(".settings-content").on("scroll.expandSection",function(){return i(e)}),e.removeClass("expanded"),e.hasClass("no-animate")||e.addClass("animating").one("animationend.animateSection",function(){return e.removeClass("animating")})}(e):i(e)}function c(){if(a()(".settings").each(function(e,t){var n=a()(t);n.on("click.toggleSection",".js-settings-toggle",function(){return s(n)}),n.hasClass("expanded")||n.find(".settings-content").on("scroll.expandSection",function(){n.removeClass("no-animate"),i(n)})}),window.location.hash){var e=a()(window.location.hash);e.length&&e.hasClass("settings")&&i(e)}}},201:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var o=n(5),a=n.n(o);function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultToggleLabel=t.defaultToggleLabel,this.fieldName=t.fieldName,this.onSelect=t.onSelect||function(){},this.getDataOption=t.getData,this.getDataRemote=!!t.filterRemote,this.createNewItemFromValueOption=t.createNewItemFromValue,this.$dropdown=t.$dropdown,this.$dropdownContainer=this.$dropdown.parent(),this.$dropdownFooter=this.$dropdownContainer.find(".dropdown-footer"),this.$createButton=this.$dropdownContainer.find(".js-dropdown-create-new-item"),this.buildDropdown(),this.bindEvents(),this.toggleFooter(!0)}var t,n,o;return t=e,(n=[{key:"buildDropdown",value:function(){var e=this;this.$dropdown.glDropdown({data:this.getData.bind(this),filterable:!0,filterRemote:this.getDataRemote,search:{fields:["text"]},selectable:!0,toggleLabel:function(e){return e&&"id"in e?a.a.escape(e.title):this.defaultToggleLabel},fieldName:this.fieldName,text:function(e){return a.a.escape(e.text)},id:function(e){return a.a.escape(e.id)},onFilter:this.toggleCreateNewButton.bind(this),clicked:function(t){t.e.preventDefault(),e.onSelect()}})}},{key:"clearDropdown",value:function(){this.$dropdownContainer.find(".dropdown-content").html(""),this.$dropdownContainer.find(".dropdown-input-field").val("")}},{key:"bindEvents",value:function(){this.$createButton.on("click",this.onClickCreateWildcard.bind(this))}},{key:"onClickCreateWildcard",value:function(e){e.preventDefault(),this.refreshData(),this.$dropdown.data("glDropdown").selectRowAtIndex()}},{key:"refreshData",value:function(){this.$dropdown.data("glDropdown").remote.execute()}},{key:"getData",value:function(e,t){var n=this;this.getDataOption(e,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=e;n.selectedItem&&e.some(function(e){return e.id===n.selectedItem.id})||(o=e.concat(n.selectedItem||[])),t(o)})}},{key:"createNewItemFromValue",value:function(e){return this.createNewItemFromValueOption?this.createNewItemFromValueOption(e):{title:e,id:e,text:e}}},{key:"toggleCreateNewButton",value:function(e){e&&(this.selectedItem=this.createNewItemFromValue(e),this.$dropdownContainer.find(".js-dropdown-create-new-item code").text(e)),this.toggleFooter(!e)}},{key:"toggleFooter",value:function(e){this.$dropdownFooter.toggleClass("hidden",e)}}])&&r(t.prototype,n),o&&r(t,o),e}()},27:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var o=n(2),a=n.n(o),r=n(4),i=n(43);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=c(this,l(t).call(this)),a.a.bind("g p",function(){return Object(r.a)(".shortcuts-project")}),a.a.bind("g v",function(){return Object(r.a)(".shortcuts-project-activity")}),a.a.bind("g r",function(){return Object(r.a)(".shortcuts-project-releases")}),a.a.bind("g f",function(){return Object(r.a)(".shortcuts-tree")}),a.a.bind("g c",function(){return Object(r.a)(".shortcuts-commits")}),a.a.bind("g j",function(){return Object(r.a)(".shortcuts-builds")}),a.a.bind("g n",function(){return Object(r.a)(".shortcuts-network")}),a.a.bind("g d",function(){return Object(r.a)(".shortcuts-repository-charts")}),a.a.bind("g i",function(){return Object(r.a)(".shortcuts-issues")}),a.a.bind("g b",function(){return Object(r.a)(".shortcuts-issue-boards")}),a.a.bind("g m",function(){return Object(r.a)(".shortcuts-merge_requests")}),a.a.bind("g w",function(){return Object(r.a)(".shortcuts-wiki")}),a.a.bind("g s",function(){return Object(r.a)(".shortcuts-snippets")}),a.a.bind("g k",function(){return Object(r.a)(".shortcuts-kubernetes")}),a.a.bind("g e",function(){return Object(r.a)(".shortcuts-environments")}),a.a.bind("g l",function(){return Object(r.a)(".shortcuts-metrics")}),a.a.bind("i",function(){return Object(r.a)(".shortcuts-new-issue")}),e.enabledHelp.push(".hidden-shortcut.project"),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,i["a"]),t}()},28:function(e,t,n){"use strict";var o=n(0),a=n.n(o),r=n(12),i=n(31);function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.projectSelectInput=a()(t),this.newItemBtn=a()(".new-project-item-link"),this.resourceType=this.newItemBtn.data("type"),this.resourceLabel=this.newItemBtn.data("label"),this.formattedText=this.deriveTextVariants(),this.groupId=this.projectSelectInput.data("groupId"),this.bindEvents(),this.initLocalStorage()}var t,n,o;return t=e,(n=[{key:"bindEvents",value:function(){var e=this;this.projectSelectInput.siblings(".new-project-item-select-button").on("click",function(t){return e.openDropdown(t)}),this.newItemBtn.on("click",function(t){e.getProjectFromLocalStorage()||(t.preventDefault(),e.openDropdown(t))}),this.projectSelectInput.on("change",function(){return e.selectProject()})}},{key:"initLocalStorage",value:function(){i.a.isLocalStorageAccessSafe()&&(this.localStorageKey=["group",this.groupId,this.formattedText.localStorageItemType,"recent-project"].join("-"),this.setBtnTextFromLocalStorage())}},{key:"openDropdown",value:function(e){a()(e.currentTarget).siblings(".project-item-select").select2("open")}},{key:"selectProject",value:function(){var e=JSON.parse(this.projectSelectInput.val()),t={url:"".concat(e.url,"/").concat(this.projectSelectInput.data("relativePath")),name:e.name};this.setNewItemBtnAttributes(t),this.setProjectInLocalStorage(t)}},{key:"setBtnTextFromLocalStorage",value:function(){var e=this.getProjectFromLocalStorage();this.setNewItemBtnAttributes(e)}},{key:"setNewItemBtnAttributes",value:function(e){e?(this.newItemBtn.attr("href",e.url),this.newItemBtn.text("".concat(this.formattedText.defaultTextPrefix," in ").concat(e.name))):this.newItemBtn.text("Select project to create ".concat(this.formattedText.presetTextSuffix))}},{key:"getProjectFromLocalStorage",value:function(){var e=localStorage.getItem(this.localStorageKey);return JSON.parse(e)}},{key:"setProjectInLocalStorage",value:function(e){var t=JSON.stringify(e);localStorage.setItem(this.localStorageKey,t)}},{key:"deriveTextVariants",value:function(){var e=this.resourceLabel;return{localStorageItemType:"new-".concat(this.resourceType.split("_").join("-").slice(0,-1)),defaultTextPrefix:e,presetTextSuffix:this.resourceType.split("_").join(" ").slice(0,-1)}}}])&&s(t.prototype,n),o&&s(t,o),e}();function l(){a()(".ajax-project-select").each(function(e,t){var n,o,i=a()(t).data("simpleFilter")||!1;return this.groupId=a()(t).data("groupId"),this.includeGroups=a()(t).data("includeGroups"),this.allProjects=a()(t).data("allProjects")||!1,this.orderBy=a()(t).data("orderBy")||"id",this.withIssuesEnabled=a()(t).data("withIssuesEnabled"),this.withMergeRequestsEnabled=a()(t).data("withMergeRequestsEnabled"),this.withShared=void 0===a()(t).data("withShared")||a()(t).data("withShared"),this.includeProjectsInSubgroups=a()(t).data("includeProjectsInSubgroups")||!1,this.allowClear=a()(t).data("allowClear")||!1,n="Search for project",this.includeGroups&&(n+=" or group"),a()(t).select2({placeholder:n,minimumInputLength:0,query:(o=this,function(e){var t,n;return t=function(t){var n;return n={results:t},e.callback(n)},n=o.includeGroups?function(n){var o;return o=function(e){var o;return o=e.concat(n),t(o)},r.a.groups(e.term,{},o)}:t,o.groupId?r.a.groupProjects(o.groupId,e.term,{with_issues_enabled:o.withIssuesEnabled,with_merge_requests_enabled:o.withMergeRequestsEnabled,with_shared:o.withShared,include_subgroups:o.includeProjectsInSubgroups},n):r.a.projects(e.term,{order_by:o.orderBy,with_issues_enabled:o.withIssuesEnabled,with_merge_requests_enabled:o.withMergeRequestsEnabled,membership:!o.allProjects},n)}),id:function(e){return i?e.id:JSON.stringify({name:e.name,url:e.web_url})},text:function(e){return e.name_with_namespace||e.name},initSelection:function(e,t){return r.a.project(e.val()).then(function(e){var n=e.data;return t(n)})},allowClear:this.allowClear,dropdownCssClass:"ajax-project-dropdown"}),i?t:new c(t)})}n.d(t,"a",function(){return l})},29:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var o=n(0),a=n.n(o),r=n(14),i=n.n(r),s=n(1),c=n(19),l=n(6),d=n(7),u=n(28);function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=a()("ul.clone-options-dropdown"),n=a()("#project_clone"),o=a()(".js-git-clone-holder .js-clone-dropdown-label"),r=document.querySelector(".js-mobile-git-clone .js-clone-dropdown-label"),s=o.text().trim();s.length>0&&a()("a:contains('".concat(s,"')"),t).addClass("is-active"),a()("a",t).on("click",function(e){e.preventDefault();var o=a()(e.currentTarget),i=o.attr("href"),s=o.data("cloneType");a()(".is-active",t).removeClass("is-active"),a()('a[data-clone-type="'.concat(s,'"]')).each(function(){var e=a()(this),t=e.find(".dropdown-menu-inner-title").text(),n=e.closest(".project-clone-holder").find(".js-clone-dropdown-label");e.toggleClass("is-active"),n.text(t)}),r?r.dataset.clipboardText=i:n.val(i),a()(".js-git-empty .js-clone").text(i)}),e.initRefSwitcher(),a()(".project-refs-select").on("change",function(){return a()(this).parents("form").submit()}),a()(".hide-no-ssh-message").on("click",function(e){return i.a.set("hide_no_ssh_message","false"),a()(this).parents(".no-ssh-key-message").remove(),e.preventDefault()}),a()(".hide-no-password-message").on("click",function(e){return i.a.set("hide_no_password_message","false"),a()(this).parents(".no-password-message").remove(),e.preventDefault()}),a()(".hide-auto-devops-implicitly-enabled-banner").on("click",function(e){var t=a()(this).data("project-id"),n="hide_auto_devops_implicitly_enabled_banner_".concat(t);return i.a.set(n,"false"),a()(this).parents(".auto-devops-implicitly-enabled-banner").remove(),e.preventDefault()}),e.projectSelectDropdown()}var t,n,o;return t=e,o=[{key:"projectSelectDropdown",value:function(){Object(u.a)(),a()(".project-item-select").on("click",function(t){return e.changeProject(a()(t.currentTarget).val())})}},{key:"changeProject",value:function(e){return window.location=e}},{key:"initRefSwitcher",value:function(){var e=document.createElement("li"),t=document.createElement("a");return t.href="#",a()(".js-project-refs-dropdown").each(function(){var n,o;return n=a()(this),o=n.data("selected"),n.glDropdown({data:function(e,t){l.a.get(n.data("refsUrl"),{params:{ref:n.data("ref"),search:e}}).then(function(e){var n=e.data;return t(n)}).catch(function(){return Object(d.a)(Object(s.a)("An error occurred while getting projects"))})},selectable:!0,filterable:!0,filterRemote:!0,filterByText:!0,inputFieldName:n.data("inputFieldName"),fieldName:n.data("fieldName"),renderRow:function(n){var a=e.cloneNode(!1);if(null!=n.header)a.className="dropdown-header",a.textContent=n.header;else{var r=t.cloneNode(!1);n===o&&(r.className="is-active"),r.textContent=n,r.dataset.ref=n,a.appendChild(r)}return a},id:function(e,t){return t.attr("data-ref")},toggleLabel:function(e,t){return t.text().trim()},clicked:function(e){if(e.e.preventDefault(),a()('input[name="ref"]').length){var t=n.closest("form"),o=n.data("visit"),r=!!o||o,i=t.attr("action"),s=-1===i.indexOf("?")?"?":"&";r&&Object(c.g)("".concat(i).concat(s).concat(t.serialize()))}}})})}}],(n=null)&&p(t.prototype,n),o&&p(t,o),e}()},302:function(e,t,n){"use strict";var o=n(0),a=n.n(o),r={name:"NavigationTabs",props:{tabs:{type:Array,required:!0},scope:{type:String,required:!1,default:""}},mounted:function(){a()(document).trigger("init.scrolling-tabs")},methods:{shouldRenderBadge:function(e){return!(void 0===e||null===e)},onTabClick:function(e){this.$emit("onChangeTab",e.scope)}}},i=n(3),s=Object(i.a)(r,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"nav-links scrolling-tabs separator"},e._l(e.tabs,function(t,o){return n("li",{key:o,class:{active:t.isActive}},[n("a",{class:"js-"+e.scope+"-tab-"+t.scope,attrs:{role:"button"},on:{click:function(n){e.onTabClick(t)}}},[e._v("\n      "+e._s(t.name)+"\n\n      "),e.shouldRenderBadge(t.count)?n("span",{staticClass:"badge badge-pill"},[e._v(" "+e._s(t.count)+" ")]):e._e()])])}),0)},[],!1,null,null,null);s.options.__file="navigation_tabs.vue";t.a=s.exports},362:function(e,t,n){"use strict";t.a=function(e,t){var n=document.querySelector(e),o=document.querySelector(t),a=n.closest("form");n.addEventListener("click",function(){o.click()}),o.addEventListener("change",function(){a.querySelector(".js-filename").textContent=o.value.replace(/^.*[\\\/]/,"")})}},41:function(e,t,n){"use strict";var o=n(0),a=n.n(o);t.a={bind:function(e){a()(e).tooltip({trigger:"hover"})},componentUpdated:function(e){a()(e).tooltip("_fixTitle");var t=a()(e).data("bs.tooltip"),n=t.getTipElement();t.setElementContent(a()(n.querySelectorAll(".tooltip-inner")),t.getTitle())},unbind:function(e){a()(e).tooltip("dispose")}}},44:function(e,t,n){"use strict";n.r(t);var o=n(38),a=n(36),r=n(29),i=n(27);document.addEventListener("DOMContentLoaded",function(){var e=document.body.dataset.page;if(["projects:clusters:new","projects:clusters:create_gcp","projects:clusters:create_user"].indexOf(e)>-1){var t=document.querySelector(".gcp-signup-offer");t&&new a.a(t),Object(o.a)()}new r.a,new i.a})},500:function(e,t,n){"use strict";var o=n(0),a=n.n(o);function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.initDropdown()}var t,n,o;return t=e,(n=[{key:"initDropdown",value:function(){var e=this.options.onSelect;this.options.$dropdown.glDropdown({data:this.options.data,selectable:!0,inputId:this.options.$dropdown.data("inputId"),fieldName:this.options.$dropdown.data("fieldName"),toggleLabel:function(e,t){return t.is(".is-active")?e.text:"Select"},clicked:function(t){t.e.preventDefault(),e()}})}}])&&r(t.prototype,n),o&&r(t,o),e}(),s=n(201);function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$form=a()(".js-new-protected-tag"),this.buildDropdowns()}var t,n,o;return t=e,o=[{key:"getProtectedTags",value:function(e,t){t(gon.open_tags)}}],(n=[{key:"buildDropdowns",value:function(){var t=this.$form.find(".js-allowed-to-create");this.onSelectCallback=this.onSelect.bind(this),this.protectedTagAccessDropdown=new i({$dropdown:t,data:gon.create_access_levels,onSelect:this.onSelectCallback}),t.data("glDropdown").selectRowAtIndex(0),this.createItemDropdown=new s.a({$dropdown:this.$form.find(".js-protected-tag-select"),defaultToggleLabel:"Protected Tag",fieldName:"protected_tag[name]",onSelect:this.onSelectCallback,getData:e.getProtectedTags})}},{key:"onSelect",value:function(){var e=this.$form.find('input[name="protected_tag[name]"]'),t=this.$form.find("#create_access_levels_attributes");this.$form.find('input[type="submit"]').prop("disabled",!(e.val()&&t.length))}}])&&c(t.prototype,n),o&&c(t,o),e}(),d=n(7),u=n(6);function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$wrap=t.$wrap,this.$allowedToCreateDropdownButton=this.$wrap.find(".js-allowed-to-create"),this.onSelectCallback=this.onSelect.bind(this),this.buildDropdowns()}var t,n,o;return t=e,(n=[{key:"buildDropdowns",value:function(){this.protectedTagAccessDropdown=new i({$dropdown:this.$allowedToCreateDropdownButton,data:gon.create_access_levels,onSelect:this.onSelectCallback})}},{key:"onSelect",value:function(){var e=this,t=this.$wrap.find('input[name="'.concat(this.$allowedToCreateDropdownButton.data("fieldName"),'"]'));t.length&&(this.$allowedToCreateDropdownButton.disable(),u.a.patch(this.$wrap.data("url"),{protected_tag:{create_access_levels_attributes:[{id:this.$allowedToCreateDropdownButton.data("accessLevelId"),access_level:t.val()}]}}).then(function(){e.$allowedToCreateDropdownButton.enable()}).catch(function(){e.$allowedToCreateDropdownButton.enable(),Object(d.a)("Failed to update tag!","alert",document.querySelector(".js-protected-tags-list"))}))}}])&&p(t.prototype,n),o&&p(t,o),e}();function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var b=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$wrap=a()(".protected-tags-list"),this.initEditForm()}var t,n,o;return t=e,(n=[{key:"initEditForm",value:function(){this.$wrap.find(".js-protected-tag-edit-form").each(function(e,t){new f({$wrap:a()(t)})})}}])&&h(t.prototype,n),o&&h(t,o),e}(),y=n(155),v=n(11),g=n(1),m=n(302),w=new v.default;function j(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var _=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.axios=u.a.create({baseURL:t})}var t,n,o;return t=e,(n=[{key:"getKeys",value:function(){return this.axios.get().then(function(e){return e.data})}},{key:"enableKey",value:function(e){return this.axios.put("".concat(e,"/enable")).then(function(e){return e.data})}},{key:"disableKey",value:function(e){return this.axios.put("".concat(e,"/disable")).then(function(e){return e.data})}}])&&j(t.prototype,n),o&&j(t,o),e}();function k(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keys={}}var t,n,o;return t=e,(n=[{key:"isEnabled",value:function(e){return this.keys.enabled_keys.some(function(t){return t.id===e})}}])&&k(t.prototype,n),o&&k(t,o),e}(),S=n(5),D=n.n(S),$=n(15),T=n(41),O=n(84),x=n(10),I={components:{GlLoadingIcon:x.e},props:{deployKey:{type:Object,required:!0},type:{type:String,required:!0},btnCssClass:{type:String,required:!1,default:"btn-default"}},data:function(){return{isLoading:!1}},methods:{doAction:function(){var e=this;this.isLoading=!0,w.$emit("".concat(this.type,".key"),this.deployKey,function(){e.isLoading=!1})}}},E=n(3),P=Object(E.a)(I,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"btn",class:[{disabled:e.isLoading},e.btnCssClass],attrs:{disabled:e.isLoading},on:{click:e.doAction}},[e._t("default"),e._v(" "),e.isLoading?n("gl-loading-icon",{attrs:{inline:!0}}):e._e()],2)},[],!1,null,null,null);function K(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}P.options.__file="action_btn.vue";var L={components:{actionBtn:P.exports,icon:$.a},directives:{tooltip:T.a},mixins:[O.a],props:{deployKey:{type:Object,required:!0},store:{type:Object,required:!0},endpoint:{type:String,required:!0},projectId:{type:String,required:!1,default:null}},data:function(){return{projectsExpanded:!1}},computed:{editDeployKeyPath:function(){return"".concat(this.endpoint,"/").concat(this.deployKey.id,"/edit")},projects:function(){var e=this,t=K(this.deployKey.deploy_keys_projects);if(null!==this.projectId){var n=D.a.findIndex(t,function(t){return t&&t.project&&t.project.id&&t.project.id.toString()===e.projectId});if(n>-1){var o=t.splice(n,1);return o[0].project.full_name=Object(g.e)("DeployKeys|Current project"),o.concat(t)}}return t},firstProject:function(){return D.a.head(this.projects)},restProjects:function(){return D.a.tail(this.projects)},restProjectsTooltip:function(){return Object(g.f)(Object(g.e)("DeployKeys|Expand %{count} other projects"),{count:this.restProjects.length})},restProjectsLabel:function(){return Object(g.f)(Object(g.e)("DeployKeys|+%{count} others"),{count:this.restProjects.length})},isEnabled:function(){return this.store.isEnabled(this.deployKey.id)},isRemovable:function(){return this.store.isEnabled(this.deployKey.id)&&this.deployKey.destroyed_when_orphaned&&this.deployKey.almost_orphaned},isExpandable:function(){return!this.projectsExpanded&&this.restProjects.length>1},isExpanded:function(){return this.projectsExpanded||1===this.restProjects.length}},methods:{projectTooltipTitle:function(e){return e.can_push?Object(g.e)("DeployKeys|Write access allowed"):Object(g.e)("DeployKeys|Read access only")},toggleExpanded:function(){this.projectsExpanded=!this.projectsExpanded}}},N=Object(E.a)(L,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"gl-responsive-table-row deploy-key"},[n("div",{staticClass:"table-section section-40"},[n("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v(e._s(e.s__("DeployKeys|Deploy key")))]),e._v(" "),n("div",{staticClass:"table-mobile-content"},[n("strong",{staticClass:"title qa-key-title"},[e._v(" "+e._s(e.deployKey.title)+" ")]),e._v(" "),n("div",{staticClass:"fingerprint qa-key-fingerprint"},[e._v(e._s(e.deployKey.fingerprint))])])]),e._v(" "),n("div",{staticClass:"table-section section-30 section-wrap"},[n("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v(e._s(e.s__("DeployKeys|Project usage")))]),e._v(" "),n("div",{staticClass:"table-mobile-content deploy-project-list"},[e.projects.length>0?[n("a",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"label deploy-project-label",attrs:{title:e.projectTooltipTitle(e.firstProject)}},[n("span",[e._v(" "+e._s(e.firstProject.project.full_name)+" ")]),e._v(" "),n("icon",{attrs:{name:e.firstProject.can_push?"lock-open":"lock"}})],1),e._v(" "),e.isExpandable?n("a",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"label deploy-project-label",attrs:{title:e.restProjectsTooltip},on:{click:e.toggleExpanded}},[n("span",[e._v(e._s(e.restProjectsLabel))])]):e.isExpanded?e._l(e.restProjects,function(t){return n("a",{directives:[{name:"tooltip",rawName:"v-tooltip"}],key:t.project.full_path,staticClass:"label deploy-project-label",attrs:{href:t.project.full_path,title:e.projectTooltipTitle(t)}},[n("span",[e._v(" "+e._s(t.project.full_name)+" ")]),e._v(" "),n("icon",{attrs:{name:t.can_push?"lock-open":"lock"}})],1)}):e._e()]:n("span",{staticClass:"text-secondary"},[e._v(e._s(e.__("None")))])],2)]),e._v(" "),n("div",{staticClass:"table-section section-15 text-right"},[n("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v(e._s(e.__("Created")))]),e._v(" "),n("div",{staticClass:"table-mobile-content text-secondary key-created-at"},[n("span",{directives:[{name:"tooltip",rawName:"v-tooltip"}],attrs:{title:e.tooltipTitle(e.deployKey.created_at)}},[n("icon",{attrs:{name:"calendar"}}),e._v(" "),n("span",[e._v(e._s(e.timeFormated(e.deployKey.created_at)))])],1)])]),e._v(" "),n("div",{staticClass:"table-section section-15 table-button-footer deploy-key-actions"},[n("div",{staticClass:"btn-group table-action-buttons"},[e.isEnabled?e._e():n("action-btn",{attrs:{"deploy-key":e.deployKey,type:"enable"}},[e._v("\n        "+e._s(e.__("Enable"))+"\n      ")]),e._v(" "),e.deployKey.can_edit?n("a",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"btn btn-default text-secondary",attrs:{href:e.editDeployKeyPath,title:e.__("Edit"),"data-container":"body"}},[n("icon",{attrs:{name:"pencil"}})],1):e._e(),e._v(" "),e.isRemovable?n("action-btn",{directives:[{name:"tooltip",rawName:"v-tooltip"}],attrs:{"deploy-key":e.deployKey,title:e.__("Remove"),"btn-css-class":"btn-danger",type:"remove","data-container":"body"}},[n("icon",{attrs:{name:"remove"}})],1):e.isEnabled?n("action-btn",{directives:[{name:"tooltip",rawName:"v-tooltip"}],attrs:{"deploy-key":e.deployKey,title:e.__("Disable"),"btn-css-class":"btn-warning",type:"disable","data-container":"body"}},[n("icon",{attrs:{name:"cancel"}})],1):e._e()],1)])])},[],!1,null,null,null);N.options.__file="key.vue";var B={components:{deployKey:N.exports},props:{keys:{type:Array,required:!0},store:{type:Object,required:!0},endpoint:{type:String,required:!0},projectId:{type:String,required:!1,default:null}}},q=Object(E.a)(B,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"deploy-keys-panel table-holder"},[e.keys.length>0?[n("div",{staticClass:"gl-responsive-table-row table-row-header",attrs:{role:"row"}},[n("div",{staticClass:"table-section section-40",attrs:{role:"rowheader"}},[e._v("\n        "+e._s(e.s__("DeployKeys|Deploy key"))+"\n      ")]),e._v(" "),n("div",{staticClass:"table-section section-30",attrs:{role:"rowheader"}},[e._v("\n        "+e._s(e.s__("DeployKeys|Project usage"))+"\n      ")]),e._v(" "),n("div",{staticClass:"table-section section-15 text-right",attrs:{role:"rowheader"}},[e._v(e._s(e.__("Created")))])]),e._v(" "),e._l(e.keys,function(t){return n("deploy-key",{key:t.id,attrs:{"deploy-key":t,store:e.store,endpoint:e.endpoint,"project-id":e.projectId}})})]:n("div",{staticClass:"settings-message text-center"},[e._v("\n    "+e._s(e.s__("DeployKeys|No deploy keys found. Create one with the form above."))+"\n  ")])],2)},[],!1,null,null,null);q.options.__file="keys_panel.vue";var A={components:{KeysPanel:q.exports,NavigationTabs:m.a,GlLoadingIcon:x.e},props:{endpoint:{type:String,required:!0},projectId:{type:String,required:!0}},data:function(){return{currentTab:"enabled_keys",isLoading:!1,store:new C}},scopes:{enabled_keys:Object(g.e)("DeployKeys|Enabled deploy keys"),available_project_keys:Object(g.e)("DeployKeys|Privately accessible deploy keys"),public_keys:Object(g.e)("DeployKeys|Publicly accessible deploy keys")},computed:{tabs:function(){var e=this;return Object.keys(this.$options.scopes).map(function(t){var n=Array.isArray(e.keys[t])?e.keys[t].length:null;return{name:e.$options.scopes[t],scope:t,isActive:t===e.currentTab,count:n}})},hasKeys:function(){return Object.keys(this.keys).length},keys:function(){return this.store.keys}},created:function(){this.service=new _(this.endpoint),w.$on("enable.key",this.enableKey),w.$on("remove.key",this.disableKey),w.$on("disable.key",this.disableKey)},mounted:function(){this.fetchKeys()},beforeDestroy:function(){w.$off("enable.key",this.enableKey),w.$off("remove.key",this.disableKey),w.$off("disable.key",this.disableKey)},methods:{onChangeTab:function(e){this.currentTab=e},fetchKeys:function(){var e=this;return this.isLoading=!0,this.service.getKeys().then(function(t){e.isLoading=!1,e.store.keys=t}).catch(function(){return e.isLoading=!1,e.store.keys={},new d.a(Object(g.e)("DeployKeys|Error getting deploy keys"))})},enableKey:function(e){this.service.enableKey(e.id).then(this.fetchKeys).catch(function(){return new d.a(Object(g.e)("DeployKeys|Error enabling deploy key"))})},disableKey:function(e,t){window.confirm(Object(g.e)("DeployKeys|You are going to remove this deploy key. Are you sure?"))?this.service.disableKey(e.id).then(this.fetchKeys).then(t).catch(function(){return new d.a(Object(g.e)("DeployKeys|Error removing deploy key"))}):t()}}},F=Object(E.a)(A,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"append-bottom-default deploy-keys"},[e.isLoading&&!e.hasKeys?n("gl-loading-icon",{attrs:{label:e.s__("DeployKeys|Loading deploy keys"),size:2}}):e.hasKeys?[n("div",{staticClass:"top-area scrolling-tabs-container inner-page-scroll-tabs"},[n("div",{staticClass:"fade-left"},[n("i",{staticClass:"fa fa-angle-left",attrs:{"aria-hidden":"true"}})]),e._v(" "),n("div",{staticClass:"fade-right"},[n("i",{staticClass:"fa fa-angle-right",attrs:{"aria-hidden":"true"}})]),e._v(" "),n("navigation-tabs",{attrs:{tabs:e.tabs,scope:"deployKeys"},on:{onChangeTab:e.onChangeTab}})],1),e._v(" "),n("keys-panel",{staticClass:"qa-project-deploy-keys",attrs:{"project-id":e.projectId,keys:e.keys[e.currentTab],store:e.store,endpoint:e.endpoint}})]:e._e()],2)},[],!1,null,null,null);F.options.__file="app.vue";var R=F.exports;function M(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var V=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.initDropdown()}var t,n,o;return t=e,(n=[{key:"initDropdown",value:function(){var e=this.options,t=e.$dropdown,n=e.data,o=e.onSelect;t.glDropdown({data:n,selectable:!0,inputId:t.data("inputId"),fieldName:t.data("fieldName"),toggleLabel:function(e,t){return t.is(".is-active")?e.text:"Select"},clicked:function(e){e.e.preventDefault(),o()}})}}])&&M(t.prototype,n),o&&M(t,o),e}(),G=n(31);function J(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var U=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$form=a()(".js-new-protected-branch"),this.isLocalStorageAvailable=G.a.isLocalStorageAccessSafe(),this.currentProjectUserDefaults={},this.buildDropdowns()}var t,n,o;return t=e,o=[{key:"getProtectedBranches",value:function(e,t){t(gon.open_branches)}}],(n=[{key:"buildDropdowns",value:function(){var t=this.$form.find(".js-allowed-to-merge"),n=this.$form.find(".js-allowed-to-push"),o=this.$form.find(".js-protected-branch-select");this.onSelectCallback=this.onSelect.bind(this),this.protectedBranchMergeAccessDropdown=new V({$dropdown:t,data:gon.merge_access_levels,onSelect:this.onSelectCallback}),this.protectedBranchPushAccessDropdown=new V({$dropdown:n,data:gon.push_access_levels,onSelect:this.onSelectCallback}),this.createItemDropdown=new s.a({$dropdown:o,defaultToggleLabel:"Protected Branch",fieldName:"protected_branch[name]",onSelect:this.onSelectCallback,getData:e.getProtectedBranches})}},{key:"onSelect",value:function(){var e=this.$form.find('input[name="protected_branch[name]"]'),t=this.$form.find('input[name="protected_branch[merge_access_levels_attributes][0][access_level]"]'),n=this.$form.find('input[name="protected_branch[push_access_levels_attributes][0][access_level]"]'),o=!(e.val()&&t.length&&n.length);this.$form.find('input[type="submit"]').prop("disabled",o)}}])&&J(t.prototype,n),o&&J(t,o),e}();function W(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var z=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$wrap=t.$wrap,this.$allowedToMergeDropdown=this.$wrap.find(".js-allowed-to-merge"),this.$allowedToPushDropdown=this.$wrap.find(".js-allowed-to-push"),this.onSelectCallback=this.onSelect.bind(this),this.buildDropdowns()}var t,n,o;return t=e,(n=[{key:"buildDropdowns",value:function(){this.protectedBranchAccessDropdown=new V({$dropdown:this.$allowedToMergeDropdown,data:gon.merge_access_levels,onSelect:this.onSelectCallback}),this.protectedBranchAccessDropdown=new V({$dropdown:this.$allowedToPushDropdown,data:gon.push_access_levels,onSelect:this.onSelectCallback})}},{key:"onSelect",value:function(){var e=this,t=this.$wrap.find('input[name="'.concat(this.$allowedToMergeDropdown.data("fieldName"),'"]')),n=this.$wrap.find('input[name="'.concat(this.$allowedToPushDropdown.data("fieldName"),'"]'));t.length&&n.length&&(this.$allowedToMergeDropdown.disable(),this.$allowedToPushDropdown.disable(),u.a.patch(this.$wrap.data("url"),{protected_branch:{merge_access_levels_attributes:[{id:this.$allowedToMergeDropdown.data("accessLevelId"),access_level:t.val()}],push_access_levels_attributes:[{id:this.$allowedToPushDropdown.data("accessLevelId"),access_level:n.val()}]}}).then(function(){e.$allowedToMergeDropdown.enable(),e.$allowedToPushDropdown.enable()}).catch(function(){e.$allowedToMergeDropdown.enable(),e.$allowedToPushDropdown.enable(),Object(d.a)("Failed to update branch!","alert",document.querySelector(".js-protected-branches-list"))}))}}])&&W(t.prototype,n),o&&W(t,o),e}();function H(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var Y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$wrap=a()(".protected-branches-list"),this.initEditForm()}var t,n,o;return t=e,(n=[{key:"initEditForm",value:function(){this.$wrap.find(".js-protected-branch-edit-form").each(function(e,t){new z({$wrap:a()(t)})})}}])&&H(t.prototype,n),o&&H(t,o),e}(),Q=n(126),X=n(362);t.a=function(){new l,new b,new v.default({el:document.getElementById("js-deploy-keys"),components:{deployKeysApp:R},data:function(){return{endpoint:this.$options.el.dataset.endpoint,projectId:this.$options.el.dataset.projectId}},render:function(e){return e("deploy-keys-app",{props:{endpoint:this.endpoint,projectId:this.projectId}})}}),Object(y.a)(),new U,new Y,new Q.a,Object(X.a)(".js-choose-file",".js-object-map-input")}},84:function(e,t,n){"use strict";var o=n(20);t.a={methods:{timeFormated:function(e){return Object(o.h)().format(e)},tooltipTitle:function(e){return Object(o.d)(e)}}}}},[[1365,1,0,2,10]]]);
//# sourceMappingURL=pages.projects.settings.repository.create_deploy_token.9664819f.chunk.js.map