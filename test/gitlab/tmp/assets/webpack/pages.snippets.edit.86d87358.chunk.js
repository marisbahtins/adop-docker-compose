(this.webpackJsonp=this.webpackJsonp||[]).push([[179],{111:function(e,t){Mousetrap=function(e){var t=e,a=t.stopCallback,n=!0;return t.stopCallback=function(e,t,i){return!n||a(e,t,i)},t.pause=function(){n=!1},t.unpause=function(){n=!0},t}(Mousetrap)},1386:function(e,t,a){a(42),e.exports=a(1387)},1387:function(e,t,a){"use strict";a.r(t);var n=a(297),i=a(497);document.addEventListener("DOMContentLoaded",function(){Object(n.a)(),Object(i.a)()})},297:function(e,t,a){"use strict";var n=a(0),i=a.n(n);t.a=function(){var e=ace.edit("editor");i()(".snippet-form-holder form").on("submit",function(){i()(".snippet-file-content").val(e.getValue())})}},497:function(e,t,a){"use strict";var n=a(0),i=a.n(n),o=a(79),r=a(85);t.a=function(){new o.a(i()(".snippet-form"),{members:!1,issues:!1,mergeRequests:!1,epics:!1,milestones:!1,labels:!1,snippets:!1}),new r.a}},79:function(e,t,a){"use strict";var n=a(0),i=a.n(n),o=a(62),r=a.n(o),s=a(66),l=a(32),u=a.n(l),d=a(5),c=a.n(d),f=(a(173),a(75)),p=a(6);function h(e){var t,a,n,o,r,s,l,d=e.find(".button-attach-file"),h=e.find(".attaching-file-message"),v=e.find(".button-cancel-uploading-files"),m=e.find(".retry-uploading-link"),g=e.find(".uploading-progress"),b=e.find(".uploading-error-container"),z=e.find(".uploading-error-message"),C=e.find(".uploading-progress-container"),x=e.data("uploads-path")||window.uploads_path||null,k=gon.max_file_size||10,w=e.find(".js-gfm-input");w.wrap('<div class="div-dropzone"></div>'),w.on("paste",function(e){return t(e)});var y=w.closest(".md-area");e.setupMarkdownPreview();var D=e.find(".div-dropzone");if(D.parent().addClass("div-dropzone-wrapper"),D.append('<div class="div-dropzone-hover"></div>'),D.find(".div-dropzone-hover").append('<i class="fa fa-paperclip div-dropzone-icon"></i>'),!x)return D.addClass("js-invalid-dropzone"),null;var j=D.dropzone({url:x,dictDefaultMessage:"",clickable:!0,paramName:"file",maxFilesize:k,uploadMultiple:!1,headers:f.a.headers,previewContainer:!1,processing:function(){return i()(".div-dropzone-alert").alert("close")},dragover:function(){y.addClass("is-dropzone-hover"),e.find(".div-dropzone-hover").css("opacity",.7)},dragleave:function(){y.removeClass("is-dropzone-hover"),e.find(".div-dropzone-hover").css("opacity",0)},drop:function(){y.removeClass("is-dropzone-hover"),e.find(".div-dropzone-hover").css("opacity",0),w.focus()},success:function(e,t){var i=this.getQueuedFiles().length+this.getUploadingFiles().length,o=i>=1;a(t.link.markdown,o),i||d.removeClass("hide"),n(t.link.url)},error:function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Attaching the file failed.",n=arguments.length>2?arguments[2]:void 0,i=!(t=a||n.responseText)||c.a.isString(t)?t:t.message;b.removeClass("hide"),z.html(i),d.addClass("hide"),v.addClass("hide")},totaluploadprogress:function(e){o(this.files,h),g.text("".concat(Math.round(e),"%"))},sending:function(){d.addClass("hide"),b.addClass("hide"),C.removeClass("hide"),v.removeClass("hide")},removedfile:function(){d.removeClass("hide"),v.addClass("hide"),C.addClass("hide"),b.addClass("hide")},queuecomplete:function(){i()(".dz-preview").remove(),i()(".markdown-area").trigger("input"),C.addClass("hide"),v.addClass("hide")}}),_=i()(j[0]).children("textarea");v.on("click",function(e){e.preventDefault(),e.stopPropagation(),u.a.forElement(D.get(0)).removeAllFiles(!0)}),m.on("click",function(e){var t=u.a.forElement(e.target.closest(".js-main-target-form").querySelector(".div-dropzone")),a=t.files;e.preventDefault(),t.removeAllFiles(!0),a.map(function(e){var a=e;return a.status===u.a.ERROR&&(a.status=void 0,a.accepted=void 0),t.addFile(a)})}),t=function(e){var t=e.originalEvent;if(t.clipboardData&&t.clipboardData.items){var n=r(t);if(n){e.preventDefault();var i=s(t)||"image.png",o="{{".concat(i,"}}");return a(o),l(n.getAsFile(),i)}}},r=function(e){for(var t=0;t<e.clipboardData.items.length;){var a=e.clipboardData.items[t];if(-1!==a.type.indexOf("image"))return a;t+=1}return!1},a=function(e,t){var a=e;t&&(a+="\n\n");var n=_.get(0),o=n.selectionStart,r=n.selectionEnd,s=i()(_).val().length,l=i()(_).val().substring(0,o),u=i()(_).val().substring(r,s);return i()(_).val(l+a+u),n.setSelectionRange(o+a.length,r+a.length),n.style.height="".concat(n.scrollHeight,"px"),w.get(0).dispatchEvent(new Event("input")),w.trigger("input")},n=function(t){i()(e).append('<input type="hidden" name="files[]" value="'.concat(c.a.escape(t),'">'))},s=function(e){var t;return window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData&&(t=e.clipboardData.getData("text/plain")),(t=t.split("\r"))[0]};var E=function(){return C.addClass("hide")};return l=function(t,a){var n=new FormData;n.append("file",t,a),C.removeClass("hide"),e.find(".div-dropzone-alert").alert("close"),p.a.post(x,n).then(function(e){var t=e.data.link.markdown;!function(e,t){var a=i()(_);a.val(function(a,n){return n.replace("{{".concat(e,"}}"),t)}),a.trigger("change")}(a,t),E()}).catch(function(e){var t;t=e.response.data.message,b.removeClass("hide"),z.html(t),E()})},o=function(e,t){var a,n=e.filter(function(e){return"uploading"===e.status||"queued"===e.status}).length;a=n>1?"Attaching ".concat(n," files -"):"Attaching a file -",t.text(a)},e.find(".markdown-selector").click(function(e){e.preventDefault(),i()(this).closest(".gfm-form").find(".div-dropzone").click(),w.focus()}),u.a.forElement(D.get(0))}u.a.autoDiscover=!1;var v=a(76);function m(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}a.d(t,"a",function(){return g});var g=function(){function e(t){var a=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.form=t,this.textarea=this.form.find("textarea.js-gfm-input"),this.enableGFM=Object.assign({},s.b,n);var i=gl.GfmAutoComplete&&gl.GfmAutoComplete.dataSources||{};Object.keys(this.enableGFM).forEach(function(e){"emojis"!==e&&(a.enableGFM[e]=!!i[e])}),this.destroy(),this.setupForm(),this.form.data("glForm",this)}var t,a,n;return t=e,(a=[{key:"destroy",value:function(){this.clearEventListeners(),this.autoComplete&&this.autoComplete.destroy(),this.form.data("glForm",null)}},{key:"setupForm",value:function(){var e=this.form.is(":not(.gfm-form)");this.form.removeClass("js-new-note-form"),e&&(this.form.find(".div-dropzone").remove(),this.form.addClass("gfm-form"),gl.utils.disableButtonIfEmptyField(this.form.find(".js-note-text"),this.form.find(".js-comment-button, .js-note-new-discussion")),this.autoComplete=new s.a(gl.GfmAutoComplete&&gl.GfmAutoComplete.dataSources),this.autoComplete.setup(this.form.find(".js-gfm-input"),this.enableGFM),h(this.form),r()(this.textarea)),this.addEventListeners(),Object(v.b)(this.form),this.form.show(),this.isAutosizeable&&this.setupAutosize()}},{key:"setupAutosize",value:function(){var e=this;this.textarea.off("autosize:resized").on("autosize:resized",this.setHeightData.bind(this)),this.textarea.off("mouseup.autosize").on("mouseup.autosize",this.destroyAutosize.bind(this)),setTimeout(function(){r()(e.textarea),e.textarea.css("resize","vertical")},0)}},{key:"setHeightData",value:function(){this.textarea.data("height",this.textarea.outerHeight())}},{key:"destroyAutosize",value:function(){var e=this.textarea.outerHeight();this.textarea.data("height")!==e&&(r.a.destroy(this.textarea),this.textarea.data("height",e),this.textarea.outerHeight(e),this.textarea.css("max-height",window.outerHeight))}},{key:"clearEventListeners",value:function(){this.textarea.off("focus"),this.textarea.off("blur"),Object(v.c)(this.form)}},{key:"addEventListeners",value:function(){this.textarea.on("focus",function(){i()(this).closest(".md-area").addClass("is-focused")}),this.textarea.on("blur",function(){i()(this).closest(".md-area").removeClass("is-focused")})}}])&&m(t.prototype,a),n&&m(t,n),e}()},85:function(e,t,a){"use strict";a.d(t,"a",function(){return d});var n=a(0),i=a.n(n),o=(a(172),a(32)),r=a.n(o),s=a(2),l=a.n(s);a(111);function u(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.a.autoDiscover=!1;var d=function(){function e(){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.active_backdrop=null,this.active_textarea=null,i()(document).on("click",".js-zen-enter",function(e){return e.preventDefault(),i()(e.currentTarget).trigger("zen_mode:enter")}),i()(document).on("click",".js-zen-leave",function(e){return e.preventDefault(),i()(e.currentTarget).trigger("zen_mode:leave")}),i()(document).on("zen_mode:enter",(t=this,function(e){return t.enter(i()(e.target).closest(".md-area").find(".zen-backdrop"))})),i()(document).on("zen_mode:leave",function(e){return function(t){return e.exit()}}(this)),i()(document).on("keydown",function(e){if(27===e.keyCode)return e.preventDefault(),i()(document).trigger("zen_mode:leave")})}var t,a,n;return t=e,(a=[{key:"enter",value:function(e){l.a.pause(),this.active_backdrop=i()(e),this.active_backdrop.addClass("fullscreen"),this.active_textarea=this.active_backdrop.find("textarea"),this.active_textarea.removeAttr("style"),this.active_textarea.focus()}},{key:"exit",value:function(){if(this.active_textarea){l.a.unpause(),this.active_textarea.closest(".zen-backdrop").removeClass("fullscreen"),this.scrollTo(this.active_textarea),this.active_textarea=null,this.active_backdrop=null;var e=i()(".div-dropzone");e&&!e.hasClass("js-invalid-dropzone")&&r.a.forElement(".div-dropzone").enable()}}},{key:"scrollTo",value:function(e){return i.a.scrollTo(e,0,{offset:-150})}}])&&u(t.prototype,a),n&&u(t,n),e}()}},[[1386,1,0,3]]]);
//# sourceMappingURL=pages.snippets.edit.86d87358.chunk.js.map